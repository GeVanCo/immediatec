<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE>Programming Language iC</TITLE>
	<META NAME="GENERATOR" CONTENT="LibreOffice 4.1.6.2 (Linux)">
	<META NAME="AUTHOR" CONTENT="John E. Wulff">
	<META NAME="CREATED" CONTENT="20020512;142434000000000">
	<META NAME="CHANGED" CONTENT="20160220;150750034658028">
	<META NAME="DESCRIPTION" CONTENT="first 3 chapters">
	<META NAME="Info 0" CONTENT="">
	<META NAME="Info 1" CONTENT="">
	<META NAME="Info 2" CONTENT="">
	<META NAME="Info 3" CONTENT="">
	<META NAME="Info 4" CONTENT="">
	<STYLE TYPE="text/css">
	<!--
		P { margin-bottom: 0.2cm; line-height: 0.4cm; text-align: justify; widows: 2; orphans: 2 }
		P.western { font-family: "Liberation Sans", sans-serif; font-size: 10pt; so-language: en-GB }
		H1 { margin-left: 1.2cm; text-indent: -1.2cm; margin-top: 1.27cm; margin-bottom: 0.4cm; background: transparent; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; line-height: 100%; text-align: justify; widows: 2; orphans: 2; page-break-before: auto }
		H1.western { font-family: "Liberation Sans", sans-serif; font-size: 14pt; so-language: en-GB }
		H1.cjk { font-size: 13pt }
		H1.ctl { font-size: 13pt }
		H2 { margin-left: 1.2cm; text-indent: -1.2cm; margin-top: 0.1cm; margin-bottom: 0.2cm; line-height: 100%; text-align: justify; widows: 2; orphans: 2; page-break-before: auto }
		H2.western { font-family: "Liberation Sans", sans-serif; font-size: 14pt; so-language: en-GB; font-style: italic }
		H2.cjk { font-family: "Bitstream Vera Sans"; font-size: 14pt; font-style: italic }
		H2.ctl { font-family: "Lucidasans"; font-size: 14pt; font-style: italic }
		H3 { margin-left: 0.62cm; margin-top: 0cm; margin-bottom: 0.2cm; line-height: 100%; text-align: justify; widows: 2; orphans: 2; page-break-after: auto }
		H3.western { font-family: "Liberation Sans", sans-serif; so-language: en-GB; font-style: italic }
		H3.cjk { font-family: "Bitstream Vera Sans" }
		H3.ctl { font-family: "Lucidasans" }
		P.frame-contents-western { font-family: "Liberation Sans", sans-serif; font-size: 10pt; so-language: en-GB }
		P.sdfootnote-western { font-family: "Liberation Sans", sans-serif; font-size: 8pt; so-language: en-GB }
		A:visited { so-language: en-GB }
		A.sdfootnoteanc { font-size: 57% }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-GB" DIR="LTR">
<DIV TYPE=HEADER>
	<P CLASS="western" STYLE="margin-bottom: 0.5cm"><BR><BR>
	</P>
</DIV>
<P CLASS="western" STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>The
Programming Language &quot;</B><I><B>immediate C</B></I><B>&quot;</B></FONT></FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=3>John
E. Wulff, B.E., M. Eng. Sc.</FONT></FONT></P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="line-height: 100%"><BR><BR>
</P>
<H1 CLASS="western"><A NAME="__RefHeading__23087_1582432481"></A>Abstract</H1>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>immediate
C</I> - <I>iC</I> for short - <SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">is
a </SPAN></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">declarative</SPAN></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
extension of the </SPAN></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">procedural
</SPAN></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">language
</SPAN></SPAN><SPAN LANG="en-GB"><I>C</I></SPAN>. It utilizes the
syntax of <I>C</I> to give meaning to statements that have no
semantic support in <I>C</I>. In addition to standard variables,
which are modified by the flow of instructions, <I>iC</I> provides so
called <I>'immediate'</I> variables, whose values are updated,
whenever a change of input calls for an immediate change in output.
An efficient Data Flow technique implements this strategy.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>iC</I>
provides programmers with built in operators, whose function is
closely modelled on integrated circuits. The name <I>iC</I> is a
reminder of this fact. Logical <I>AND</I>, <I>OR</I>, <I>EXCLUSIVE-OR
</I>and <I>NOT</I> as well as D flip-flops, SR flip-flops and many
others are implemented in such a way, that their use follows the same
design rules, which apply to their hardware counterparts. These rules
have led to a well-developed hardware technology, whose effectiveness
is demonstrated by the success of today's complex computer hardware.
Particularly the concept of clocked functions plays an important role
in the language <I>iC</I>. It gives the same protection against
timing races in <I>iC</I> programs, as it provides for hardware IC
designs. But <I>iC</I> is not a hardware description language nor a
simulation language – it provides the functionality and some of the
speed of field-programmable gate arrays to <I>C</I> programmers.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">Writing
programs in the language <I>iC</I> has the added quality, that many
simple ideas and relationships, which should result in direct
actions, can be written down <I>immediately</I> in one line. The
coding of call back routines and other overhead is not required. It
was this thought, which also prompted the name &quot;<I>immediate C</I>&quot;.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><B>Copyright
(C) 1985-2016 John E. Wulff</B></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
You may copy and distribute this document under the terms of either
the 
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
GNU General Public License or the Artistic License, as specified in
the README file.</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
For more information about this program, or for information on how 
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
to contact the author, see <A HREF="#10.Appendix A    README|outline">Appendix
A    README</A> or visit 
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<A HREF="http://raspberrypi.education/immediatec/">http://raspberrypi.education/immediatec/</A></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<A HREF="http://www.osadl.org/Immediate-C.immediate-c0.0.html">http://www.osadl.org/Immediate-C.immediate-c0.0.html</A></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
or contact the author at</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<A HREF="mailto:immediateC@gmail.com">immediateC@gmail.com</A></P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<BR>
</P>
<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 0.4cm">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>$Id: iC.odt 1.50  
2016/01/23</B></FONT></FONT></P>
<H1 LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="text-indent: 0cm; page-break-before: always"><A NAME="__RefHeading__23089_1582432481"></A>
<FONT SIZE=4>Zusammenfassung</FONT></H1>
<P LANG="de-DE" CLASS="western" STYLE="line-height: 0.4cm"><I>immediate
C</I> - kurz <I>iC</I> - ist eine deklarative Erweiterung der
prozeduralen Programmiersprache <I>C</I>. Sie basiert auf der Syntax
von <I>C</I> und gibt vielen Befehlen Bedeutung, die keine
semantische Unterstützung in <I>C</I> haben. Zu den einfachen
Variablen, die im normalen Programmfluss verändert werden, kommen in
<I>iC</I> so genannte <I>'immediate'</I> oder <I>'sofort'</I>
Variablen, dessen Wert sofort verändert wird, wenn eine
Eingangsänderung die sofortige Änderung eines Ausgangs zur Folge
hat. Um dies zu erreichen, wird eine effiziente Datenfluss-Technik
eingesetzt.</P>
<P LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">
<I>iC</I> stellt Programmierern eingebaute Operatoren zur Verfügung,
deren Arbeitsweise die Funktionen von IC-Bausteinen modelliert. Der
Name <I>iC</I> soll an diese Tatsache erinnern. Logisches <I>UND</I>,
<I>ODER, EXCLUSIV-ODER</I> und <I>NICHT</I> sowie D flip-flops, SR
flip-flops und viele mehr sind so implementiert, dass deren Anwendung
den gleichen Entwurfsregeln entspricht, wie die der entsprechenden
IC-Bausteine. Diese Regeln haben zu einer ausgereiften Technik
geführt, deren Wirksamkeit durch unsere heutige komplexe
Computertechnik belegt ist. Besonders das Konzept von getakteten
(clocked) Funktionen spielt in der Sprache <I><SPAN STYLE="font-weight: normal">iC</SPAN></I>
eine wichtige Rolle. Damit wird derselbe Schutz gegen
Laufzeitprobleme in <I>iC</I>-Programmen erreicht, der damit in
IC-Schaltkreisen bewirkt wird. Aber <I>iC</I> ist keine
Hardware-Beschreibungssprache – auch keine Simulationssprache. <I>iC</I>
bringt <I>C</I> Programmierern die Funktionsvielfalt und fast die
Geschwindigkeit von FPGAs (field-programmable gate arrays).</P>
<P LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">
Programme die in <I>iC</I> geschrieben werden, haben das zusätzliche
Merkmal, dass viele einfache Ideen und Zusammenhänge, die zu
direkten Aktionen führen sollen, sofort in einer Zeile
niedergeschrieben werden können. Callback-Routinen sind nicht
notwendig. Auch dieser Gedanke ist im Namen  &quot;<I>immediate C</I>&quot;
enthalten.</P>
<P LANG="de-DE" CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm; page-break-before: always">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><BR><BR>
</P>
<DIV ID="Table of Contents1" DIR="LTR" STYLE="background: transparent">
	<DIV ID="Table of Contents1_Head" DIR="LTR">
		<P STYLE="margin-top: 0.4cm; line-height: 100%; page-break-after: avoid">
		<FONT FACE="helvetica, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Table
		of Contents</B></FONT></FONT></P>
	</DIV>
	<P><FONT COLOR="#000080"><U><A HREF="#__RefHeading__23087_1582432481">Abstract</A></U></FONT>	1</P>
	<P><FONT COLOR="#000080"><U><A HREF="#__RefHeading__23089_1582432481">Zusammenfassung</A></U></FONT>	2</P>
	<P>1<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23091_1582432481">
	Introduction</A></U></FONT>	6</P>
	<P STYLE="margin-left: 0.5cm">1.1<A HREF="#__RefHeading__23093_1582432481">
	Relationship to Object Orientation</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.2<A HREF="#__RefHeading__23095_1582432481">
	Relationship to procedural Instruction Flow Languages</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.3<A HREF="#__RefHeading__23097_1582432481">
	Programmable Logic Controllers</A>	6</P>
	<P STYLE="margin-left: 0.5cm">1.4<A HREF="#__RefHeading__23099_1582432481">
	Relationship to Integrated Circuits</A>	7</P>
	<P STYLE="margin-left: 0.5cm">1.5<A HREF="#__RefHeading__23101_1582432481">
	Summary</A>	7</P>
	<P>2<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23103_1582432481">
	Language description</A></U></FONT>	8</P>
	<P STYLE="margin-left: 0.5cm">2.1<A HREF="#__RefHeading__23105_1582432481">
	Immediate Variables</A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.2<A HREF="#__RefHeading__23107_1582432481">
	Immediate Types</A>	8</P>
	<P STYLE="margin-left: 1cm">2.2.1<A HREF="#__RefHeading__23109_1582432481">
	Immediate declarations</A>	8</P>
	<P STYLE="margin-left: 1cm">2.2.2<A HREF="#__RefHeading__23111_1582432481">
	extern immediate declarations</A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.3<A HREF="#__RefHeading__23113_1582432481">
	Immediate Expressions</A>	8</P>
	<P STYLE="margin-left: 0.5cm">2.4<A HREF="#__RefHeading__23115_1582432481">
	Operators in immediate expressions</A>	8</P>
	<P STYLE="margin-left: 1cm">2.4.1<A HREF="#__RefHeading__23117_1582432481">
	Arithmetic and Relational Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.2<A HREF="#__RefHeading__23119_1582432481">
	Bitwise integer Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.3<A HREF="#__RefHeading__6945_1995752089">
	Bit Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.4<A HREF="#__RefHeading__23121_1582432481">
	Logical Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.5<A HREF="#__RefHeading__23123_1582432481">
	Conditional Operators</A>	9</P>
	<P STYLE="margin-left: 1cm">2.4.6<A HREF="#__RefHeading__23125_1582432481">
	Comma Operator</A>	10</P>
	<P STYLE="margin-left: 1cm">2.4.7<A HREF="#__RefHeading__11688_582495375">
	Parentheses</A>	10</P>
	<P STYLE="margin-left: 0.5cm">2.5<A HREF="#__RefHeading__11690_582495375">
	Function and macro calls</A>	10</P>
	<P STYLE="margin-left: 0.5cm">2.6<A HREF="#__RefHeading__11692_582495375">
	Immediate statements</A>	11</P>
	<P STYLE="margin-left: 1cm">2.6.1<A HREF="#__RefHeading__23131_1582432481">
	Immediate Assignments</A>	11</P>
	<P STYLE="margin-left: 1cm">2.6.2<A HREF="#__RefHeading__10333_582495375">
	Aliases</A>	11</P>
	<P STYLE="margin-left: 1cm">2.6.3<A HREF="#__RefHeading__23135_1582432481">
	The single assignment rule</A>	11</P>
	<P STYLE="margin-left: 0.5cm">2.7<A HREF="#__RefHeading__23137_1582432481">
	Immediate control statements</A>	12</P>
	<P STYLE="margin-left: 1cm">2.7.1<A HREF="#__RefHeading__23139_1582432481">
	Immediate conditional statement</A>	12</P>
	<P STYLE="margin-left: 1cm">2.7.2<A HREF="#__RefHeading__23141_1582432481">
	Immediate switch statement</A>	12</P>
	<P STYLE="margin-left: 0.5cm">2.8<A HREF="#__RefHeading__23143_1582432481">
	Literal blocks</A>	13</P>
	<P STYLE="margin-left: 0.5cm">2.9<A HREF="#__RefHeading__23145_1582432481">
	Comments</A>	13</P>
	<P STYLE="margin-left: 0.5cm">2.10<A HREF="#__RefHeading__23147_1582432481">
	Scope of immediate statements</A>	13</P>
	<P STYLE="margin-left: 0.5cm">2.11<A HREF="#__RefHeading__7491_1995752089">
	Simple Example</A>	14</P>
	<P STYLE="margin-left: 0.5cm">2.12<A HREF="#__RefHeading__23149_1582432481">
	Intrinsic limitations of immediate statements</A>	14</P>
	<P STYLE="margin-left: 0.5cm">2.13<A HREF="#__RefHeading__23151_1582432481">
	Pragmas</A>	15</P>
	<P>3<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23153_1582432481">
	Arrays</A></U></FONT>	16</P>
	<P STYLE="margin-left: 0.5cm">3.1<A HREF="#__RefHeading__23155_1582432481">
	Immediate Arrays</A>	16</P>
	<P STYLE="margin-left: 0.5cm">3.2<A HREF="#__RefHeading__23157_1582432481">
	Use of immediate Arrays</A>	16</P>
	<P STYLE="margin-left: 0.5cm">3.3<A HREF="#__RefHeading__23159_1582432481">
	Implementation of immediate Arrays</A>	16</P>
	<P STYLE="margin-left: 1cm">3.3.1<A HREF="#__RefHeading__23161_1582432481">
	FOR loops</A>	18</P>
	<P STYLE="margin-left: 1cm">3.3.2<A HREF="#__RefHeading__23163_1582432481">
	IF ELSE control statements</A>	19</P>
	<P STYLE="margin-left: 1cm">3.3.3<A HREF="#__RefHeading__7395_1090881298">
	Index expressions</A>	20</P>
	<P STYLE="margin-left: 1cm">3.3.4<A HREF="#__RefHeading__23165_1582432481">
	immediate Array syntax</A>	21</P>
	<P STYLE="margin-left: 0.5cm">3.4<A HREF="#__RefHeading__8903_1090881298">
	immac Macro facility</A>	22</P>
	<P STYLE="margin-left: 0.5cm">3.5<A HREF="#__RefHeading__8905_1090881298">
	Differences between iC and iCa code</A>	23</P>
	<P STYLE="margin-left: 0.5cm">3.6<A HREF="#__RefHeading__7826_384121057">
	immC Arrays</A>	24</P>
	<P>4<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23169_1582432481">
	Built-in Functions</A></U></FONT>	27</P>
	<P STYLE="margin-left: 0.5cm">4.1<A HREF="#__RefHeading__23171_1582432481">
	Unclocked flip-flop or LATCH</A>	27</P>
	<P STYLE="margin-left: 0.5cm">4.2<A HREF="#__RefHeading__23173_1582432481">
	FORCE function</A>	27</P>
	<P STYLE="margin-left: 0.5cm">4.3<A HREF="#__RefHeading__23175_1582432481">
	Clocked D flip-flop</A>	28</P>
	<P STYLE="margin-left: 0.5cm">4.4<A HREF="#__RefHeading__23177_1582432481">
	Clocked SR flip-flop</A>	28</P>
	<P STYLE="margin-left: 0.5cm">4.5<A HREF="#__RefHeading__23179_1582432481">
	Clocked JK flip-flop</A>	29</P>
	<P STYLE="margin-left: 0.5cm">4.6<A HREF="#__RefHeading__7397_1090881298">
	Clocked SRX flip-flop</A>	29</P>
	<P STYLE="margin-left: 0.5cm">4.7<A HREF="#__RefHeading__23183_1582432481">
	D flip-flop with Set and Reset</A>	30</P>
	<P STYLE="margin-left: 0.5cm">4.8<A HREF="#__RefHeading__23185_1582432481">
	Mono-Flop ST(set, timer, delay) or SRT(set, reset, timer, delay)</A>	30</P>
	<P STYLE="margin-left: 0.5cm">4.9<A HREF="#__RefHeading__23187_1582432481">
	Sample and Hold</A>	30</P>
	<P STYLE="margin-left: 0.5cm">4.10<A HREF="#__RefHeading__23189_1582432481">
	Sample and Hold with Set and Reset</A>	30</P>
	<P STYLE="margin-left: 0.5cm">4.11<A HREF="#__RefHeading__23191_1582432481">
	Edge detectors</A>	30</P>
	<P>5<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23193_1582432481">
	Clock Signals</A></U></FONT>	31</P>
	<P STYLE="margin-left: 0.5cm">5.1<A HREF="#__RefHeading__23195_1582432481">
	Built-in immediate clock</A>	31</P>
	<P STYLE="margin-left: 0.5cm">5.2<A HREF="#__RefHeading__23197_1582432481">
	CLOCK function</A>	32</P>
	<P STYLE="margin-left: 0.5cm">5.3<A HREF="#__RefHeading__23199_1582432481">
	TIMER function</A>	32</P>
	<P STYLE="margin-left: 0.5cm">5.4<A HREF="#__RefHeading__8480_2073158470">
	TIMER1 function</A>	33</P>
	<P>6<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23203_1582432481">
	Inputs and Outputs</A></U></FONT>	34</P>
	<P STYLE="margin-left: 0.5cm">6.1<A HREF="#__RefHeading__23205_1582432481">
	Built-in Inputs</A>	34</P>
	<P STYLE="margin-left: 1cm">6.1.1<A HREF="#__RefHeading__23207_1582432481">
	iClock</A>	34</P>
	<P STYLE="margin-left: 1cm">6.1.2<A HREF="#__RefHeading__10198_1097717954">
	End of Initialization</A>	34</P>
	<P STYLE="margin-left: 1cm">6.1.3<A HREF="#__RefHeading__10200_1097717954">
	Notification of a received line of standard input</A>	34</P>
	<P STYLE="margin-left: 1cm">6.1.4<A HREF="#__RefHeading__23211_1582432481">
	Timing inputs</A>	34</P>
	<P STYLE="margin-left: 0.5cm">6.2<A HREF="#__RefHeading__23213_1582432481">
	External Inputs and Outputs</A>	34</P>
	<P STYLE="margin-left: 1cm">6.2.1<A HREF="#__RefHeading__23215_1582432481">
	Digital inputs</A>	35</P>
	<P STYLE="margin-left: 1cm">6.2.2<A HREF="#__RefHeading__23217_1582432481">
	Digital outputs</A>	35</P>
	<P STYLE="margin-left: 1cm">6.2.3<A HREF="#__RefHeading__23219_1582432481">
	Analog inputs</A>	35</P>
	<P STYLE="margin-left: 1cm">6.2.4<A HREF="#__RefHeading__23221_1582432481">
	Analog outputs</A>	36</P>
	<P>7<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23223_1582432481">
	User defined immediate Function Blocks</A></U></FONT>	37</P>
	<P STYLE="margin-left: 0.5cm">7.1<A HREF="#__RefHeading__23225_1582432481">
	immediate Function Block Definition</A>	37</P>
	<P STYLE="margin-left: 0.5cm">7.2<A HREF="#__RefHeading__23227_1582432481">
	immediate Function Block Call</A>	39</P>
	<P STYLE="margin-left: 0.5cm">7.3<A HREF="#__RefHeading__7570_200243800">
	Parcel Sorter</A>	40</P>
	<P>8<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23229_1582432481">
	The iC run-time model</A></U></FONT>	46</P>
	<P STYLE="margin-left: 0.5cm">8.1<A HREF="#__RefHeading__23231_1582432481">
	Combinatorial immediate actions</A>	48</P>
	<P STYLE="margin-left: 0.5cm">8.2<A HREF="#__RefHeading__23233_1582432481">
	Clocked immediate actions</A>	51</P>
	<P STYLE="margin-left: 0.5cm">8.3<A HREF="#__RefHeading__23235_1582432481">
	Output actions</A>	52</P>
	<P STYLE="margin-left: 0.5cm">8.4<A HREF="#__RefHeading__23237_1582432481">
	Input actions</A>	52</P>
	<P STYLE="margin-left: 0.5cm">8.5<A HREF="#__RefHeading__7052_1756982362">
	Input/Output network</A>	52</P>
	<P>9<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23241_1582432481">
	Compiler and Run-time system</A></U></FONT>	53</P>
	<P STYLE="margin-left: 0.5cm">9.1<A HREF="#__RefHeading__23243_1582432481">
	Compiler</A>	53</P>
	<P STYLE="margin-left: 0.5cm">9.2<A HREF="#__RefHeading__23245_1582432481">
	Run-time libraries</A>	53</P>
	<P STYLE="margin-left: 0.5cm">9.3<A HREF="#__RefHeading__23247_1582432481">
	Run-time environment and system</A>	53</P>
	<P STYLE="margin-left: 1cm">9.3.1<A HREF="#__RefHeading__8442_110994698">
	iCbox, iClive and iCman in action</A>	54</P>
	<P STYLE="margin-left: 0.5cm">9.4<A HREF="#__RefHeading__8444_110994698">
	GTKWave Wave Analyzer</A>	56</P>
	<P>10<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23249_1582432481">
	Bibliography</A></U></FONT>	58</P>
	<P>11<FONT COLOR="#000080"><U><A HREF="#__RefHeading__23251_1582432481">
	The Author</A></U></FONT>	59</P>
	<P><FONT COLOR="#000080"><U><A HREF="#__RefHeading__13609_582495375">Appendix
	A README</A></U></FONT>	60</P>
	<P><FONT COLOR="#000080"><U><A HREF="#__RefHeading__23253_1582432481">Appendix
	B README.RPi</A></U></FONT>	62</P>
	<P><FONT COLOR="#000080"><U><A HREF="#__RefHeading__23255_1582432481">Appendix
	C Type Definition Table</A></U></FONT>	64</P>
</DIV>
<P CLASS="western" ALIGN=JUSTIFY><BR><BR>
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23091_1582432481"></A>
1    Introduction</H1>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>immediate
C</I> - <I>iC</I> for short - is a declarative extension of the
procedural language <I>C</I>. It utilizes the syntax of <I>C</I> to
give meaning to statements that have no semantic support in <I>C</I>.
In addition to standard variables, which are modified by the flow of
instructions, <I>iC</I> provides so called <I>'immediate'</I>
variables, whose values are updated, whenever a change of input calls
for an immediate change in output. An efficient Data Flow technique
implements this strategy.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23093_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif">1.1  Relationship to Object
Orientation</FONT></H2>
<P CLASS="western" STYLE="line-height: 0.4cm"><I>immediate C </I>uses
the OO-paradigm in its concept. Each <I>immediate </I>variable is an
independent object, which acts on other <I>immediate</I> variables by
a number of methods. These methods are expressed in a number of
functions and overloaded on to the logical and arithmetic operators.
In conventional OO languages like <I>Smalltalk</I> or <I>C++,</I> a
method is an action which acts on the object owning the method.
Conceptually descriptions of Object Orientation talk of methods being
actions or messages sent from one object to another. It is in this
sense that <I>iC immediate</I> variable objects interact with each
other by the use of Data Flow techniques.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23095_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif">1.2  Relationship to
procedural Instruction Flow Languages</FONT></H2>
<P CLASS="western" STYLE="line-height: 0.4cm"><SPAN LANG="en-GB">Traditional
High Level </SPAN><SPAN LANG="en-GB">procedural</SPAN><SPAN LANG="en-GB">
Languages such as </SPAN><SPAN LANG="en-GB"><I>Fortran</I></SPAN><SPAN LANG="en-GB">,
</SPAN><SPAN LANG="en-GB"><I>Pascal, </I></SPAN><SPAN LANG="en-GB"><I>Basic</I></SPAN><SPAN LANG="en-GB">
or </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB"> are
called Instruction Flow Languages, </SPAN><SPAN LANG="en-GB">because
they</SPAN><SPAN LANG="en-GB"> </SPAN><SPAN LANG="en-GB">prescribe</SPAN>
a systematic order of statements, functions and commands to complete
a computational task or program. They do this by<SPAN LANG="en-GB">
express</SPAN><SPAN LANG="en-GB">ing</SPAN><SPAN LANG="en-GB">
instruction sequences for </SPAN><SPAN LANG="en-GB">an </SPAN><SPAN LANG="en-GB">abstract
</SPAN><SPAN LANG="en-GB">machine</SPAN><SPAN LANG="en-GB"> </SPAN><SPAN LANG="en-GB">closely
modelled on a real computer</SPAN><SPAN LANG="en-GB">. By being
independent of the actual machine, these languages have helped to
hide unessential details of the hardware, to make programs portable
and to focus the programmer's attention on the problem to be solved.
The overwhelming usefulness of these </SPAN><SPAN LANG="en-GB">procedural
</SPAN><SPAN LANG="en-GB">instruction flow languages to express
precise algorithms is recognized in </SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB">,
by including the whole of </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">
or </SPAN><SPAN LANG="en-GB"><I>C++</I></SPAN><SPAN LANG="en-GB"> as
a subset, for dealing with algorithmic problems in established ways.
Learning of the language </SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB">
should therefore be very easy for </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">
and </SPAN><SPAN LANG="en-GB"><I>C++</I></SPAN><SPAN LANG="en-GB">
programmers. </SPAN>
</P>
<P CLASS="western" STYLE="line-height: 0.4cm">Many of the undesirable
characteristics of the underlying hardware are reflected in today's
procedural High Level Languages. These characteristics make it
difficult to express a large number of everyday problems briefly and
clearly. Particularly the manipulation of events is not easy to
integrate into programs written in traditional procedural High Level
Languages. Yet events play an increasing role in today's interactive,
mouse driven programs. Many different functions must be ready to
execute as a result of external or user generated events, which occur
at unpredictable times. <U>The instruction driven computer only
executes a particular instruction, </U><I><U>when the flow of
instructions in a program gets around to executing that instruction</U></I><U>.
This statement may sound pedantic, but much of the complexity of
</U><U>procedural</U><U> programs is a direct result of this
fundamental truism</U>. How does one organize a program, so that it
can respond quickly to many and varied external events? <I>iC</I>
provides answers to this question. The interrupt mechanism, designed
to tackle such problems at a system level, is intractable for the
average programmer and is not supported in a general way by most
procedural High Level Languages. <I>iC</I> harnesses interrupts and
hides their complexity. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23097_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif">1.3  Programmable Logic
Controllers</FONT></H2>
<P CLASS="western" STYLE="line-height: 0.4cm">The situation is even
more critical in systems that deal with a large number of external
inputs. In the early 1980's a completely new class of computer was
developed to deal with such problems in the environment of factories
and machine control. These are  &quot;Programmable Logic Controllers&quot;
or PLC's for short. (SPS or Speicher-Programmierbare Steuerung in
German) Conventional PLC's have a standard instruction driven
architecture. They differ from conventional computers in two main
areas: 
</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">They provide bit
	instructions and data access to individual bits in their instruction
	set on top of the more conventional instructions to manipulate data
	words. 
	</P>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">They have a built
	in operating system, which runs the stored program over and over.
	Inputs are automatically polled at reasonably short intervals and
	boolean and arithmetic expressions making up the stored program are
	re-evaluated continuously. This is necessary, because outputs and
	intermediate values in a PLC are assumed to reflect an immediate
	transformation of the inputs, as carried out by the expressions of
	the stored program. 
	</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">This organization of
PLC's has two very serious drawbacks, which are direct consequences
of the differences mentioned: 
</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">Conventional PLC's
	require a special CPU, which can never be as cheap as a mass
	produced microprocessor chip, or they emulate the PLC instruction
	set, in which case they are slower. 
	</P>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">The cyclic
	execution of the stored program sets very real limits to the length
	of possible programs. The longer the program, the longer the cycle
	time, which is the time interval at which inputs are polled. If this
	time gets too long, the response of the PLC is no longer acceptable
	for many applications. 
	</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">PLC's are facing a
crisis on two fronts:</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">Traditionally PLC
	program memories in the 80's were measured in kilobytes. Today
	megabytes of memory are available at low cost. This 1000 fold
	increase in potential program size cannot be utilized with the
	cyclic execution strategy of conventional PLC's. Even with a 10 fold
	increase in speed, these machines would be too slow. (Gigabytes is
	standard in the 21<SUP>st</SUP> century)</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">Because PLC's are
completely compute bound, the type of program organization they use
is unacceptable for standard computers. Nevertheless many programmers
designing event controlled applications on standard computers resort
to polling schemes, despite the drawbacks involved. The procedural
High Level Languages they use do not give them any simple
alternatives. 
</P>
<UL>
	<LI><P CLASS="western" STYLE="line-height: 0.4cm">The second crisis
	is the lack of a High Level Language for PLC's. Most PLC programs
	are developed with antiquated tools that support semi graphical
	languages for Boolean logic and assembly programming for numerical
	subsystems. The international standard IEC-1131 is attempting to
	fill this vacuum by specifying such a language. Unfortunately this
	standard simply freezes current programming practice, by
	incorporating five different languages, four of which are the semi
	graphical and assembly languages in common use today. For
	algorithmic programming it introduces a completely new High Level
	Language called 'Structured Text', which will require a large
	learning effort by programmers and whose utility in the limited area
	of PLC's seems doubtful. IEC-1131 makes no attempt to confront the
	fundamental speed problems facing PLC users. 
	</P>
</UL>
<P CLASS="western" STYLE="line-height: 0.4cm">The declarative
language <I>iC</I> can be used to program standard computer systems
and PLC's in a uniform way. <I>iC</I> is fast, because it responds
immediately to any changes in input, and does not waste time
evaluating expressions, whose input operands have not changed. The
extensions which <I>iC</I> offers over the algorithmic language <I>C</I>,
can also be coded graphically, using current CAD packages for IC
design. For factory staff, who require very simple programming
methods, the use of <I>Ladder Diagram (LD)</I> or <I>Function Block
Diagram (FBD)</I> in conformity with IEC-1131, using suitable front
ends is possible.</P>
<H2 CLASS="western"><A NAME="__RefHeading__23099_1582432481"></A>1.4 
Relationship to Integrated Circuits</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm"><I>iC</I>
provides programmers with built in operators, whose function is
closely modelled on integrated circuits. The name <I>iC</I> is a
reminder of this fact. Logical <I>AND</I>, <I>OR</I>, <I>EXCLUSIVE-OR
</I>and <I>NOT</I> are the basic functions implemented using a very
fast data-flow algorithm. The full range of arithmetic operators is
also available. These are not normally considered as hardware
components, although once they formed the basis of the very important
“Analog Computer”. They can be used for implementing control
algorithms, fuzzy logic – the possibilities are endless. Also
implemented as efficient built in functions are the D flip-flop, SR
flip-flop, JK flip-flop, shift register and many other popular
integrated circuit types, which are implemented in such a way, that
their use in <I>iC</I> programs follows the same design rules, which
apply to their hardware counterparts. These rules have led to a
well-developed hardware technology, whose effectiveness is
demonstrated by the success of today's complex computer hardware.
Particularly the concept of clocked functions plays an important role
in the language <I>iC</I>. It gives the same protection against
timing races in <I>iC</I> programs, as it provides for hardware IC
designs. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">Another
idea taken from integrated circuits is Large-Scale-Integration. User
defined Function Blocks emulate LSI circuits and produce complex
sub-units with a known functionality and a well defined external
interface, which can be re-used without regard to the internals. IC
hardware design may not be part of the average programmers
repertoire, but there is much literature on the subject. The run-time
code is not meant to be just a simulation of IC hardware – the
generated code is extremely fast, because of the data-flow techniques
used and provides powerful control programs. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23101_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif">1.5  Summary</FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">Writing
programs in the language <I>iC</I> has the added quality, that many
simple ideas and relationships, which should result in direct
actions, can be written down <I>immediately</I> in one line. 
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; font-style: normal"><FONT FACE="Courier, monospace"><B>if
(IX0.0) { printf(”Hello! world\n”); }</B></FONT></P>
<P CLASS="western">This is a complete runnable <I>iC</I> program.
<FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>IX0.0</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT>is an external <I>immediate</I> bit input in IEC-1131
notation, which generates an event when it changes state. The coding
of call back routines and other overhead is not required. It was this
thought, which also prompted the name &quot;<I>immediate C</I>&quot;.
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23103_1582432481"></A>
<FONT SIZE=4>2    Language description</FONT></H1>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23105_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif">2.1<I>  Immediate</I>
Variables </FONT>
</H2>
<P CLASS="western">An <I>immediate</I> variable is a data object that
has a value, but which also has the ability to transmit any change in
its value as an event. This event triggers the re-calculation of all
expressions that contain the <I>immediate</I> variable. The
fundamental assumption is, that <B>the value of an expression only
changes, if one of the variables making up the expression changes</B>.
Thus it is only necessary to re-calculate an expression, if one of
the variables making up the expression changes. Conversely, if an
expression is re-calculated whenever one of its variables changes,
and all unnecessary recalculations of expressions are left out, the
value of all expressions will be up to date within a very short time.
<I>Immediate</I> variables provide the mechanism to make this
strategy possible.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23107_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif">2.2  Immediate Types</FONT></H2>
<P CLASS="western"><I>iC</I> introduces the type modifier <FONT FACE="courier, monospace"><B>imm</B></FONT>
or <FONT FACE="courier, monospace"><B>immC</B></FONT> to declare
<I>immediate</I> variables of the basic data types <FONT FACE="courier, monospace"><B>int</B></FONT>
in <I>C</I> and the basic data type <FONT FACE="courier, monospace"><B>bit</B></FONT>,
which is a new data type in <I>iC</I>. Type <FONT FACE="courier, monospace"><B>bit</B></FONT>
declares variables capable of holding the values <FONT FACE="courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>1</B></FONT></FONT>.
Unless the <I>C</I> or <I>C++</I> compiler, used to translate the
generated code, itself supports bit as a basic data type, the use of
type bit is restricted to <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
The word 'boolean' was avoided deliberately, because it has a
different semantic bias in languages where it is used. (Truth of a
test rather than a single bit object). Both <FONT FACE="courier, monospace"><B>imm
int</B></FONT> and <FONT FACE="courier, monospace"><B>imm bit </B></FONT><SPAN STYLE="font-style: normal">are
value types, which must be assigned once (and only once) in an
</SPAN><I>immediate</I><SPAN STYLE="font-style: normal"> statement.
</SPAN><FONT FACE="courier, monospace"><SPAN STYLE="font-style: normal"><B>immC
int</B></SPAN></FONT><SPAN STYLE="font-style: normal"> and </SPAN><FONT FACE="courier, monospace"><SPAN STYLE="font-style: normal"><B>immC
bit </B></SPAN></FONT><SPAN STYLE="font-style: normal">are special
</SPAN><I>immediate</I><SPAN STYLE="font-style: normal"> value types,
which may only be assigned one or more times in </SPAN><I>C</I><SPAN STYLE="font-style: normal">
</SPAN><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">code</SPAN></SPAN><SPAN STYLE="font-style: normal">
segments.</SPAN></P>
<P CLASS="western"><I>iC</I> also has clocking types <FONT FACE="courier, monospace"><B>imm
clock</B></FONT> and <FONT FACE="courier, monospace"><B>imm timer</B></FONT>,
which can only be used as function parameters. These will be
discussed later.</P>
<H3 CLASS="western"><A NAME="__RefHeading__23109_1582432481"></A>2.2.1<I>
</I><SPAN STYLE="font-style: normal"> </SPAN><I>Immediate
declarations</I></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
An <I>immediate</I> declaration declares an <I>immediate</I> variable
to be either of type <FONT FACE="courier, monospace"><B>imm int</B></FONT>,
<FONT FACE="courier, monospace"><B>imm bit</B></FONT>, <FONT FACE="courier, monospace"><B>immC
int</B></FONT>, <FONT FACE="courier, monospace"><B>immC bit</B></FONT>,
<FONT FACE="courier, monospace"><B>imm clock</B></FONT> or <FONT FACE="courier, monospace"><B>imm
timer</B></FONT>, using syntax similar to declarations in <I>C</I>.
Any value type variable not declared before it is used is assumed to
be of type <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
Undeclared clocking type variables inherit the type from the
assigning function. Calling the <I><B>immcc</B></I> compiler with the
strict option -S or the statement <FONT FACE="Courier, monospace"><B>use
strict</B></FONT> makes declarations mandatory for all <FONT FACE="courier, monospace"><B>imm
</B></FONT>variables – this is highly recommended. All variables in
a declaration may be assigned directly.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; font-style: normal">
<FONT FACE="Courier, monospace"><B>imm  int</B></FONT><FONT FACE="Courier, monospace">
fader, colour;				// declaration only<BR></FONT><FONT FACE="Courier, monospace"><B>imm
 int</B></FONT><FONT FACE="Courier, monospace"> brightness = fader *
colour;	// decl and assignment<BR></FONT><FONT FACE="Courier, monospace"><B>immC
bit</B></FONT><FONT FACE="Courier, monospace"> running;					// used
in C assignment</FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__23111_1582432481"></A><I>2.2.2
 extern immediate declarations</I></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Just like in <I>C</I>, several <I>iC</I> sources may be compiled
separately and linked into a single application. When immediate
variables declared and assigned in one source are referenced in
another source, they must be declared with an <FONT FACE="Courier, monospace"><B>extern</B></FONT>
declaration, before they can be used in an expression. 
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; font-style: normal"><FONT FACE="Courier, monospace"><B>extern
imm  int</B></FONT><FONT FACE="Courier, monospace"> fader,
colour;	<BR></FONT><FONT FACE="Courier, monospace"><B>extern imm  int</B></FONT><FONT FACE="Courier, monospace">
brightness;	<BR></FONT><FONT FACE="Courier, monospace"><B>extern </B></FONT><FONT FACE="Courier, monospace"><B>immC
bit</B></FONT><FONT FACE="Courier, monospace"> running;</FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23113_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.3<I> 
Immediate</I> Expressions </FONT></FONT>
</H2>
<P CLASS="western"><I>Immediate</I> expressions are arithmetic or bit
expressions external to all functions, which contain at least one
<I>immediate</I> value variable. <I>Immediate</I> arithmetic
expressions may also contain constant expressions. <B>An </B><I><B>immediate</B></I><B>
expression is re-calculated whenever the value of one of the
</B><I><B>immediate</B></I><B> variables it contains has changed (and
only then)</B>. This is the core of the event-driven strategy if <I>iC</I>.
If an expression consists only of constants and no <I>immediate</I>
variables it is a constant expression evaluated once during
initialisation (similar to global initialisation in <I>C</I>).</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23115_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.4  Operators
in <I>immediate</I> expressions</FONT></FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Most operators available in <I>C</I> may be used in <I>immediate</I>
expressions. The precedence of the operators is the same as in <I>C</I>.
Some <I>C</I> operators are not valid for <I>immediate</I>
expressions, because the semantics in <I>iC</I> are different. These
are the increment and decrement operators <FONT FACE="Courier, monospace"><B>++</B></FONT>
and <FONT FACE="Courier, monospace"><B>--</B></FONT>, as well as
structure and pointer operators <FONT FACE="Courier, monospace"><B>-&gt;
.</B></FONT>(dot) <FONT FACE="Courier, monospace"><B>&amp;</B></FONT>(address
of) and <FONT FACE="Courier, monospace"><B>*</B></FONT>(pointer
dereference). Assignment expressions <FONT FACE="Courier, monospace"><B>+=
</B></FONT>etc. are also not allowed. These restrictions do not apply
to embedded <I>C</I> code in literal blocks and <I>immediate</I> <I><SPAN STYLE="font-weight: normal">if
else</SPAN></I><B> </B>or <I><SPAN STYLE="font-weight: normal">switch</SPAN></I>
statements, which will be introduced later.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<SPAN LANG="en-GB">Array variables and index expressions using </SPAN><SPAN LANG="en-GB"><B>[
]</B></SPAN><SPAN LANG="en-GB"> are available with the Array
extensions of the language either as </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>immC</B></SPAN></FONT><SPAN LANG="en-GB">
Arrays or using </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>imm</B></SPAN></FONT><SPAN LANG="en-GB">
variables using the pre-compiler </SPAN><SPAN LANG="en-GB"><I><B>immac</B></I></SPAN><SPAN LANG="en-GB">
(called automatically). See <A HREF="#3.    Arrays|outline">section
3.</A></SPAN></P>
<H3 CLASS="western"><A NAME="__RefHeading__23117_1582432481"></A>2.4.1
 Arithmetic and Relational Operators</H3>
<P CLASS="western">The binary arithmetic operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>+
- * /</B></FONT></FONT>, the modulo operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>%</B></FONT></FONT>,
as well as unary <FONT FACE="courier, monospace"><FONT SIZE=2><B>-</B></FONT></FONT>
and <FONT FACE="courier, monospace"><FONT SIZE=2><B>+ </B></FONT></FONT>operate
on integer numeric values and yield<FONT FACE="Sanserif PS"><FONT SIZE=2><B>
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">numeric
</SPAN></FONT></FONT>results of type <FONT FACE="courier, monospace"><B>imm
int</B></FONT>. The same applies to the shift operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&lt;&lt;
</B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>&gt;&gt;</B></FONT></FONT>.
If an operand of the wrong type is used with one of these operators,
automatic type conversion takes place. Values of type <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> are converted to the <FONT FACE="courier, monospace"><B>int</B></FONT>
value<SPAN STYLE="font-weight: normal">s 0 or 1 corresponding to the
values of the</SPAN><B> </B><FONT FACE="courier, monospace"><B>bit</B></FONT>.
The relational and equality operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&lt;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>&lt;=</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>&gt;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>&gt;=</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>==</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>!=</B></FONT></FONT>
also have numeric operands, but these operators yield <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> results by default. 
</P>
<P CLASS="western"><I>Immediate</I> arithmetic, relational and
bitwise integer expressions with numeric operands may contain
constants, as well as <I>immediate</I> operands. 
</P>
<H3 CLASS="western"><A NAME="__RefHeading__23119_1582432481"></A>2.4.2
 Bitwise integer Operators</H3>
<P CLASS="western">If both operands of the binary operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>|</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>^ </B></FONT></FONT>or
the single operand of operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>~</B></FONT></FONT>
are numeric values  of type <FONT FACE="courier, monospace"><B>imm
int</B></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">or
constants</SPAN></FONT></FONT>, these operators carry out bitwise
manipulation on their integer operands – just like in <I>C</I>. The
result is an <FONT FACE="courier, monospace"><B>imm int</B></FONT>
numeric value. 
</P>
<H3 CLASS="western"><A NAME="__RefHeading__6945_1995752089"></A>2.4.3
 Bit Operators</H3>
<P CLASS="western" STYLE="margin-bottom: 0.21cm">If one or both of
the operands of the binary operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>|</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>^ </B></FONT></FONT>or
the single operand of operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>~</B></FONT></FONT>
are of type <FONT FACE="courier, monospace"><B>imm bit</B></FONT>,
these operators carry out the bit manipulation operations <I><B>and</B></I>,
<I><B>or</B></I>, <I><B>exclusive-or </B></I>and <I><B>not</B></I> on
<FONT FACE="courier, monospace"><B>imm bit</B></FONT> objects. The
result is an <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
Any operands of type <FONT FACE="courier, monospace"><B>imm int</B></FONT>
are converted to <FONT FACE="courier, monospace"><B>imm bit</B></FONT>.
The numeric value <FONT FACE="courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>converts to <FONT FACE="courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>(<FONT FACE="courier, monospace"><FONT SIZE=2><B>false</B></FONT></FONT>),
any other numeric value converts to <FONT FACE="courier, monospace"><FONT SIZE=2><B>1
</B></FONT></FONT>(<FONT FACE="courier, monospace"><FONT SIZE=2><B>true</B></FONT></FONT>).
The bit operators are used frequently in <I>immediate C</I>, since
bit manipulation is very common in event driven systems – more so
than in algorithmic programs written in conventional languages like
<I>C</I>, which does not even provide a type <I>bit</I>. Such logical
bit expressions in <I>immediate C</I> may not contain any constants
or <I>non-immediate</I> values. Constants in <I>immediate</I> bit
expressions do not make much sense. They either do not change a
variable e.g. <FONT FACE="courier, monospace"><FONT SIZE=2><B>a &amp;
1 </B></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><I><B>===</B></I></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>
a;</B></FONT></FONT> <FONT FACE="courier, monospace"><FONT SIZE=2><B>b
| 0 </B></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><I><B>===</B></I></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>
b </B></FONT></FONT>or they produce another constant e.g. <FONT FACE="courier, monospace"><FONT SIZE=2><B>c
&amp; 0 </B></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><I><B>===</B></I></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>
0;</B></FONT></FONT> <FONT FACE="courier, monospace"><FONT SIZE=2><B>d
| 1 </B></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><I><B>===</B></I></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>
1 </B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>~1
</B></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><I><B>===</B></I></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>
0</B></FONT></FONT>. 
</P>
<H3 CLASS="western"><A NAME="__RefHeading__23121_1582432481"></A>2.4.4
 Logical Operators</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The logical connectives <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;&amp;
</B></FONT></FONT>and <FONT FACE="courier, monospace"><FONT SIZE=2><B>||
</B></FONT></FONT>are executed as arithmetic expressions, when one or
both of the operands are of type <FONT FACE="courier, monospace"><B>imm
int</B></FONT>. Evaluation is from left to right, and evaluation
stops when the truth or falsehood of the result is known – just
like in <I>C</I>. The result is of type <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> by default. The unary complement operator <FONT FACE="courier, monospace"><FONT SIZE=2><B>!</B></FONT></FONT>,
operating on an <FONT FACE="courier, monospace"><B>imm int</B></FONT>
operand produces an <FONT FACE="courier, monospace"><B>imm bit</B></FONT>
result. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>|| </B></FONT></FONT>and
<FONT FACE="courier, monospace"><FONT SIZE=2><B>! </B></FONT></FONT>with
only <FONT FACE="courier, monospace"><B>imm bit</B></FONT> operands
are interpreted by the compiler exactly like the bit operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;</B></FONT></FONT>,
<FONT FACE="courier, monospace"><FONT SIZE=2><B>| </B></FONT></FONT>and
<FONT FACE="courier, monospace"><FONT SIZE=2><B>~</B></FONT></FONT>.
There is little sense converting such bit operands to integers,
evaluating the arithmetic expression and then converting back to a
bit. Since evaluation of <FONT FACE="courier, monospace"><FONT SIZE=2><B>&amp;&amp;
</B></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">and
</SPAN></FONT></FONT><FONT FACE="courier, monospace"><FONT SIZE=2><B>||
</B></FONT></FONT>in bit expressions is not from left to right as
expected, but depends on which operands in the expression change,
their use and the use of <FONT FACE="courier, monospace"><FONT SIZE=2><B>!</B></FONT></FONT>
in expressions where all operands are <FONT FACE="courier, monospace"><B>imm
bit</B></FONT> is deprecated and causes a warning.</P>
<H3 CLASS="western"><A NAME="__RefHeading__23123_1582432481"></A>2.4.5
 Conditional Operators</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The operators <FONT FACE="courier, monospace"><FONT SIZE=2><B>? :
</B></FONT></FONT>implement conditional expressions, just like in <I>C</I>,
which are evaluated as a whole in an arithmetic context. The
conditional expression 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">expression_1
<B>?</B> expression_2 <B>:</B> expression_3 </FONT>
</P>
<P CLASS="western">is a valid <I>immediate</I> arithmetic expression,
which is triggered by a change in any <I>immediate</I> variable in
any of the three sub-expressions. 
</P>
<P CLASS="western">An alternate form of conditional expression, which
leaves out the middle expression is allowed by modern <I>C</I>
compilers, particularly by <SPAN STYLE="font-style: normal"><B>gcc</B></SPAN>
and is allowed in <I>iC</I><SPAN STYLE="font-style: normal"> (if the
</SPAN><I>C</I><SPAN STYLE="font-style: normal"> compiler used
supports the construct)</SPAN></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">expression_1
<B>? :</B> expression_3 </FONT>
</P>
<P CLASS="western">The following excerpt from 'info <SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">gcc</SPAN></SPAN>'
explains the advantages and use of the construct:</P>
<P CLASS="western" STYLE="margin-left: 1.25cm"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">5.8
Conditionals with Omitted Operands</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">The
middle operand in a conditional expression may be omitted. Then if
the first operand is non-zero, its value is the value of the
conditional expression.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
   <FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Therefore,
the expression</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.16cm; line-height: 0.32cm; page-break-inside: avoid; widows: 2; orphans: 2">
     <FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>x
? : y</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">has
the value of `<B>x</B>' if that is non-zero; otherwise, the value of
`<B>y</B>'.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
   <FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">This
example is perfectly equivalent to</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.16cm; line-height: 0.32cm; page-break-inside: avoid; widows: 2; orphans: 2">
     <FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>x
? x : y</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.16cm; line-height: 0.32cm; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">In
this simple case, the ability to omit the middle operand is not
especially useful. When it becomes useful is when the first operand
does, or may (if it is a macro argument), contain a side effect. Then
repeating the operand in the middle would perform the side effect
twice. Omitting the middle operand uses the value already computed
<SPAN STYLE="font-weight: normal">without the undesirable effects of
recomputing it.</SPAN></FONT></FONT></P>
<H3 CLASS="western"><A NAME="DDE_LINK211"></A><A NAME="__RefHeading__23125_1582432481"></A>
2.4.6  Comma Operator</H3>
<P CLASS="western">Commas used as operators have the lowest
precedence and are only available in <I>iC</I> as a list of
expressions in parentheses with further restrictions. As in <I>C</I>
the value of the list is the last expression in the list, which may
be a plain expression. The leading elements must be either
assignments or <I>immediate</I> void function calls for the same
reason that plain expression statements are not allowed in <I>iC</I>
as explained in the 2<SUP>nd</SUP> paragraph of <A HREF="#2.6.  Immediate statements|outline">section
2.6</A>.</P>
<H3 CLASS="western"><A NAME="__RefHeading__11688_582495375"></A>2.4.7<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><SPAN LANG="en-GB"><I>
 </I></SPAN></FONT></FONT>Parentheses 
</H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
In <I>immediate C</I> it is possible to write mixed arithmetic and
bit expressions, nested to any depth using the usual <I>C</I>
precedence rules and parentheses.</P>
<P CLASS="western"><I>Immediate</I> arithmetic expressions are
evaluated as a whole <I>C</I> expression every time one of their
component <I>immediate</I> variables changes – but only then. To
improve execution speed, it is sometimes more efficient to break up
very long <I>immediate</I> arithmetic expressions with many operands
into several sub-expressions – particularly if each sub-expression
is triggered by different operands. In this case not all the
sub-expressions are executed. On the other hand there is a certain
amount of overhead for triggering each new node and execution of a
compiled <I>C</I> expression is fast, even if it has many operands.</P>
<P CLASS="western"><I>Immediate</I> bit expressions are compiled into
a network of forward looking nodes, one for each different bit
operand and execute even more efficiently. There is no need to break
up a complex immediate bit expression into sub-expressions – the
compiler does this already. <I>Immediate</I> bit expressions embedded
in an arithmetic expression are compiled into separate
sub-expressions and only the type converted arithmetic result is used
in the arithmetic expression.</P>
<H2 CLASS="western"><A NAME="__RefHeading__11690_582495375"></A>2.5 
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><SPAN LANG="en-GB">Function
and macro calls</SPAN></FONT></FONT></H2>
<P CLASS="western"><I>Immediate</I> expressions may contain function
calls for several types of functions and macros. All of these look
very similar to <I>C</I> function calls. The differences will be
discussed in later chapters. These can be:</P>
<OL>
	<LI><P CLASS="western">Built in <I>iC</I> function calls. The
	parameter ramps and return values are pre-defined.</P>
	<LI><P CLASS="western">User defined <I>iC</I> function block calls.
	These must be defined by the user before they are called.</P>
	<LI><P CLASS="western"><I>C</I> function calls – only allowed in
	<I>immediate</I> aritmetic expressions and C code of course. 
	</P>
	<LI><P CLASS="western"><I>C</I> pre-processor macro calls.</P>
</OL>
<P CLASS="western"><I>C</I> function and macros called in immediate
expressions may only have <FONT FACE="Courier, monospace"><B>int</B></FONT>
parameters (if any) and an <FONT FACE="Courier, monospace"><B>int</B></FONT>
return value. They should be declared as follows to evoke an error
message if the function name is mistyped or the parameter ramp or
return value is wrong:</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm"><FONT FACE="Courier, monospace"><B>extern
int</B> rand();		// C function with no parameters<BR><B>extern int</B>
rand(<B>void</B>);		// alternative syntax<BR><B>extern int</B>
abs(<B>int);</B>		// C function with 1 parameter<BR><B>extern int</B>
min(<B>int</B>, <B>int</B>);	// macro with 2 parameters</FONT></P>
<P CLASS="western">When 'strict' is active, any <I>C</I> functions or
macros, which are called in <I>immediate</I> expressions must be
declared in the <I>iC</I> code. If 'strict' is not active, mistyped
function names with any type of parameter ramp look like <I>C</I>
function calls and will be compiled as such without error. This error
is not discovered until link time. With an <FONT FACE="Courier, monospace"><B>extern</B></FONT>
declaration, a clean error message is produced and the extra effort
is not great. When a pre-declared <I>C</I> function or macro is
called in an <I>immediate</I> expression, a check is made, that the
number of parameters is correct. Otherwise an error message is
issued. 
</P>
<P CLASS="western">If declared a second time, the following will
evoke a warning if 'strict'</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; text-indent: 0.02cm">
<FONT FACE="Courier, monospace"><B>extern bit</B> rand();		// wrong
return type – converted to int</FONT></P>
<P CLASS="western">If declared a second time, the following will
evoke an error if 'strict'</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm"><FONT FACE="Courier, monospace"><B>extern
int</B> rand;			// not used as a function<BR><B>extern clock</B>
rand();		// absolutely wrong return type<BR><B>extern timer</B>
rand();		// absolutely wrong return type</FONT></P>
<P CLASS="western">No check is made for <I>C</I> function calls in <I>C</I>
fragments controlled by <FONT FACE="Courier, monospace"><B>if else</B></FONT>
or <FONT FACE="Courier, monospace"><B>switch</B></FONT> statements or
other literal <I>C</I> code, since the compilation is handled by the
follow up <I>C</I> compiler. Note: built in <I>iC</I> functions and
<I>iC</I> function blocks <SPAN STYLE="font-weight: normal">cannot</SPAN>
be called in such <I>C</I> fragments under any circumstances.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__11692_582495375"></A><A NAME="2.6.  Immediate statements|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.6  <I>Immediate</I>
statements</FONT></FONT></H2>
<P CLASS="western">Most <I>immediate</I> statements are <I>immediate</I>
declarations or <I>immediate</I> assignments terminated by a
semicolon. <I>Immediate</I><I> </I><SPAN STYLE="font-style: normal">declarations</SPAN>
and assignments may be combined. Other statements are <I>immediate</I>
function definitions, <I>immediate</I> void function calls and
finally <I>immediate</I> control statements <FONT FACE="Courier New, monospace"><B>if
else</B></FONT> and <FONT FACE="Courier New, monospace"><B>switch</B></FONT>.</P>
<P CLASS="western">Plain expression statements, which are not
assigned to anything, as in <I>C</I><SPAN STYLE="font-style: normal">
</SPAN><SPAN STYLE="font-style: normal">are </SPAN><SPAN STYLE="font-style: normal">mostly
</SPAN><SPAN STYLE="font-style: normal">meaningless in </SPAN><I>iC</I><SPAN STYLE="font-style: normal">
and are not allowed. They would only have meaning if they had a side
effect and these have been carefully avoided in </SPAN><I>iC</I><SPAN STYLE="font-style: normal">.
An exception would be an </SPAN><I>immediate</I><SPAN STYLE="font-style: normal">
</SPAN><SPAN STYLE="font-style: normal">function call that also
assigns another value to one or more of its parameters. Since this is
rare it was felt that it was more important to use the return value
or evoke an error.</SPAN></P>
<H3 CLASS="western"><A NAME="__RefHeading__23131_1582432481"></A>2.6.1<I>
 Immediate</I> Assignments 
</H3>
<P CLASS="western"><I>Immediate</I> assignments are assignments of
<I>immediate</I> expressions to <I>immediate</I> variables external
to all functions. Value changes to an <I>immediate</I> variable are
detected in the assignment and this event triggers the re-calculation
of follow on expressions. Like in <I>C</I>, an <I>immediate</I>
assignment is also an <I>immediate</I> expression, which means that
assignments embedded in expressions are allowed. As noted earlier,
<I>immediate</I> assignments can be combined with the declarations of
<I>immediate</I> variables, but such declaration assignments are not
an expression. 
</P>
<H3 CLASS="western"><A NAME="__RefHeading__10333_582495375"></A>2.6.2
 Aliases 
</H3>
<P CLASS="western"><I>Immediate</I> arithmetic and bit assignments,
in which the right hand expression consists of only a single
<I>immediate</I> variable or constant are accepted by the <I>iC</I>
compiler, but produce no code. This type of statement is called an
alias. The alias name on the left hand side is simply an alternative
name for the <I>immediate</I> variable on the right hand side. Any
reference to the alias will be substituted by the right hand side
variable, whose value is always the correct <I>immediate</I> value of
the intended assignment. Bit aliases may be either <I>normal</I> or
<I>inverting</I>. The bit <I>not</I> operator <FONT FACE="Courier, monospace"><B>~</B></FONT>
does not produce any code when used on an <FONT FACE="Courier, monospace"><B>imm
bit </B></FONT>operand. All <FONT FACE="Courier, monospace"><B>~x
</B></FONT>sub-expressions are implemented as inverting aliases of <FONT FACE="Courier, monospace"><B>x</B></FONT>.
Thus the direct assignment of <FONT FACE="Courier, monospace"><B>~x
</B></FONT>to another <FONT FACE="Courier, monospace"><B>imm bit
</B></FONT>variable is also an (inverting) alias.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><A NAME="DDE_LINK3"></A>
<FONT FACE="Courier, monospace"><B>imm bit</B> a, b;	b = a;	// b is
an alias for a   (normal)<BR><B>imm bit</B> x, nx;	nx = ~x;	// nx is
an alias for ~x (inverting)<BR><B>imm int</B> j, k;	k = j;	// k is an
alias for j<BR><B>imm int</B> two;	two = 2;	// two is an alias for 2</FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__23135_1582432481"></A>2.6.3
 The single assignment rule 
</H3>
<P CLASS="western"><I>Immediate</I> assignments must obey the single
assignment rule, a rule which applies generally for data flow
systems<A CLASS="sdfootnoteanc" NAME="sdfootnote1anc" HREF="#sdfootnote1sym"><SUP>1</SUP></A>.
<U>Any </U><I><U>immediate</U></I><U> variable may only be assigned
in </U><U><B>one</B></U><U> </U><I><U>immediate</U></I><U>
assignment</U>. The value of an <I>immediate</I> variable is the
value of the expression, from which it is assigned, at all times. A
second assignment to the same <I>immediate</I> variable would force
different values on that variable, causing a conflict. The <I>immediate</I>
variable being assigned cannot hold different values simultaneously.
The single assignment rule is monitored by the <I>iC</I> compiler. An
error message is generated if it is broken. 
</P>
<P CLASS="western">Expressions that occur in <I>C</I> code triggered
by <I>immediate</I> conditional <I>if else</I> or <I>switch</I>
statements or in <I>C</I> functions in literal blocks may contain
<FONT FACE="Courier, monospace"><B>immC</B></FONT> <I>immediate</I>
variables. These expressions are not <I>immediate</I> expressions and
are not triggered by those variables. When such an expression is
executed in the <I>C</I> code, the current value of any <I>immediate</I>
variable is used.</P>
<P CLASS="western"><I>Immediate</I> variables may even be assigned in
<I>C</I> code embedded in <I>immediate</I> conditional <I>if else</I>
or <I>switch</I> statements or in literal blocks. Such an assignment
is <B>not</B> an <I>immediate</I> assignment – the value is changed
when the <I>C</I> statement is executed. Nevertheless any change in
the <I>immediate</I> variable assigned in the <I>C</I> code will
trigger <I>immediate</I> expressions that contain that variable.
Several such assignments to the same <I>immediate</I> variable may be
made in different sections of <I>C</I> code. Every new assignment
changes the variable in accordance with the intended algorithm.
<I>Immediate</I> variables assigned in <I>C</I> code must be declared
as <FONT FACE="courier, sans-serif"><B>immC bit</B></FONT> or <FONT FACE="courier, sans-serif"><B>immC
int</B></FONT> in an <I>iC</I> code section. An <I>immediate</I>
variable that is assigned in <I>C</I> code may not also be assigned
in an <I>immediate</I> assignment. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23137_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.7  I<I>mmediate
control statements</I></FONT></FONT></H2>
<P CLASS="western">An <I>immediate</I> conditional <I>if else</I>
statement and an <I>immediate</I> <I>switch</I> statement are the
only control  constructs available in <I>iC</I>. The syntax of both
statement types is similar to their <I>C</I> counterpart, except that
braces around the <I>C</I> statements are mandatory. In particular an
<I><SPAN STYLE="font-weight: normal">else if</SPAN></I> is not
allowed, since the <I><SPAN STYLE="font-weight: normal">if</SPAN></I>
after the <I><SPAN STYLE="font-weight: normal">else</SPAN></I> would
have been part of the <I>C</I> statement controlled by the <I><SPAN STYLE="font-weight: normal">else</SPAN></I>
part of the whole <I>immediate</I> <I><SPAN STYLE="font-weight: normal">if</SPAN></I>
statement, which would be very confusing. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>if</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Courier, monospace">imm_bit_expression</FONT><FONT FACE="Courier, monospace"><B>)</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">
C_statement_1 </FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace"><I><BR></I></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>if</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>(</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">imm_bit_expression</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>)</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>{</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
C_statement_1 </SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>}</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>else</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>{</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">
C_statement_2 </SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>}</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><BR></SPAN></FONT><FONT FACE="Courier, monospace"><B>switch</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Courier, monospace">imm_int_expression</FONT><FONT FACE="Courier, monospace"><B>)</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">
C_statement </FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">
</FONT></FONT>
</P>
<P CLASS="western"><SPAN LANG="en-GB">These are valid </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
statements when they occur external to any function. The controlling
expression in each case must be an </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
expression. The controlling expressions in </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
conditional </SPAN><SPAN LANG="en-GB"><I>if else</I></SPAN><SPAN LANG="en-GB">
or </SPAN><SPAN LANG="en-GB"><I>switch</I></SPAN><SPAN LANG="en-GB">
statements are synchronized by a clock. The default clock is </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>iClock</B></SPAN></FONT><SPAN LANG="en-GB">,
when no specific clock is coded (as in the above examples). Other
clocks or timers may be specified as explained in <A HREF="#5.    Clock Signals|outline">section
5</A>. In all cases any change in the controlling </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
expression, synchronized by the controlling clock, triggers execution
of the </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">
statements.</SPAN></P>
<H3 CLASS="western"><A NAME="__RefHeading__23139_1582432481"></A><I>2.7.1
 Immediate conditional statement</I></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<I>immediate</I> conditional statements use the keyword <I><B>if</B></I>
and optionally<I><B> else</B></I>. The controlling expression for an
<I>immediate</I> conditional statement is an <I>immediate</I> bit
expression. If not, it is converted from <FONT FACE="Courier, monospace"><B>int</B></FONT><SPAN STYLE="font-weight: normal">
</SPAN>to<FONT FACE="Courier, monospace"><FONT SIZE=2><B> bit
</B></FONT></FONT>automatically. A <FONT FACE="Courier, monospace"><FONT SIZE=2><B>0</B></FONT></FONT>
to <FONT FACE="Courier, monospace"><FONT SIZE=2><B>1 </B></FONT></FONT>transition
or rising edge causes <FONT FACE="Courier, monospace">C_statement_1
</FONT>to be executed. A <FONT FACE="Courier, monospace"><FONT SIZE=2><B>1
</B></FONT></FONT>to <FONT FACE="Courier, monospace"><FONT SIZE=2><B>0
</B></FONT></FONT>transition or falling edge causes <FONT FACE="Courier, monospace">C_statement_2
</FONT>to be executed (if an <I>else</I> is coded). The <FONT FACE="Courier, monospace"><FONT SIZE=2>C_statements</FONT></FONT>
are embedded <I>C</I> compound statements, <B>not</B> <I>immediate</I>
statements.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>%{<BR>int
</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">a,
b, c;			/* C declarations in a literal block */</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>void
</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">reset</SPAN></FONT><FONT FACE="Courier, monospace"><B>(void);</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">		/*
C function declaration */</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>%}<BR><BR>imm
bit</B></FONT><FONT FACE="Courier, monospace"> sw1, sw2, sw3;	//
immediate declarations<BR></FONT><FONT FACE="Courier, monospace"><B>imm
clock</B></FONT><FONT FACE="Courier, monospace"> cl;			// use cl
rather than iClock<BR><BR></FONT><FONT FACE="Courier, monospace"><B>if</B></FONT><FONT FACE="Courier, monospace">
(sw1 &amp; sw2 | sw3, cl) </FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">	/*
imm controlling expression */<BR>	a = 1; b = 12; c = -2;	/* C code
executed on rising edge */<BR></FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>else {</B></FONT><FONT FACE="Courier, monospace"><BR></FONT><FONT FACE="Courier, monospace"><B>	</B></FONT><FONT FACE="Courier, monospace">reset();			/*
C code executed on falling edge */<BR></FONT><FONT FACE="Courier, monospace"><B>}</B></FONT></FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__23141_1582432481"></A>2.7.2
 <I>Immediate switch statement</I></H3>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
For the <I>immediate</I> <I>switch</I> statement, the controlling
expression is an <I>immediate</I> int expression. The <FONT FACE="Courier, monospace"><FONT SIZE=2>C_statement</FONT></FONT>
is an embedded compound statement, which has the usual form of a <I>C</I>
switch statement with case labels. Any change in the controlling
expression triggers the switch statement. The value of that
expression after the change is applied to the switch and the selected
case is executed. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>%{
enum </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">Fuzzy</SPAN></FONT><FONT FACE="Courier, monospace"><B>
{ </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">OFF,
DIM, MEDIUM, BRIGHT</SPAN></FONT><FONT FACE="Courier, monospace"><B>
}</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">;
</SPAN></FONT><FONT FACE="Courier, monospace"><B>%}</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">	//
literal block</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>switch</B></FONT><FONT FACE="Courier, monospace">
(brightness, cl) </FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">	//
declared and assigned above</SPAN></FONT><FONT FACE="Courier, monospace"><BR></FONT><FONT FACE="Courier, monospace"><B>	case</B></FONT><FONT FACE="Courier, monospace">
OFF:	lightVoltage(0);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR></FONT><FONT FACE="Courier, monospace"><B>	case</B></FONT><FONT FACE="Courier, monospace">
DIM:	lightVoltage(10);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR>	</FONT><FONT FACE="Courier, monospace"><B>case</B></FONT><FONT FACE="Courier, monospace">
MEDIUM:	lightVoltage(18);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR>	</FONT><FONT FACE="Courier, monospace"><B>case</B></FONT><FONT FACE="Courier, monospace">
BRIGHT:	lightVoltage(24);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR>	</FONT><FONT FACE="Courier, monospace"><B>default</B></FONT><FONT FACE="Courier, monospace">:	lightVoltage(24);	</FONT><FONT FACE="Courier, monospace"><B>break</B></FONT><FONT FACE="Courier, monospace">;<BR></FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">			//
end of immediate switch statement </FONT></FONT>
</P>
<P CLASS="western">The <I>immediate</I> conditional <I>if else</I>
and <I>switch</I> statements open the way to trigger the execution of
short <I>C</I> fragments on particular events. These events are
either rising or falling edges of bit values or changing numeric
values. If more than a fragment of <I>C</I> code is involved, it is
good practice to code this in a <I>C</I> function, and to call that
function in the <I>immediate</I> statement. Very long <I>immediate</I>
statements would make the purpose of those statements unclear. Note:
depending on the time critical nature of the application, <I>C</I>
code should not take too long to execute, because during the
execution of such <I>C </I>fragments the processing of other
immediate events is held up.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23143_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.8  Literal
blocks</FONT></FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Literal blocks are sections of <I>C</I> code enclosed in special
braces <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%{ </B></FONT></FONT>and
<FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%}</B></FONT></FONT>.
They may occur before, between and after any <I>immediate</I>
statements. Literal blocks are copied verbatim to the front of the
generated <I>C</I> output code (without the special braces). Literal
blocks are useful to declare any <I>C</I> variables, define macros
and to declare and define auxiliary <I>C</I> functions to support the
application. Any <I>C</I>-pre-processor statements such as <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>#include
</B></FONT></FONT>or <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>#ifdef
</B></FONT></FONT>must be written as <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%#include
</B></FONT></FONT>or <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%#ifdef
</B></FONT></FONT>in the literal block. The <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%#</B></FONT></FONT>
must be written without intervening spaces. The <FONT FACE="courier, sans-serif"><FONT SIZE=2><B>%</B></FONT></FONT>
is dropped by the <I>iC</I> compiler in copying the literal block to
the generated <I>C</I> code. This allows <I>C</I>-pre-processor
statements for the <I>iC</I> sections of code which are resolved
before the <I>iC</I> compilation.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>%{</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal"><BR>%#include
&lt;math.h&gt;		/* special iC-pre-processor syntax */<BR>int x, y,
z;			/* declarations in a literal block */<BR>int abs(int);			/* C
function declaration */<BR></SPAN></FONT><FONT FACE="Courier, monospace"><B>%}</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The run-time system will call the function <FONT FACE="Courier, monospace"><B>iCbegin()</B></FONT>
when an <I>iC</I> application is started before any <I>immediate</I>
processing. This function can be provided by the user in a literal
block. If it is not provided, an empty function <FONT FACE="Courier, monospace"><B>iCbegin()</B></FONT>
returning 0 is provided by the system. User implementations should
return 1. One use of <FONT FACE="Courier, monospace"><B>iCbegin()</B></FONT>
is to initialise <FONT FACE="Courier, monospace"><B>immC</B></FONT>
variables. It may even contain a fork() call to spawn a child
process, which will run in parallel with normal <I>immediate</I>
processing. This opens up the way to build mixed applications using
conventional multi-process or multi-threaded control strategies in
parallel with <I>immediate</I> <I>C</I> code, which leaves a lot of
CPU time to do other things.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The complementary function <FONT FACE="Courier, monospace"><FONT SIZE=2><B>iCend()</B></FONT></FONT>
is called by the run-time system when an <I>iC</I> application is
terminated externally (<I>iC</I> applications never terminate by
themselves, unless <FONT FACE="Courier, monospace"><FONT SIZE=2><B>iC_quit()</B></FONT></FONT>
is called in embedded <I>C</I> code). <FONT FACE="Courier, monospace"><FONT SIZE=2><B>iCend()</B></FONT></FONT>
could be used to free memory allocated with <I>malloc</I> or <I>new</I>.
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.21cm; font-weight: normal; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>%{</B> <BR>int
iCbegin()	{ ...; return 1; } /* optional C initialisation */<BR>int
iCend()	{ ...; return 1; } /* optional C termination */<BR><B>%}</B></FONT></FONT></P>
<P CLASS="western">If the code in literal blocks, or code in <I>C</I>
blocks controlled by an <I>immediate</I> <I><SPAN STYLE="font-weight: normal">if
else</SPAN></I> or <I><SPAN STYLE="font-weight: normal">switch</SPAN></I>,
is specifically <I>C++</I> code, then the generated code must be
compiled by a <I>C++</I> compiler. The Code generated from the <I>iC</I>
statements is pure <I>C</I> code.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23145_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.9  Comments</FONT></FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<I>C</I> style comments <FONT FACE="Courier, monospace"><B>/* ... */</B></FONT>
can be used anywhere between tokens of <I>iC</I> programs.<BR><I>C++</I>
style comments<FONT FACE="Courier, monospace"><B> </B></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">may
be used at the end of </SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">iC</SPAN></I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
lines.</SPAN></FONT></FONT>	<FONT FACE="Courier, monospace"><B>// ...</B></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Some older <I>C</I> compilers do not support <I>C++</I> comments, so
their use in literal blocks and <I>C</I> statement blocks controlled
by <FONT FACE="Sanserif PS"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">if
else</SPAN></I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
or </SPAN></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">switch</SPAN></I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I><B>
</B></I></FONT></FONT>may lead to portability problems.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23147_1582432481"></A>
<FONT FACE="Sanserif PS">2.10  Scope of <I>immediate</I> statements</FONT></H2>
<P CLASS="western"><SPAN LANG="en-GB"><I>Immediate</I></SPAN><SPAN LANG="en-GB">
variables are global or static and must be declared external to all
functions like other global variables in </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">.
Moreover all </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
statements must also be placed external to </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">
</SPAN><SPAN LANG="en-GB">functions. A statement in a function is
only executed (made active) during the execution of that function.
</SPAN><SPAN LANG="en-GB"><I>Immediate</I></SPAN><SPAN LANG="en-GB">
statements are active at all times. </SPAN><SPAN LANG="en-GB"><I>Immediate</I></SPAN><SPAN LANG="en-GB">
statements in a Function Block definition are a template, which is
copied in-line, every time the Function Block is called. See <A HREF="#7.    User defined immediate Function Blocks|outline">section
7</A>.</SPAN></P>
<P CLASS="western">Consecutive <I>immediate</I> statements are <B>not</B>
executed in sequence. Each <I>immediate</I> statement is independent
of all other <I>immediate</I> statements. They can be placed in any
order, without influencing the behaviour of the program. This is
analogous to the placement of global variables and functions in <I>C</I>.
</P>
<P CLASS="western"><I>Immediate</I> assignments are often combined
with their declarations and look like the initialization expressions
of ordinary global <I>C</I> variables. In <I>C</I>, this
initialization takes place before the function <I><SPAN STYLE="font-weight: normal">main()</SPAN></I>
is started. In <I>iC</I>, <I>immediate</I> statements simply stay
active until the program is stopped. For most of the time the process
running the <I>iC</I> program waits in a select() call, which wakes
up whenever an external input or internal timer changes. Because the
processing required to react to such an input is in the order of
microseconds, this strategy ensures that the CPU loading of an <I>iC</I>
process is minimal. This can be observed easily with tools like
<I>xosview</I> under Linux. Times measured with a modern 1.8 GHz
processor were &lt; 50 us, which is mostly overhead to get the input
process scheduled. The time to  execute a chain of 15 consecutive
events is of the order of 5 us. This corresponds to a 0.05% loading
for a process in which a chain of <I>immediate</I> actions is
triggered by a 100 ms timer, of which 0.005% is actually used by the
<I>immediate</I> statements. This is minimal loading of the
processor. Even while debugging with a live display, the loading is
only about 10% for a process executing 15 events every 100 ms. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__7491_1995752089"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.11<I>  S</I>imple
Example </FONT></FONT>
</H2>
<P CLASS="western">The following very simple program has 4 external
bit inputs and 4 external bit outputs linked together, so that a
vessel will always be filled with hot water when it is switched on.
Once water is drained from the vessel it will immediately fill with
cold water and then heat it to the pre-set temperature, which is
indicated by a ready light. (A lot of aliases are used to make
debugging easier)</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi">/*
WATER HEATER PROGRAM */	<BR><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> on      = IX0.0;	//
switch to turn system on/off<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> waterLo = IX0.1;	//
water level, turns off when full<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> tempLo  = IX0.2;	//
thermostat, turns off when hot<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> drain   = IX0.3;	//
causes the vessel to drain<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> fill = on &amp;
waterLo;	// fill with water until full<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> heat = on &amp;
</FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">~</SPAN></FONT><FONT FACE="Courier, monospace">waterLo
&amp; tempLo;	// heat when full until hot<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> ready = on &amp;
~tempLo;	// hot water ready light<BR>QX0.0 = fill;	QX0.1 =
heat;<BR>QX0.2 = ready;	QX0.3 = drain;</FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23149_1582432481"></A><A NAME="DDE_LINK1"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.12<I> 
</I>Intrinsic limitations of <I>immediate</I> statements </FONT></FONT>
</H2>
<P CLASS="western">Arrays of <I>immediate</I> variables have been
realized and will be covered in the next chapter. Structures
containing <I>immediate</I> variables have not been realized in the
current release, although they are possible and may be implemented in
a future release. Pointers to <I>immediate</I> variables in <I>immediate</I>
expressions are semantically indeterminate. They are therefore not
implemented. This is also pointed out in one of the recommendations
in the IEC-1131 standard, which justifies the language <I>Structured
Text</I> instead of <I>C</I> on the grounds, that a pointer in a
machine control program has no meaning and could cause disaster. The
same limitation has been recognized in the language <I>Java</I>,
which only recognizes references as constant pointers.</P>
<P CLASS="western"><I>Immediate</I> assignments, in which the left
hand side variable appears in the right hand side expression are of
very doubtful utility. Such a statement expresses a very tight
feedback loop, which will either lock up, or generate a high speed
oscillator. For this reason a warning message is generated by the <I>iC</I>
compiler. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> a, b;<BR>a = a &amp;
b;		// a locks up when b becomes 0<BR>b = </FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">b
| a;		// b oscillates when a is 0<BR></FONT><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> j;<BR>j = j + 1;		// j
never catches up with itself </FONT></FONT>
</P>
<P CLASS="western">For the above reason the <I>C</I> assignment
operators <FONT FACE="Courier, monospace"><B>+=</B></FONT>, <FONT FACE="Courier, monospace"><B>-=</B></FONT>
etc. as well as <FONT FACE="Courier, monospace"><B>++</B></FONT> and
<FONT FACE="Courier, monospace"><B>--</B></FONT> cannot be used in
<I>immediate</I> statements. Feedback over several statements is
allowed, but oscillations are controlled so that the system does not
become compute bound. If oscillations do occur, a runtime warning is
produced since they are probably not intended.</P>
<P CLASS="western"><SPAN LANG="en-GB">Like in any programming
language, it is possible to write incorrect </SPAN><SPAN LANG="en-GB"><I>iC
</I></SPAN><SPAN LANG="en-GB">programs. It is the job of the
programmer, to understand the model on which the execution of the </SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB">
language constructs is based, and to create programs that use these
constructs correctly. </SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB">
is modelled on hardware building blocks, which provides an easy
starting point in understanding the model. See <A HREF="#8.    The iC run-time model|outline">section
8</A>.</SPAN></P>
<P CLASS="western">The following was probably intended by the last
statement above: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> gate, p;<BR></FONT><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> j;		// j counts every
rising edge<BR></FONT><FONT FACE="Courier, monospace"><B>if</B></FONT><FONT FACE="Courier, monospace">
(gate &amp; p) </FONT><FONT FACE="Courier, monospace"><B>{</B></FONT><FONT FACE="Courier, monospace">
j++; </FONT><FONT FACE="Courier, monospace"><B>}</B></FONT><FONT FACE="Courier, monospace">		//
of p, while gate is hi </FONT></FONT>
</P>
<P CLASS="western"><A NAME="DDE_LINK2"></A><SPAN LANG="en-GB">In this
example, </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB">gate
&amp; p</SPAN></FONT><SPAN LANG="en-GB"> is an </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
expression that triggers execution of the </SPAN><SPAN LANG="en-GB"><I>non-</I></SPAN><SPAN LANG="en-GB"><I>immediate
C</I></SPAN><SPAN LANG="en-GB"> statement </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB">j++;</SPAN></FONT><SPAN LANG="en-GB">
Assignment operators </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>+=</B></SPAN></FONT><SPAN LANG="en-GB">,
</SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>-= </B></SPAN></FONT><SPAN LANG="en-GB">etc.
as well as </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>++</B></SPAN></FONT><SPAN LANG="en-GB">
and </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>--</B></SPAN></FONT><SPAN LANG="en-GB">
with </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
variables are allowed in embedded </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">
statements. The above construct is one way to implement a counter in
</SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB">. A
better way is shown in <A HREF="#3.9.  Sample and Hold|outline">section
4.9</A>. </SPAN>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23151_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>2.13  Pragmas</FONT></FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Pragmas affect the compilation phase of an <I>iC</I> program. Pragmas
are introduced by the keywords <FONT FACE="Courier, monospace"><FONT SIZE=2><B>use
</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">and
</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><B>no</B></FONT>.
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>use	</B></FONT>turns a pragma
option on	<BR><FONT FACE="Courier, monospace"><B>no	</B></FONT>turns
it off</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Currently two pragmas are implemented in <I>immediate C</I>: <FONT FACE="Courier, monospace"><B>alias</B></FONT>
and <FONT FACE="Courier, monospace"><B>strict</B></FONT>.</P>
<P ALIGN=LEFT STYLE="margin-left: 1.25cm; page-break-inside: avoid"><A NAME="DDE_LINK4"></A>
<FONT FACE="Courier, monospace"><B>use alias</B>;	// equivalent to -A
command line option<BR><FONT FACE="Courier, monospace"><B>no
alias</B></FONT><FONT FACE="Courier, monospace">;		// turn alias
option off</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 1.25cm; page-break-inside: avoid"><A NAME="DDE_LINK6"></A>
<FONT FACE="Courier, monospace"><B>use strict</B>;	// equivalent to
-S command line option<BR><FONT FACE="Courier, monospace"><B>no
strict</B></FONT><FONT FACE="Courier, monospace">;	// turn strict
option off</FONT></FONT></P>
<OL>
	<LI><P CLASS="western"><A NAME="DDE_LINK5"></A>The <FONT FACE="Courier, monospace"><B>alias</B></FONT>
	pragma or -A command line option forces the compiler to generate a
	node for each alias in the generated <I>C </I>code (default is to
	generate no node). This is needed in two circumstances:</P>
</OL>
<UL>
	<LI><P CLASS="western">It is required, if an <I>iC</I> source refers
	to an alias in another <I>iC</I> source by an <FONT FACE="Courier, monospace"><B>extern</B></FONT>
	reference. Since all references to aliases are normally removed from
	the compiled code, the <I>C </I>object modules, which are generated
	from such code could not be linked. With the <FONT FACE="Courier, monospace"><B>use
	alias</B></FONT> option, the code can be linked and the remaining
	aliases are resolved at start up.</P>
	<LI><P CLASS="western">The <FONT FACE="Courier, monospace"><B>use
	alias</B></FONT> option is also useful for debugging. Only when it
	is set, are alias names displayed as active words by <I><B>iClive</B></I>.
		</P>
</UL>
<OL START=2>
	<LI><P CLASS="western"><A NAME="DDE_LINK8"></A><A NAME="DDE_LINK9"></A>
	The <FONT FACE="Courier, monospace"><B>strict</B></FONT> pragma or
	-S command line option<SPAN STYLE="font-weight: normal"> forces the
	compiler to expect a declaration of all </SPAN><I><SPAN STYLE="font-weight: normal">immediate</SPAN></I><SPAN STYLE="font-weight: normal">
	variables, before </SPAN><SPAN STYLE="font-weight: normal">it is
	used in an expression or assigned</SPAN><SPAN STYLE="font-weight: normal">.
	The default with </SPAN><FONT FACE="Courier, monospace"><B>no
	strict</B></FONT><SPAN STYLE="font-weight: normal">, is to generate
	an </SPAN><FONT FACE="Courier, monospace"><B>imm bit</B></FONT><SPAN STYLE="font-weight: normal">
	</SPAN><SPAN STYLE="font-weight: normal">v</SPAN><SPAN STYLE="font-weight: normal">ariable</SPAN><SPAN STYLE="font-weight: normal">
	for </SPAN><SPAN STYLE="font-weight: normal">any</SPAN><SPAN STYLE="font-weight: normal">
	undeclared </SPAN><SPAN STYLE="font-weight: normal">new</SPAN><SPAN STYLE="font-weight: normal">
	name.</SPAN> Similarly an assignment to an undeclared name from a
	CLOCK() or TIMER() function call results in a default <FONT FACE="Courier, monospace"><B>imm
	clock</B></FONT> or <FONT FACE="Courier, monospace"><B>imm timer</B></FONT>
	variable. Such laxness is OK for small single source projects, but
	can lead to problems with larger projects. I had a case in a large
	project, where I had declared a number of <FONT FACE="Courier, monospace"><B>imm
	int</B></FONT> variables and mistyped one of them, so the correct
	name was not declared. This name was then assigned - but converted
	to <FONT FACE="Courier, monospace"><B>imm bit</B></FONT> and then
	back to <FONT FACE="Courier, monospace"><B>imm int</B></FONT> when
	used, leading to incorrect arithmetic.</P>
</OL>
<P CLASS="western">As noted earlier, <I>C</I> functions and macros
should be declared extern with their correct parameter ramp and
return value. When “strict” is active, error messages are output
if an undeclared <I>C</I> function or macro is called in an <I>immediate
C</I> expression.</P>
<P CLASS="western">Several options (currently only two) may be set or
reset together in one pragma call:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><A NAME="DDE_LINK7"></A>
<FONT FACE="Courier, monospace"><B>use alias strict</B>;	//
equivalent to -AS command line option<BR><B>no strict alias</B>;	//
turn both options off</FONT></P>
<P CLASS="western">It is recommended to write 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><A NAME="DDE_LINK71"></A>
<FONT FACE="Courier, monospace"><B>use alias strict</B>;</FONT></P>
<P CLASS="western">as the first line of all production <I>iC</I>
programs - the space overhead for extra alias nodes is insignificant
and debugging becomes much easier. Particularly the <FONT FACE="Courier, monospace"><B>strict</B></FONT>
option is highly recommended anyway and results in no binary
overhead. (Grateful acknowledgements to the designers of PERL).</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The scope of these pragmas is a file. If a pragma is enabled in one
file it carries over to an included <I>iC</I> header file. If on the
other hand a pragma is changed in a header file, it reverts to its
previous value in the <I>iC</I> file after the #include statement,
which includes the header file. This makes sure that sloppy <I>iC</I>
programs, which include a header file, which uses “<FONT FACE="Courier, monospace"><B>strict</B></FONT>”
syntax, will not report errors, because they do not follow the
“<FONT FACE="Courier, monospace"><B>strict</B></FONT>” syntax.
This scope feature can only be used successfully with the <FONT FACE="Courier, monospace"><B>use
strict</B></FONT> pragma, since <FONT FACE="Courier, monospace"><B>use
alias</B></FONT> only comes into effect during <I>C</I> code
generation – at this point the complete source has been parsed.
This means <FONT FACE="Courier, monospace"><B>use alias</B></FONT>
should definitely be used once in <I>iC</I> programs, which consists
of several parts with extern references between them. Other single
source <I>iC</I> programs can <FONT FACE="Courier, monospace"><B>use
alias</B></FONT>, which produces slightly larger code, but which can
be debugged without recompiling with the -A flag. 
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23153_1582432481"></A><A NAME="3.    Arrays|outline"></A>
<FONT SIZE=4>3    Arrays</FONT></H1>
<P CLASS="western">Arrays in conventional instruction flow languages
are a named collection (often of fixed length) of similar variables,
which are accessed by an index expression, eg a[5]. Each such entity
is an individual object, but in instruction flow languages the index
is often a variable, which is manipulated in a loop and references to
the individual indexed entities occur sequentially, as in the
following <I>C</I> example:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>for
(n = 0; n &lt; 4; n++) {<BR>	a[n] = b[n] * c[n];<BR>}</B></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23155_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>3.1<I> 
Immediate</I> Arrays </FONT></FONT>
</H2>
<P CLASS="western">In data flow languages like <I>immediate C</I>
loops at run-time are meaningless. Each <I>immediate</I> variable is
an entity, which is controlled by one assignment statement. The
variable changes, when a variable in the expression of the
controlling statement changes and not when some loop runs. It is well
to remember, that <I>immediate</I> variables and their controlling
expressions are more like IC building blocks connected in a static
network. In that sense <I>immediate</I> Arrays are like hardware
registers containing a number of hardware objects, which act out
their individual function inside the IC register.</P>
<P CLASS="western">Arrays may be defined in <I>immediate C</I>, but
each entity acts individually at run-time, which means that an
individual <I>immediate</I> object must be generated for each
<I>immediate</I> array member.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23157_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>3.2  Use of
immediate Arrays</FONT></FONT></H2>
<P CLASS="western">Arrays in conventional languages as well as in
<I>immediate C</I> give programmers extra capabilities to express
themselves. These fall into two distinct categories:</P>
<OL>
	<LI><P CLASS="western">Arrays allow the writing of repeated similar
	statements as one statement – this saves a lot of writing, but
	could also be done without arrays.</P>
	<LI><P CLASS="western">Additionally arrays allow the parametrisation
	of the array length, both within the program source and in the
	command line of the compiler, which is probably more important. For
	<I>immediate C</I>, this makes possible the writing of control
	programs in which the number of control elements or groups is
	variable and the actual number is not bound until compile time. This
	would not be possible without arrays in the language. 
	</P>
	<LI><P CLASS="western"><SPAN LANG="en-GB">Arrays are also useful to
	select another  variable in one indexing operation. If the index is
	itself a variable, this sort of operation can only be done in
	embedded </SPAN><SPAN LANG="en-GB"><I>C</I></SPAN><SPAN LANG="en-GB">
	code in </SPAN><SPAN LANG="en-GB"><I>immediate C</I></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	using </SPAN></SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></SPAN></FONT><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	variables whose changes can act back in normal </SPAN></SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	code. To allow this sort of fast access, </SPAN></SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></SPAN></FONT><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	Arrays have been implemented in </SPAN></SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	– they are discussed at the end of this chapter in <A HREF="#3.6.  immC Arrays|outline">section
	3.6</A>. Note: </SPAN></SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></SPAN></FONT><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	arrays are not part of the extended </SPAN></SPAN><SPAN LANG="en-GB"><I>iCa</I></SPAN><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal">
	language.</SPAN></SPAN></P>
	<P CLASS="western">The definition of dynamic arrays, whose sizes
	change at run-time is meaningless for a data flow language and is
	not possible in <I>immediate C</I>.</P>
</OL>
<P CLASS="western">An example of the usefulness of arrays in the
language would be an <I>iC</I> program controlling lifts in a
building. The number of floors varies from building to building –
so do the number of parallel lifts, which may be required. With
arrays, a single <I>iC</I> program can be written, which can be
compiled for a different number of floors and a different number of
parallel lifts as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>immac
-P FLOORS=12 -P LIFTS=2 liftControl.ica</B></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23159_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>3.3 
Implementation of immediate Arrays</FONT></FONT></H2>
<P CLASS="western">Since each immediate array member is an individual
immediate object at run time, it is important for debugging with
<I><B>iClive</B></I> to be able to have a listing showing each
individual array member – not just its collective form, eg a[N]. To
achieve this, an <I>iC</I> program containing arrays is translated by
the pre-processor <I><B>immac</B></I> to <I>iC</I> code without
arrays. This is a simple text operation in which macros are expanded,
loops are unrolled and index expressions are evaluated.</P>
<P CLASS="western">The <I>iC</I> language with arrays has four
additional language extensions:</P>
<OL>
	<LI><P CLASS="western"><I>C or Perl</I>-style '<FONT FACE="Courier, monospace"><B>FOR
	</B></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">loops</SPAN></FONT>',
	which define a loop variable and a range.</P>
	<LI><P CLASS="western"><I>C or Perl</I>-style '<FONT FACE="Courier, monospace"><B>IF</B></FONT>',
	'<FONT FACE="Courier, monospace"><B>ELSE IF</B></FONT>' and <FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE</B></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">'</SPAN></FONT>
	statements <FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSIF</B></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">'</SPAN></FONT>
	is a synonym for <FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE
	IF</B></FONT>')</P>
	<LI><P CLASS="western">Index expressions in square brackets, which
	allow the definition of array variables – usually in a loop.</P>
	<LI><P CLASS="western">Macro definitions, which are processed
	directly by <I><B>immac</B></I> - can be defined in two ways:</P>
</OL>
<UL>
	<LI><P CLASS="western">in <I>C</I>-pre-processor style with <FONT FACE="Courier, monospace"><B>%define</B></FONT>
	instead of <FONT FACE="Courier, monospace"><B>#define</B></FONT>,
	eg	<BR><FONT FACE="Courier, monospace"><B>%define FLOORS 12</B></FONT></P>
	<LI><P CLASS="western">in the command line, just like for a <I>C</I>
	compiler, eg	<BR><FONT FACE="Courier, monospace"><B>-P FLOORS=12</B></FONT></P>
	<P CLASS="western">Macros will mostly be used inside the square
	brackets of an array variable or in the control line of a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	loop', but they can be used anywhere in the <I>iC</I> code or in the
	definition of another <FONT FACE="Courier, monospace"><B>%define</B></FONT>
	macro – macros may be nested. The above implies, that the <I><B>immac</B></I>
	pre-compiler could be used as a macro pre-processor for <I>iC</I>
	programs without any arrays at all. 
	</P>
	<P CLASS="western">Note: <FONT FACE="Courier, monospace"><B>immC</B></FONT>
	Arrays are part of <I>iC</I> and are not handled by  the <I><B>immac</B></I>
	pre-compiler.</P>
	<P CLASS="western"><I>iC</I> programs containing the above four
	extensions are called <I>iCa</I> programs and should be written in a
	file with the extension .ica – the <I><B>immac</B></I>
	pre-compiler translates an <I>iCa</I> program to an <I>iC</I>
	program with the extension .ic in which macros and '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	loops' are expanded and <I>immediate</I> array instances are
	converted to simple <I>immediate</I> variables. The following <I>iCa</I>
	snippet in file lift.ica</P>
</UL>
<P ALIGN=LEFT STYLE="margin-left: 0.97cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>%define</B>
FLOORS 4</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.97cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>FOR
</B>(<B>N</B> = 0; <B>N</B> &lt; FLOORS; <B>N</B>++) <B>{{</B><BR>	imm
bit liftTo[<B>N</B>] = up[<B>N</B>] | down[<B>N</B>];<BR><B>}}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">expands to the
following <I>iC</I> file lift.ic when compiled by <I><B>immac</B></I>:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.01cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace">	imm bit liftTo0 = up0 | down0;<BR>	imm
bit liftTo1 = up1 | down1;<BR>	imm bit liftTo2 = up2 | down2;<BR>	imm
bit liftTo3 = up3 | down3;</FONT></P>
<P CLASS="western" STYLE="font-style: normal">The '<FONT FACE="Courier New, monospace"><B>FOR</B></FONT>
loop' is executed at compile time and generates repeated copies of
the statement(s) in the compound statement controlled by the loop.
This only makes sense, if there are elements in the loop
statement(s), which are modified by index operations using the
control variable of the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
statement' – in the above example that is the variable <FONT FACE="Courier, monospace"><B>N</B></FONT>.
</P>
<P CLASS="western" STYLE="font-style: normal">The translation of
indices in square brackets is carried out in two steps:</P>
<OL>
	<LI><P CLASS="western" STYLE="font-style: normal">The expression in
	square brackets is evaluated as an integer expression.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The numerical
	value produced replaces the square brackets and the expression it
	contains.</P>
</OL>
<P CLASS="western" STYLE="font-style: normal">In the above example
the index expressions are simply the variable <FONT FACE="Courier, monospace"><B>N</B></FONT>.
But the index expressions can be more complex. A feature of <I>iCa</I>
indexing may seem strange at first, but it turns out to be very
useful; the square bracketed index expression may be placed anywhere
in a word, not only at the end of a word. It may even be placed on
its own – in that case the expression is evaluated and becomes a
suitably modified integer constant in an <I>iC</I> statement. The
following example shows both:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>FOR</B>
(<B>N</B> = 0; <B>N</B> &lt; 7; <B>N</B>++) <B>{{</B><BR>	QB[<B>N</B>]
= IB[<B>N</B>+1] * [<B>N</B>+2];<BR>	QX[<B>N</B>/8].[<B>N</B>%8] =
IX[<B>N</B>/8].[<B>N</B>%8] &amp; <SPAN STYLE="font-style: normal">IX[10+(</SPAN><SPAN STYLE="font-style: normal"><B>N</B></SPAN><SPAN STYLE="font-style: normal">/8)]</SPAN>.[<B>N</B>%8];	//
out: [<B>N</B>]<BR><B>}}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">expands to :</P>
<P ALIGN=LEFT STYLE="margin-left: 1.02cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace">	QB0 = IB1 * 2;<BR>	QX0.0 = IX0.0 &amp;
IX10.0;	// out: 0<BR>	QB1 = IB2 * 3;<BR>	QX0.1 = IX0.1 &amp;
IX10.1;	// out: 1<BR>	QB2 = IB3 * 4;<BR>	QX0.2 = IX0.2 &amp;
IX10.2;	// out: 2<BR>	QB3 = IB4 * 5;<BR>	QX0.3 = IX0.3 &amp;
IX10.3;	// out: 3<BR>	QB4 = IB5 * 6;<BR>	QX0.4 = IX0.4 &amp;
IX10.4;	// out: 4<BR>	QB5 = IB6 * 7;<BR>	QX0.5 = IX0.5 &amp;
IX10.5;	// out: 5<BR>	QB6 = IB7 * 8;<BR>	QX0.6 = IX0.6 &amp;
IX10.6;	// out: 6</FONT></P>
<P CLASS="western">As shown above, index expressions may even be used
in comments. This can be useful, because the expanded <I>iC</I> text
must later be used for debugging with <I><B>iClive</B></I> – the
original text with <SPAN STYLE="font-style: normal">'</SPAN><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>FOR</B></SPAN></FONT><SPAN STYLE="font-style: normal">
loops'</SPAN> and index expressions is not meaningful for following
the values of actual nodes at run-time. The above example already
gives a hint of how much writing can be saved. The way I/O bit
variables following the IEC-1131 standard are expanded is
particularly useful.</P>
<P CLASS="western"><A NAME="arrays"></A>The <I>iCa</I> extensions to
the <I>iC</I> language can be embedded as additional lines in regular
<I>iC</I> code. A %define macro definition may <B>not</B> be embedded
in the middle of a line of <I>iC</I> code – not even between <I>iC</I>
statements, which have been written in one line. This limitation is
similar to the limitations imposed by the <I>C</I> pre-processor <B>cpp</B>
on the <I>C</I> language.</P>
<H3 CLASS="western"><A NAME="__RefHeading__23161_1582432481"></A>3.3.1
 FOR loops</H3>
<P CLASS="western" STYLE="font-style: normal"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loops' follow the syntax of <I>C</I> '<FONT FACE="Courier, monospace"><B>for</B></FONT>
statements' with the difference, that the word <FONT FACE="Courier New, monospace"><B>FOR</B></FONT>
is upper case (to avoid clashes with '<FONT FACE="Courier, monospace"><B>for</B></FONT>
statements' in embedded <I>C</I> code) and the controlled <I>iC</I>
code <B>must</B> be enclosed in twin braces (single braces are
required for <I>immediate</I> <B>switch</B> and <B>if else</B>
statements as well as function block bodies):</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR
(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">expr1;
expr2; expr3</SPAN></FONT><FONT FACE="Courier, monospace"><B>) {{<BR>	</B></FONT><FONT FACE="Courier, monospace"><I><B>iC
code, which is repeated under control of the loop<BR>	or nested 'FOR
loops'</B></I></FONT><FONT FACE="Courier, monospace"><B><BR>}}</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">The only restrictions
are:</P>
<OL>
	<LI><P CLASS="western" STYLE="font-style: normal">Each '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	statement' must define one (and only one) control variable, which is
	an <FONT FACE="Courier, monospace"><B>int</B></FONT> by default:</P>
	<OL>
		<P ALIGN=LEFT STYLE="font-style: normal; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR
		(</B></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
		= 0; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
		&lt; 10; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
		or FOR (int </B></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
		= 0; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
		&lt; 10; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)</B></FONT></FONT></P>
	</OL>
	<P CLASS="western" STYLE="font-style: normal">The control variable
	is the first 'word' of expr1, which is not '<FONT FACE="Courier, monospace"><B>int</B></FONT>'
	i.e. <FONT FACE="Courier New, monospace"><B>N</B></FONT> in the
	example. The word '<FONT FACE="Courier, monospace"><B>int</B></FONT>'
	in the second form is optional and can be written to remind
	programmers, that the control variable is an integer. The control
	variable cannot be declared anywhere else.</P>
	<LI><P CLASS="western" STYLE="font-style: normal">Other atoms in the
	three expressions must be either constant expressions or expressions
	which contain control variables of the current and/or outer '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	loops'. All expressions may contain macros, which must expand to
	integer constants, strings or expressions containing valid '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>'
	loop control variables. Under no circumstances may <I>immediate</I>
	variables be used in these expressions.</P>
	<LI><P CLASS="western">The names of control variables must be
	different from any <I>immediate</I> variable. It is highly
	recommended, that upper case names be used for '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	loop' control variables. This and the upper case keyword '<FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>FOR</B></SPAN></FONT>'
	and the twin braces <FONT FACE="Courier New, monospace"><B>{{ }}</B></FONT>
	make these code generating  statements in the <I>iCa</I> language
	stand out from normal <I>iC</I> and <I>C</I> code. 
	</P>
	<LI><P CLASS="western" STYLE="font-style: normal">The scope of the
	control variable of a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	loop' begins when the control variable is initialised in the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	statement' and ends with the final matching twin braces. The control
	variable is not valid outside of this scope.  '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
	loop' control variables will never appear in the generated <I>iC</I>
	files (except as comments if the immac -a option is used).</P>
</OL>
<P CLASS="western" STYLE="font-style: normal">Since <I><B>immac</B></I>
is implemented as a Perl script, an alternate Perl type of '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' using a list in various forms may be used.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR </B></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><B>(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">&lt;Perl
type list&gt;</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{{<BR></B></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><I><B>	iC
code, which is repeated under control of the loop<BR>	or nested 'FOR
loops'<BR></B></I></FONT></FONT><FONT FACE="Courier, monospace"><B>}}</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Similar restrictions to
those above apply. The variable after the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>'
is the loop control variable. It may optionally be preceded by the
word '<FONT FACE="Courier, monospace"><B>int</B></FONT>'. The control
variable is given each value of the 'Perl type list' for each
iteration of the loop. Some powerful manipulations are possible with
this form. Although a perlish syntax is used in the second form of
the <FONT FACE="Courier, monospace"><B>FOR</B></FONT> control
statement, any variables in either form follow the <I>C</I> syntax
for scalar variables – they are never preceded by a $ as in Perl. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>FOR </B><SPAN STYLE="font-weight: normal">int
</SPAN><B>N</B><SPAN STYLE="font-weight: normal"> (0 .. 3) </SPAN><B>{{
</B><SPAN STYLE="font-weight: normal">a[</SPAN><B>N</B><SPAN STYLE="font-weight: normal">],
</SPAN><B>}}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">internally generates
the following Perl code (see optional .log file)</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">$out
= “”; for my </SPAN><B>$N</B><SPAN STYLE="font-weight: normal">
(0 .. 3) {$out .= “ a</SPAN><B>@{[$N]}</B><SPAN STYLE="font-weight: normal">,”;}
print $out;</SPAN></FONT></P>
<P CLASS="western" STYLE="font-style: normal">which is executed as an
eval to produce the following output:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>	a0, a1, a2, a3,</FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">iC code embedded in
twin braces is repeated without a LF, if the final braces are on the
same line as the iC code. The same can be achieved by terminating an
iC code line with a back slash '\', which works as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>FOR
</B><SPAN STYLE="font-weight: normal">int </SPAN><B>N </B><SPAN STYLE="font-weight: normal">(0
.. 3) </SPAN><B>{{<BR>	</B><SPAN STYLE="font-weight: normal">a[</SPAN><B>N</B><SPAN STYLE="font-weight: normal">],</SPAN><B>\<BR>}}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">produces the same as
above.</P>
<P CLASS="western" STYLE="font-style: normal">Lists in the second
form of the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT> loop'
may be made up of decimal numbers or strings. Strings may be embedded
in parentheses although lists of bare words will also be interpreted
as strings.</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
int </SPAN><B>FOR N</B> <B>(</B><SPAN STYLE="font-weight: normal">&quot;in&quot;,
&quot;out&quot;, &quot;tmp&quot;</SPAN><B>)</B> <B>{{</B><SPAN STYLE="font-weight: normal">
fast_</SPAN>[<B>N</B>],<B> }}</B><SPAN STYLE="font-weight: normal">;</SPAN></FONT></P>
<P CLASS="western" STYLE="font-style: normal">produces 
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">imm
int fast_in</SPAN>, <SPAN STYLE="font-weight: normal">fast_out</SPAN>,
<SPAN STYLE="font-weight: normal">fast_tmp</SPAN>,;</FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">The above <I>iC</I>
declaration would have produced a syntax error until recently. The iC
language has been extended to allow such comma separated lists to
have a final comma before the semi-colon to end the statement. This
is in line with other comma separated parameter lists, which may also
have an extra comma at the end.</P>
<P CLASS="western" STYLE="font-style: normal">Again the same can be
achieved with backslashes. The following (with barewords in the list)
produces the same output as above, although this <I>iCa</I> snippet
is not nearly as readable:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">imm
int</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>\</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal"><BR></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>FOR
N</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
(in, out, tmp) </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>{{<BR></B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
fast_[</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>N</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">],</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>\</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal"><BR></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>}}\<BR></B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">;</SPAN></FONT></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">As shown above, lines
terminated by a back-slash (\) are output without starting a new line
– this make it possible to generate lists in a single line. This
applies both inside a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' and directly before and after a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop'. The end of the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' would normally terminate such a generated list, unless the
final brace of the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' is also followed by a back-slash (\) as shown in the generated
function block call statement in the last example above. 
</P>
<P CLASS="western" STYLE="font-style: normal">For those who don't
like to see a comma followed by a semicolon '<B>,</B><FONT FACE="Courier, monospace"><FONT SIZE=2><B>;</B></FONT></FONT>'
at the end of a declaration, a special characteristic of <I>iCa</I>
index expressions can be used (see next paragraph). The value in
square brackets may be strings as well as numbers, since they are
actually generated by Perl code. To generate a variable length –
single line – declaration, use the following:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
bit FOR N (</B><SPAN STYLE="font-weight: normal">0 .. 5</SPAN><B>)</B>
<B>{{ </B>a[<B>N</B>][<B>N</B> &lt; 5 <B>?</B> <SPAN STYLE="font-weight: normal">&quot;,&quot;
</SPAN><B>:</B><SPAN STYLE="font-weight: normal"> &quot;;&quot;</SPAN>]<B>
}}</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">produces 
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm bit </B><SPAN STYLE="font-weight: normal">a0,
a1, a2, a3, a4, a5</SPAN>;</FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Each execution of the
second conditional index expression <FONT FACE="Courier, monospace">[</FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace">
&lt; 5 </FONT><FONT FACE="Courier, monospace"><B>?</B></FONT><FONT FACE="Courier, monospace">
&quot;,&quot; </FONT><FONT FACE="Courier, monospace"><B>:</B></FONT><FONT FACE="Courier, monospace">
&quot;;&quot;]</FONT> in the loop produces a single comma, which is
appended – the last execution of the index expression produces a
semi colon.</P>
<P CLASS="western" STYLE="font-style: normal">The '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
statements' for both types of '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' and the the associated twin braces are not copied to the target
except as comment lines, if the <B>-a</B> option is active for the
<I><B>immac</B></I> compiler.</P>
<H3 CLASS="western"><A NAME="__RefHeading__23163_1582432481"></A>3.3.2
   IF ELSE control statements</H3>
<P CLASS="western" STYLE="font-style: normal">Sometimes it is
necessary to suppress the output of code lines in a <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' or to supply one or more alternative output lines depending on
some condition of the existing loop variables. This can be achieved
with an <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>IF</B></FONT>'
or <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>IF
ELSE</B></FONT>' control statement. The syntax and semantics is
identical to  <I>C</I> '<FONT FACE="Courier, monospace"><B>if'</B></FONT>
or <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>if
else</B></FONT>' statements – except that again the <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>IF</B></FONT>'
and <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE</B></FONT>'
keywords are upper-case not lower-case. Even one or more <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE
IF</B></FONT>' statements may follow an initial <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>IF</B></FONT>'
statement followed  by a final (optional)<FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE</B></FONT>'
statement. (<FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE
IF</B></FONT>' may be written as <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSIF</B></FONT>'
– it is translated to this form anyway to execute as Perl code).
The <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>IF</B></FONT>'
conditional expression in parentheses may only contain existing <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' control variables and constants. No new control variable can be
defined. Again <I>immediate</I> variables may not be used in these
expressions.The <I>iC</I> or <I>C</I> code controlled by an <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>IF</B></FONT>',
<FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE
IF</B></FONT>'  or <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>ELSE</B></FONT>'
statement must be contained in twin braces (like the <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' ). The following produces the same as example above:</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit FOR N (</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">0..5</SPAN></FONT><FONT FACE="Courier, monospace"><B>)</B></FONT><FONT FACE="Courier, monospace">
</FONT><FONT FACE="Courier, monospace"><B>{{ IF (N </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">&lt;
5</SPAN></FONT><FONT FACE="Courier, monospace"><B>){{ </B></FONT><FONT FACE="Courier, monospace">a[</FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace">],
</FONT><FONT FACE="Courier, monospace"><B>}} ELSE {{</B></FONT><FONT FACE="Courier, monospace">
a[</FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace">];
</FONT><FONT FACE="Courier, monospace"><B>}} }}</B></FONT></FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__7395_1090881298"></A>3.3.3
   Index expressions</H3>
<P CLASS="western">Index expressions are expressions in square
brackets usually involving loop control variables and integer
constants. Unlike in other computer languages these 'index'
expressions can be placed anywhere in the <I>iC</I> code – not just
as an index of an array variable. <I>immediate</I> array variables
cannot even be declared directly – they come into existence as
simple immediate variables by evaluating the index expression and
replacing the square brackets by the numeric or string result of that
evaluation. The underlying simple <I>immediate</I> variables must of
course be declared (unless <FONT FACE="Courier, monospace">not strict
</FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>(which
you wouldn't, would you)</FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>).
</FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Such
a group declaration</FONT></FONT> is best done as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR (</B></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
= 0; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
&lt; 10; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{{<BR>	imm bit </B></FONT><FONT FACE="Courier, monospace">a[</FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace">]</FONT><FONT FACE="Courier, monospace"><B>;<BR>}}</B></FONT></FONT></P>
<P CLASS="western">Normally the square brackets are placed after a
name, which then makes the array variables look like those in <I>C</I>.
But there are special cases where the square bracketed index
expression is placed somewhere else, as we saw in the earlier
examples (computing IEC-1131 I/O variable names).</P>
<P CLASS="western">The semantics of index expressions is, that the
expression in square brackets is evaluated during the execution of
the <I><B>immac</B></I> compiler (written in Perl) as a Perl eval.
The numerical or string result of the eval replaces the square
brackets and the expression they enclose. When the index expression
is a simple array reference, this produces a name followed by a
number. The fact that evaluation of the index expressions is done by
Perl means, that the expression syntax and semantics of Perl integer
arithmetic apply, since <FONT FACE="Courier New, monospace"><B>use
int</B></FONT> is declared in the  <I><B>immac</B></I> compiler.
Since most arithmetic operators are the same for Perl and C, this is
not of great consequence. One notable exception is the Perl
exponentiation operator <FONT FACE="Courier, monospace"><B>**</B></FONT>,
which may be used in <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>FOR</B></SPAN></FONT>
loops and index expressions with good effect:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR (</B></FONT><FONT FACE="Courier, monospace"><B>J</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
= 0; </SPAN></FONT><FONT FACE="Courier, monospace"><B>2**J</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
&lt; 16; </SPAN></FONT><FONT FACE="Courier, monospace"><B>J</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{{<BR>	imm int mask</B></FONT><FONT FACE="Courier, monospace">[</FONT><FONT FACE="Courier, monospace"><B>J</B></FONT><FONT FACE="Courier, monospace">]
= [</FONT><FONT FACE="Courier, monospace"><B>2**J</B></FONT><FONT FACE="Courier, monospace">]</FONT><FONT FACE="Courier, monospace"><B>;<BR>}}</B></FONT></FONT></P>
<P CLASS="western">produces</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>	imm
int mask</B></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>0</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>
= </B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>1</B></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><B>;<BR>	imm
int mask</B></FONT><FONT FACE="Courier, monospace"><B>1</B></FONT><FONT FACE="Courier, monospace"><B>
= 2;<BR>	imm int mask</B></FONT><FONT FACE="Courier, monospace"><B>2</B></FONT><FONT FACE="Courier, monospace"><B>
= 4;<BR>	imm int mask</B></FONT><FONT FACE="Courier, monospace"><B>3</B></FONT><FONT FACE="Courier, monospace"><B>
= 8;</B></FONT></FONT></P>
<P CLASS="western">Any <I>iC</I> or <I>C</I> code may have strings
which contain the backslashed characters '\n' or '\t', which stand
for a Newline or a Horizontal tab both in <I>C</I> or in Perl and
also in <I>iC</I>. These special characters do not actually execute
as a Newline or a Tab until the final machine code executes. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>FOR (</B></FONT><FONT FACE="Courier, monospace"><B>I</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
= 0; </SPAN></FONT><FONT FACE="Courier, monospace"><B>I</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
&lt; 4; </SPAN></FONT><FONT FACE="Courier, monospace"><B>I</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{{<BR>	printf(“Hello world\t%d\n”, [I]);<BR>}}</B></FONT></FONT></P>
<P CLASS="western">produces</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>	printf(“Hello world\t%d\n”,
0);<BR>	printf(“Hello world\t%d\n”, 1);<BR>	printf(“Hello
world\t%d\n”, 2);<BR>	printf(“Hello world\t%d\n”, 3);</B></FONT></P>
<P CLASS="western">Not brilliant code but notice that '\t' and '\n'
are correctly preserved in the generated <I>iC</I> code strings. 
</P>
<P CLASS="western">An exception to this rule are '\n' and '\t'
characters contained in string expressions of an <I>iCa</I> index
expression in square brackets. These '\n' and '\t' characters are
converted to a Newline or Tab directly in the conversion from <I>iCa</I>
to <I>iC</I> code. This allows the embedding of real Newlines or Tabs
in lists of <I>iC</I> code generated by a <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>FOR</B></SPAN></FONT>
loop.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>	imm
int trans = \<BR>FOR (</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
= 0; </SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
&lt; 16; </SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">++</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>)
{{<BR>	IX</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">[</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">/8].[</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">%8][</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">==16-1?”;”:</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>I</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">%4==3?”
|</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>\n\t\t</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">”:”
| “]</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>\<BR>}}		//</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
| </SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><I><SPAN STYLE="font-weight: normal">NL
TAB TAB</SPAN></I></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
after each group of 4 </SPAN></SPAN></FONT>produces:</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>	imm
bit </B></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>trans	</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>=
</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>IX0.0
| IX0.1 | IX0.2 | IX0.3 |</B></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">
NL</SPAN></I></FONT></FONT><FONT FACE="Courier, monospace"><B><BR>	</B></FONT><FONT FACE="Courier, monospace"><I><SPAN STYLE="font-weight: normal">
  TAB	TAB	</SPAN></I></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>=
</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>IX0.4
| IX0.5 | IX0.6 | IX0.7 |</B></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">
NL</SPAN></I></FONT></FONT><FONT FACE="Courier, monospace"><B><BR>	</B></FONT><FONT FACE="Courier, monospace"><I><SPAN STYLE="font-weight: normal">
  TAB	TAB	</SPAN></I></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>=
</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>IX1.0
| IX1.1 | IX1.2 | IX1.3 |</B></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">
NL</SPAN></I></FONT></FONT><FONT FACE="Courier, monospace"><B><BR>	</B></FONT><FONT FACE="Courier, monospace"><I><SPAN STYLE="font-weight: normal">
  TAB	TAB	</SPAN></I></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>=
</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>IX1.4
| IX1.5 | IX1.6 | IX1.7</B></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><B>;</B></FONT></FONT></P>
<P CLASS="western">Normally index expressions occur in <I>iC</I> code
in a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT> loop'. I
deliberately say <I>iC</I> code and not <I>iC</I> statements, because
'<FONT FACE="Courier, monospace"><B>FOR </B></FONT>loops' are used
not only to generate lists of statements, but also lists of
parameters – both for the definition and the call of function
blocks, whose parameter lists can be varied at compile time. Another
use is varying constant parameters. Inside a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' or a nest of '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loops', the <I>iC</I> code usually use the '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' control variable(s) in the index expression(s) to make each
repeated <I>iC</I> code line different.</P>
<P CLASS="western">For index expressions in <I>immediate C</I> code
outside of a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop', the expression must be a constant expression – no variables
are allowed (remember no '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' control variables are in scope anyway). Nevertheless an <I>iC</I>
variable, which must be used as an indexed array variable inside a
'<FONT FACE="Courier, monospace"><B>FOR</B></FONT> loop' looks better
if it follows the same syntax outside of the loop. The variable <FONT FACE="Courier, monospace"><B>a[1]</B></FONT>
could of course be written as <FONT FACE="Courier, monospace"><B>a1</B></FONT>
– this is the same immediate variable. But inside a loop it must be
written as <FONT FACE="Courier, monospace"><B>a[N]</B></FONT> and
only the varying value of <FONT FACE="Courier, monospace"><B>N</B></FONT>
will produce <FONT FACE="Courier, monospace"><B>a0 a1 a2</B></FONT>
etc. 
</P>
<P CLASS="western">Index expressions in embedded <I>C</I> code –
either in a literal block or in a compound <I>C</I> statement
controlled by an <I>immediate</I> <FONT FACE="Courier, monospace"><B>if
else</B></FONT> or <FONT FACE="Courier, monospace"><B>switch</B></FONT>
statement may have index expressions, but they are part of the <I>C</I>
code and are not changed except index expressions, which contain an
in-scope '<FONT FACE="Courier, monospace"><B>FOR</B></FONT> loop'
control variable. This means that the translation of constant index
expressions – as described in the previous paragraph - are not
carried out in embedded <I>C</I> code. In the rare instances where
such a translation is needed, it must be done manually – write <FONT FACE="Courier, monospace"><B>a1</B></FONT>
instead of <FONT FACE="Courier, monospace"><B>a[1]</B></FONT>. 
</P>
<P CLASS="western">A special case in embedded <I>C</I> code occurs,
if a numerical value generated by the control variable of a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' must be placed inside the square brackets of a <I>C</I> array
reference. This can be done by simply embedding the <I>iCa</I> index
expression in the <I>C</I> index expression – eg:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>if
(</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">IX0.0</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{<BR>		int </B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">carray[3];		//
start of embedded C code</SPAN></FONT><FONT FACE="Courier, monospace"><B><BR>	FOR
(</B></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
= 0; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">
&lt; 3; </SPAN></FONT><FONT FACE="Courier, monospace"><B>N</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">++</SPAN></FONT><FONT FACE="Courier, monospace"><B>)
{{<BR>		</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">carray[</SPAN></FONT><FONT FACE="Courier, monospace"><B>[N]</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">]</SPAN></FONT><FONT FACE="Courier, monospace">
= icarray</FONT><FONT FACE="Courier, monospace"><B>[N]</B></FONT><FONT FACE="Courier, monospace"><B>;<BR>	}}<BR>}</B></FONT></FONT></P>
<P CLASS="western">produces</P>
<P ALIGN=LEFT STYLE="margin-left: 1.99cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>if (</B><SPAN STYLE="font-weight: normal">IX0.0</SPAN><B>)
{<BR>	int </B><SPAN STYLE="font-weight: normal">carray[3];		// start
of embedded C code</SPAN><B><BR>	</B>carray[0] = icarray0;<BR>	carray[1]
= icarray1;<BR>	carray[2] = icarray2;<BR><B>}</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">As can be seen in the
above example, <I>iCa</I> '<FONT FACE="Courier, monospace"><B>F</B></FONT><FONT FACE="Courier, monospace"><B>OR</B></FONT>
loops' may be embedded in <I>C</I> code – this is the reason why
the keyword '<FONT FACE="Courier, monospace"><B>FOR</B></FONT><SPAN STYLE="font-weight: normal">'</SPAN>
was chosen instead of '<FONT FACE="Courier, monospace"><B>for</B></FONT><SPAN STYLE="font-weight: normal">'</SPAN>
– the <I>C</I> code may also contain <I>C</I> '<FONT FACE="Courier, monospace"><B>for</B></FONT>
statements'.</P>
<H3 CLASS="western"><A NAME="__RefHeading__23165_1582432481"></A>3.3.4
   immediate Array syntax</H3>
<P CLASS="western">To sum up, immediate arrays are not declared as
such – variable names are used with index expressions in square
brackets. The programmer must be aware that this generates simple
<I>immediate</I> variables starting with the array name followed by a
number. Such generated variable names cannot be used anywhere else –
this would show up as a multiple declaration during <I>iC</I>
compilation. If we use a one-dimensional array in an <I>iCa</I>
program – eg <FONT FACE="Courier, monospace"><B>sa</B></FONT>, any
array reference will simply have a number appended to the array name
in the generated <I>iC</I> code. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
          s</B></FONT><FONT FACE="Courier, monospace"><B>a[i]   
produces sa2<BR>i = 22,           sa[i+1]  produces sa23</B></FONT></FONT></P>
<P CLASS="western">A special case are multi-dimensional arrays. If we
use the standard <I>C</I> syntax to write a multi-dimensional array
reference, eg <FONT FACE="Courier, monospace"><B>ma[i][j]</B></FONT>,
and the <I><B>immac</B></I> pre-processor did not take special
action, we would get the following compile output for the following
pairs of index values:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
j = 34    </B></FONT><FONT FACE="Courier, monospace"><B>ma[i][j]
would produce ma234 // NOT output<BR>i = 23, j = 4     ma[i][j] would
produce ma234 // NOT output</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">This would be
unsatisfactory, because it is ambiguous – therefore <I><B>immac</B></I>
inserts a letter <FONT FACE="Courier, monospace"><B>x</B></FONT>
between adjacent index expressions, producing the following output
instead:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
j = 34    </B></FONT><FONT FACE="Courier, monospace"><B>ma[i][j]
produces ma2x34<BR>i = 23, j = 4     ma[i][j] produces ma23x4</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">This is no longer
ambiguous. Any multiple index is separated by an <FONT FACE="Courier, monospace"><B>x</B></FONT>,
which is easily recognised in the generated <I>iC</I> code as a
member of a multiple-dimensional array – even the numerical index
values can be recognised easily in the generated names. 
</P>
<P CLASS="western" STYLE="font-style: normal">Both in <I>C</I> and by
analogy in <I>immediate C</I> with arrays (<I>iCa</I>), array names
and the index expressions in square brackets (and of course the
expressions in the square brackets) may be separated by spaces and
tab's – as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
j = 34    </B></FONT><FONT FACE="Courier, monospace"><B>ma   [ i ]  [
j ]   still produces ma2x34<BR>i = 23, j = 4     ma   [ i ]  [ j ]  
still produces ma23x4</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">One caveat applies for
<I><B>immac</B></I>: <I><SPAN STYLE="font-weight: normal">such an
array name with all its subsequent square bracketed index expressions
must be in the same line</SPAN></I>. (In <I>C</I> any sort of white
space is allowed).</P>
<P CLASS="western" STYLE="font-style: normal">Another case where
<I><B>immac</B></I> inserts an extra character are array names which
finish with a numeral. This could also lead to ambiguity if special
action were not taken:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>i = 2, 
          s</B></FONT><FONT FACE="Courier, monospace"><B>a9  [ i ]   
      produces sa9y2<BR>i = 22,           sa9  [ i+1 ]       
produces sa9y23</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">Although the way <I><B>immac</B></I><B>
</B>handles array names, which finish with a numeral avoids
ambiguity, such names should be avoided, because in the generated <I>iC</I>
code they look too much like expanded array names with an extra
index, which could easily lead to clashes. To avoid this clash a <FONT FACE="Courier, monospace"><B>y</B></FONT>
is inserted in this case.</P>
<P CLASS="western" STYLE="font-style: normal">String index
expressions in square brackets, which contain a string value in
parentheses, eg</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>[N &lt; MAX ? </B><SPAN STYLE="font-weight: normal">&quot;,&quot;
: &quot;;&quot;</SPAN><B>]</B></FONT></FONT></P>
<P CLASS="western" STYLE="font-style: normal">are not separated from
an adjacent index expression by <FONT FACE="Courier, monospace"><B>x</B></FONT>
or <FONT FACE="Courier, monospace"><B>y</B></FONT>.</P>
<P CLASS="western" STYLE="font-style: normal"><B>In every case, the
names generated from single- and multi-dimensional array references
are well formed </B><I><B>iC</B></I><B> variables, which show their
name and index value(s). </B>The main thing to remember with array
references is, that every array reference translates to a simple <I>iC</I>
variable name, which shows up in the generated <I>iC</I> code, which
will normally be a lot longer than the <I>iCa</I> code, but which
must be used for live debugging with <I><B>iClive</B></I>. The mental
translation between indexed array references and the resolved <I>iC</I>
names is so simple, that it should not cause any problems to the
user.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__8903_1090881298"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>3.4  immac
Macro facility</FONT></FONT></H2>
<P CLASS="western">The pre-compiler <B>immac</B> provides a full
macro facility very similar to that provided by the <I>C</I>
pre-processor <B>cpp</B>. Object like macros without parameters as
well as function like macros with parameters in parentheses are
supported. The keyword to introduce an <B>immac</B> macro definition
is <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>%define</B></SPAN></FONT>
not <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>#define</B></SPAN></FONT>;
that is reserved for <B>cpp</B> or <B>immac -m</B>. The latter is an
alternative to <B>cpp</B> and is used in conjunction with the full <I>iC</I>
compiler <B>immcc</B> to resolve <I>C</I> type macro's in embedded <I>C</I>
code fragments.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>%define LENGTH	 4</B></FONT></P>
<P CLASS="western" STYLE="font-style: normal">The same macro term
<FONT FACE="Courier, monospace"><B>LENGTH</B></FONT> could also be
pre-defined in the command line with the <B>-P</B> option:</P>
<P CLASS="western" STYLE="margin-left: 2.05cm; font-style: normal"><FONT FACE="Courier, monospace"><B>immac
-P LENGTH=8 </B></FONT>
</P>
<P CLASS="western" STYLE="font-style: normal">Unlike <B>cpp</B>, the
definition in the command line has precedence over the definition
with a <FONT FACE="Courier, monospace"><B>%define</B></FONT> line in
the program. This allows <I>iCa</I> programs to define default values
for macro terms, which can be re-defined in the command line. It is
an error to <FONT FACE="Courier, monospace"><B>%define</B></FONT> a
macro, which has been previously defined (except on the command line
- the new definition is ignored). The command <FONT FACE="Courier, monospace"><B>%undef</B></FONT>
X will undefine the macro X, which can then be re-defined. This is
important if an internal definition is to have precedence over a
(possible) command line definition – do a <FONT FACE="Courier, monospace"><B>%undef</B></FONT>
first. It is not an error to <FONT FACE="Courier, monospace"><B>%undef</B></FONT>
a non-existing macro. 
</P>
<P CLASS="western" STYLE="font-style: normal">Macros must be a word
starting with a letter or underscore followed optionally by letters
underscores or decimal digits (same as a <I>C</I> or <I>iC</I>
identifier). It is highly recommended that letters in a macro are all
upper case (same recommendation as for <B>cpp</B>). Macro
replacements can be any sort of text, which may also include
previously defined macros.  For replacement as index values, they
should of course reduce to numeric values or string constants.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>%define WIDTH	 (5+1)</B><SPAN STYLE="font-weight: normal">		/*
C comment */</SPAN><B><BR>%define AREA	 (LENGTH * WIDTH)</B><SPAN STYLE="font-weight: normal">	//
C++ comment</SPAN></FONT></P>
<P CLASS="western" STYLE="font-style: normal">If a replacement text
is longer than one line, each line except the last must finish with a
backslash <B>\</B><BR>As shown above <FONT FACE="Courier, monospace"><B>%define</B></FONT>
lines may be terminated with a <I>C</I> or <I>C++</I> comment.
Replacement texts may also contain embedded <I>C</I> comments, which
will be replaced by a single space on expansion. Multiple spaces will
be replaced by one space (same as <B>cpp</B>). As with ' <FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' control lines, a <I>C</I> comment must finish on the <FONT FACE="Courier, monospace"><B>%define</B></FONT>
line. Replacement texts for function like macros should contain at
least one sample of each parameter text. If not a warning will be
issued.</P>
<P CLASS="western">Parameters may be 'stringified' in the replacement
by preceding them with a single <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>#</B></SPAN></FONT>.
Two parameters or indeed any words may be concatenated by placing <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>##</B></SPAN></FONT>
between them. Every effort has been made to obtain the same
translations for replacement texts as those obtained by using <B>cpp</B>.</P>
<P CLASS="western" STYLE="font-style: normal">There are some minor
differences. Replacements which resolve to a constant arithmetic
expression involving only the operators + - * / and % as well as ( )
decimal integers and spaces are evaluated in the definition. This
brings error messages a little closer to the source of any erroneous
constant expression. The final result is the same though.</P>
<P CLASS="western">For the above macro <B>immac</B> translates
<FONT FACE="Courier, monospace"><B>%define</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>
AREA</B></SPAN></FONT> to <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>48</B></SPAN></FONT>
wheras <B>immac -m</B> and <B>cpp</B> tranlates <FONT FACE="Courier, monospace"><B>#define
AREA</B></FONT> to <FONT FACE="Courier, monospace"><B>(8 * (5 + 1))</B></FONT>.</P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>%define</B></FONT>
lines are not copied to the target except as comment lines, if the -a
option is active for the <B>immac</B> compiler.</P>
<P CLASS="western" STYLE="font-style: normal">Macro replacements may
be made in all parts of the <I>iCa</I> code. They are of course
particularly useful to parametrise the termination of a '<FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop' and hence the number of blocks of <I>iC</I> code, which is
generated by the ' <FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loop'.</P>
<P CLASS="western">File inclusion with <FONT FACE="Courier, monospace"><B>%include
&quot;file&quot;</B></FONT> and conditional compilation with <FONT FACE="Courier, monospace"><B>%ifdef</B></FONT>,
<FONT FACE="Courier, monospace"><B>%ifndef</B></FONT>, <FONT FACE="Courier, monospace"><B>%if</B></FONT>,
<FONT FACE="Courier, monospace"><B>%elif</B></FONT>, <FONT FACE="Courier, monospace"><B>%else</B></FONT>,
<FONT FACE="Courier, monospace"><B>%endif</B></FONT> and <FONT FACE="Courier, monospace"><B>%error</B></FONT>
are also supported using the same rules as <B>cpp</B>. The word
'<FONT FACE="Courier, monospace"><B>defined</B></FONT>' in an <FONT FACE="Courier, monospace"><B>%if</B></FONT>
or <FONT FACE="Courier, monospace"><B>%elif</B></FONT> expression has
the usual <B>cpp</B> meaning - it is set to 1 (true) if defined else
0 (false). Identifiers in such an expression which are not defined in
a previous <FONT FACE="Courier, monospace"><B>%define</B></FONT> or
-P are also set to 0 (false).</P>
<P CLASS="western">When <B>immac</B> is called with the <B>-m</B>
option it simply becomes a macro processor handling <FONT FACE="Courier, monospace"><B>#define</B></FONT>,
<FONT FACE="Courier, monospace"><B>#undef</B></FONT>, -D, -U,
<FONT FACE="Courier, monospace"><B>#include</B></FONT>, <FONT FACE="Courier, monospace"><B>#if</B></FONT>,
<FONT FACE="Courier, monospace"><B>#else</B></FONT> etc.  No <I>iCa</I>
constructs are translated in this mode. Every attempt has been made
to make <B>immac -m</B> equivalent to <B>cpp</B>.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__8905_1090881298"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>3.5 
Differences between iC and iCa code</FONT></FONT></H2>
<P CLASS="western">Straight <I>immediate C</I> code is usually made
up of short statements declaring the relationship between input and
intermediate variables to output or intermediate variables - very
similar to PLC code, which is easy to understand by technicians. It
presents a clean picture of control expressions acting on control
variables, which build up to a clear picture of the interactions with
the plant to be controlled. This interaction is most clearly visible
when a live display is active, where individual changes in the real
plant parameters show up as state information in the code. This PLC
style of coding is a very important aspect of producing <I>immediately</I>
understandable and straight forward control programs. This was the
most important design consideration for the <I>immediate C</I>
language.</P>
<P CLASS="western">On the other hand <I>iCa</I> code with arrays
introduces another level of algorithmic loops, control statements and
indexing in the middle of <I>iC</I> code for generating larger blocks
of <I>iC</I> code. Frankly the actual <I>iC</I> code required is
hidden quite deeply and it requires a certain amount of skill when
developing <I>iCa</I> code snippets, to simply concentrate on what is
to be generated and adjust the looping and control algorithms
accordingly. Frequently translating the code with the <I><B>immac</B></I>
compiler is the best way to see that what is generated is really the
<I>iC</I> code envisaged. In fact I found it important to code a
small block of <I>iC</I> code first to lay down the control strategy.
Once that is fixed, repeating statements can be rolled into loops
fairly easily. Comparing the generated code with the hand coded part
using <B>diff</B> confirms that <I>iCa</I> loop and control
algorithms are correct.</P>
<P CLASS="western">Here is a hand coded <I>iC</I> program segment
which need to be variable in length:</P>
<P ALIGN=LEFT STYLE="margin-left: 0.47cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm bit m0, m1, m2,
m3, m4, m5, m6, m7, m8;</B></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.47cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>QX0.0 = m0 = SR(~m8, 
    m8 &amp; ~m1, c0);<BR>QX0.1 = m1 = SR(~m8 &amp; m0, m8 &amp; ~m2,
c0);<BR>QX0.2 = m2 = SR(~m8 &amp; m1, m8 &amp; ~m3, c0);<BR>QX0.3 =
m3 = SR(~m8 &amp; m2, m8 &amp; ~m4, c0);<BR>QX0.4 = m4 = SR(~m8 &amp;
m3, m8 &amp; ~m5, c0);<BR>QX0.5 = m5 = SR(~m8 &amp; m4, m8 &amp; ~m6,
c0);<BR>QX0.6 = m6 = SR(~m8 &amp; m5, m8 &amp; ~m7, c0);<BR>QX0.7 =
m7 = SR(~m8 &amp; m6, m8,       c0);<BR>QX1.0 = m8 = SR(~m8 &amp; m7,
m8 &amp; ~m0, c0);</B></FONT></FONT></P>
<P CLASS="western" STYLE="page-break-before: always">This is the
required <I>iCa</I> code which looks rather ghastly but does produce
blocks of any length:</P>
<P ALIGN=LEFT STYLE="margin-left: 0.47cm; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B>%define
LAST 8		// iC code snippets are </B></SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-style: normal"><B><SPAN STYLE="background: #e6ff00">highlighted</SPAN></B></SPAN></FONT></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.47cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B><SPAN STYLE="background: #e6ff00">imm
bit</SPAN> FOR (I = 0; I &lt;= LAST; I++) {{<SPAN STYLE="background: #e6ff00">
m[I],</SPAN> }}<SPAN STYLE="background: #e6ff00">;</SPAN></B></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.47cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
  <FONT FACE="Courier, monospace"><FONT SIZE=2><B>FOR (I = 0; I &lt;=
LAST; I++) {{<BR><SPAN STYLE="background: #e6ff00">QX[I/8].[I%8] =
m[I] = SR(~m[LAST]</SPAN>\<BR>   IF (I == 0     ) {{[&quot;<SPAN STYLE="background: #e6ff00">,
    </SPAN>&quot;] }} ELSE {{<SPAN STYLE="background: #e6ff00"> &amp;
m[I-1],</SPAN>}}<SPAN STYLE="background: #e6ff00"> m[LAST]</SPAN>\<BR>
  IF (I == LAST-1) {{[&quot;<SPAN STYLE="background: #e6ff00">,     
</SPAN>&quot;]}} ELSE {{<SPAN STYLE="background: #e6ff00"> &amp;
~m[(I+1)%(LAST+1)],</SPAN>}}<SPAN STYLE="background: #e6ff00"> c0);</SPAN><BR>
 }}</B></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-top: 0.1cm; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>A larger
example if <I>iCa</I> code is the <A HREF="#7.3.  Parcel Sorter|outline">Parcel
Sorter (Section 7.3)</A>.</FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__7826_384121057"></A><A NAME="3.6.  immC Arrays|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>3.6  immC
Arrays</FONT></FONT></H2>
<P CLASS="western"><FONT FACE="Courier, monospace"><B>immC</B></FONT>
Arrays are arrays of <FONT FACE="Courier, monospace"><B>immC bit</B></FONT>
or <FONT FACE="Courier, monospace"><B>immC int </B></FONT>variables
of the same type as its members. They are part if the <I>iC</I>
language proper and are translated by the <I><B>immcc </B></I>compiler.
(not <I><B>immac</B></I>) 
</P>
<P CLASS="western">Just like ordinary <FONT FACE="Courier, monospace"><B>immC</B></FONT>
variables indexed references to an <FONT FACE="Courier, monospace"><B>immC</B></FONT>
Array may be used as immediate values in both <I>iC</I> and <I>C</I>
code, but they may only be assigned and changed in <I>C</I> code –
either in <FONT FACE="Courier, monospace"><B>if else </B></FONT>or
<FONT FACE="Courier, monospace"><B>switch</B></FONT> <I>C</I> code
fragments or in literal blocks. Another limitation is, that <FONT FACE="Courier, monospace"><B>immC</B></FONT>
Array indexed value references in <I>iC</I> code may only use a
constant numerical index. Such an indexed variable is an alias for
the <FONT FACE="Courier, monospace"><B>immC</B></FONT> member
referred to and as such simply provides some syntactic sugar. In the
example below, <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">bb</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>[</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">0</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>]</B></SPAN></FONT>is
the same as <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">bx</SPAN></SPAN></FONT>
- it simplifies coding though. Whole <FONT FACE="Courier, monospace"><B>immC</B></FONT>
Arrays may be passed by name in a Function Block call, if the
Function Block definition specifies an <FONT FACE="Courier, monospace"><B>immC</B></FONT>
array in that position in its formal parameter list.</P>
<P CLASS="western"><FONT FACE="Courier, monospace"><B>immC</B></FONT>
Arrays are declared in <I>iC</I> code – either with or without a
list of named members.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>immC int </B><SPAN STYLE="font-weight: normal">aa</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>];		//
immC int </B><SPAN STYLE="font-weight: normal">aa0, aa1,</SPAN><B>
</B><SPAN STYLE="font-weight: normal">aa2; </SPAN><B>corres-<BR>				//
ponding to </B><SPAN STYLE="font-weight: normal">aa</SPAN><B>[</B><SPAN STYLE="font-weight: normal">0</SPAN><B>]</B><SPAN STYLE="font-weight: normal">
aa</SPAN><B>[</B><SPAN STYLE="font-weight: normal">1</SPAN><B>] and
</B><SPAN STYLE="font-weight: normal">aa</SPAN><B>[</B><SPAN STYLE="font-weight: normal">2</SPAN><B>]
  					// are automatically generated</B></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>immC bit </B><SPAN STYLE="font-weight: normal">bx,
by, bz</SPAN><B>;	// the immC members in an initialiser<BR>immC bit
</B><SPAN STYLE="font-weight: normal">bb</SPAN><B>[] = { </B><SPAN STYLE="font-weight: normal">bx,
by, bz</SPAN><B> }; // list may be pre-declared<BR>immC bit </B><SPAN STYLE="font-weight: normal">cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>];</B></FONT></P>
<P CLASS="western">A declaration of an <FONT FACE="Courier, monospace"><B>immC</B></FONT>
Array without a member list must specify a size. The member names
automatically generated follow the same pattern as <FONT FACE="Courier, monospace"><B>imm</B></FONT>
Arrays resolved by <I><B>immac</B></I> – the name of the array
followed by a number equal to the index. This choice was deliberate.
Multi-dimensional <FONT FACE="Courier, monospace"><B>immC</B></FONT>
arrays have not been implemented.</P>
<P CLASS="western">For an array with a member list the size
specification is optional, but must equal the number of members in
the list if it is specified. The names in the member list can be any
previously declared immC variable – they may even be indexed
references of a previously declared immC Array. If not previously
declared, the members are generated in the array declaration, just
like automatic members.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>immC bit </B><SPAN STYLE="font-weight: normal">ccr</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>]
= { </B><SPAN STYLE="font-weight: normal">cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">2</SPAN><B>]</B><SPAN STYLE="font-weight: normal">,
cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">1</SPAN><B>]</B><SPAN STYLE="font-weight: normal">,
cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">0</SPAN><B>] }; 
// reverse of </B><SPAN STYLE="font-weight: normal">cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>]</B></FONT></P>
<P CLASS="western"><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></FONT>
Arrays may be used in another source if they have been previously
declared <FONT FACE="Courier, monospace"><B>extern</B></FONT>. The
<FONT FACE="Courier, monospace"><B>extern</B></FONT> declaration must
match the final declaration exactly. The size must match and if a
member list is provided it must also be provided identically in the
<FONT FACE="Courier, monospace"><B>extern</B></FONT> declaration.
Only that way can the members of an <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></FONT>
Array be used correctly both in <I>iC</I> code and <I>C</I> code of
another source file.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>extern immC int </B><SPAN STYLE="font-weight: normal">aa</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>];</B></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>extern immC bit </B><SPAN STYLE="font-weight: normal">bx,
by, bz</SPAN><B>;<BR>extern immC bit </B><SPAN STYLE="font-weight: normal">bb</SPAN><B>[]
= { </B><SPAN STYLE="font-weight: normal">bx, by, bz</SPAN><B> };</B></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace"><B>extern immC bit </B><SPAN STYLE="font-weight: normal">cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>];<BR>extern
immC bit </B><SPAN STYLE="font-weight: normal">ccr</SPAN><B>[</B><SPAN STYLE="font-weight: normal">3</SPAN><B>]
= { </B><SPAN STYLE="font-weight: normal">cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">2</SPAN><B>]</B><SPAN STYLE="font-weight: normal">,
cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">1</SPAN><B>]</B><SPAN STYLE="font-weight: normal">,
cc</SPAN><B>[</B><SPAN STYLE="font-weight: normal">0</SPAN><B>] };</B></FONT></P>
<P CLASS="western">An <FONT FACE="Courier, monospace"><B>immC</B></FONT>
Array knows its own size and a run time warning occurs if an indexed
reference is not within the size range of the array. An indexed
reference, which is out of range returns <FONT FACE="Courier New, monospace"><B>bit</B></FONT>
or <FONT FACE="Courier New, monospace"><B>int</B></FONT> 0.</P>
<P CLASS="western"><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></SPAN></FONT><SPAN LANG="en-GB">
Arrays may be passed as formal parameters in a function block
definition (see section <A HREF="#7.1.  immediate Function Block Definition|outline">7.1</A>).
A formal array parameter is a name followed by square brackets which
either contain a numeric size or is empty. If a size is given 
(</SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB">b</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>[</B></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><SPAN STYLE="font-weight: normal">4</SPAN></SPAN></FONT><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>]</B></SPAN></FONT><SPAN LANG="en-GB">),
the call to that function block must provide a previously declared
array of exactly that size. In this case </SPAN><SPAN LANG="en-GB"><I>iC</I></SPAN><SPAN LANG="en-GB">
code in the function block can also access the array. If no size is
specified (</SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB">a</SPAN></FONT><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>[]</B></SPAN></FONT><SPAN LANG="en-GB">),
any size array can be provided in the call. That array can only be
accessed in C code in the function block. It is up to the C code
algorithm to make sure that index values are within range.</SPAN></P>
<P CLASS="western">The built in <I>iC</I> operator <FONT FACE="Courier, monospace"><B>sizeof
</B></FONT><I>array</I> returns the number of elements of an <FONT FACE="Courier New, monospace"><B>immC</B></FONT>
<I>array</I><SPAN STYLE="font-style: normal"> </SPAN><SPAN STYLE="font-style: normal">(not
its size in bytes)</SPAN><I>.</I> The <FONT FACE="Courier, monospace"><B>sizeof</B></FONT>
operator works best in <I>C</I> code fragments where its value is
dynamic at run time. It also works in <I>iC</I> code, where its value
is determined at compile time. A difference occurs in function blocks
which have been passed an array of indeterminate size (<FONT FACE="Courier, monospace">a</FONT><FONT FACE="Courier, monospace"><B>[]</B></FONT>)
as a parameter. Only the <FONT FACE="Courier, monospace"><B>sizeof</B></FONT>
operator in <I>C</I> code will return the actual size of the array
passed in a call. Since in this situation only indexed references in
<I>C</I> code fragments are possible, the <FONT FACE="Courier, monospace"><B>sizeof</B></FONT>
test in the <I>C</I> code is appropriate.</P>
<P CLASS="western"><FONT FACE="Courier, monospace"><B>sizeof</B></FONT>
may be used to test index values and produce own error strategies.
The following must be true:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.05cm; font-style: normal; line-height: 0.4cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2><B>index &lt; sizeof
array</B></FONT></FONT></P>
<P CLASS="western">The following <I>iC</I> code triggers 1 of 100
<FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>ST()</B></SPAN></FONT>
mono-flops selected by the int variable <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>selIndex</B></SPAN></FONT>
on the rising edge of the bit variable <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>trig</B></SPAN></FONT>.
For each <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>trig</B></SPAN></FONT>
event only one of the <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></FONT>
members of the <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>immC</B></SPAN></FONT>
array <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>selGate[]</B></SPAN></FONT>
fires. The whole triggering would be done in about 2 usec on a modern
processor.</P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>/********************************************************************<BR>
*      Select 1 of 100 output gates<BR>
*******************************************************************/</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>imm
timer tick;         /* timer to produce delay time of selected gate
*/<BR>imm bit   trig;         /* short pulse to initiate selection
*/<BR>imm int   selIndex;     /* numerical index of the selected gate
*/</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>immC
bit  selGate[100]; /* immC Array declaration */</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>%{
int    temp; %}      /* C variable temp used only in C code */</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>if
(trig &amp; selIndex &lt; sizeof selGate) {     /* rising trig /<BR> 
  temp = selIndex;    /* assignment to C variable temp */<BR>   
selGate[temp] = 1;  /* variable indexed array reference in C code */</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>}
else {                                    /* falling trig */<BR>   
selGate[temp] = 0;  /* temp is changed on the next rising trig */<BR>}</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>imm
bit gate0  = ST(selGate[0],  tick, 10); // start mono-flop for 10
tick<BR>imm bit gate1  = ST(selGate[1],  tick, 10);<BR>imm bit gate2 
= ST(selGate[2],  tick, 10); // constant indexed array<BR>imm bit
gate3  = ST(selGate[3],  tick, 10); // references in iC code<BR>imm
bit gate4  = ST(selGate[4],  tick, 10);<BR>imm bit gate5  =
ST(selGate[5],  tick, 10);<BR>imm bit gate6  = ST(selGate[6],  tick,
10);<BR>imm bit gate7  = ST(selGate[7],  tick, 10);<BR>imm bit gate8 
= ST(selGate[8],  tick, 10);<BR>imm bit gate9  = ST(selGate[9], 
tick, 10);<BR>imm bit gate10 = ST(selGate[10], tick, 10);<BR>imm bit
gate11 = ST(selGate[11], tick, 10);<BR>imm bit gate12 =
ST(selGate[12], tick, 10);<BR>imm bit gate13 = ST(selGate[13], tick,
10);<BR>imm bit gate14 = ST(selGate[14], tick, 10);<BR>imm bit gate15
= ST(selGate[15], tick, 10);<BR>imm bit gate16 = ST(selGate[16],
tick, 10);<BR>imm bit gate17 = ST(selGate[17], tick, 10);<BR>imm bit
gate18 = ST(selGate[18], tick, 10);<BR>imm bit gate19 =
ST(selGate[19], tick, 10);<BR> …<BR>imm bit gate90 =
ST(selGate[90], tick, 10);<BR>imm bit gate91 = ST(selGate[91], tick,
10);<BR>imm bit gate92 = ST(selGate[92], tick, 10);<BR>imm bit gate93
= ST(selGate[93], tick, 10);<BR>imm bit gate94 = ST(selGate[94],
tick, 10);<BR>imm bit gate95 = ST(selGate[95], tick, 10);<BR>imm bit
gate96 = ST(selGate[96], tick, 10);<BR>imm bit gate97 =
ST(selGate[97], tick, 10);<BR>imm bit gate98 = ST(selGate[98], tick,
10);<BR>imm bit gate99 = ST(selGate[99], tick, 10);</B></FONT></P>
<P CLASS="western" ALIGN=LEFT>This is a great efficiency improvement
over the only previously possible <I>iC</I> strategy – a comparison
statement in each of the 100 triggering lines. In this code each of
the 100 expressions 
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm"><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>selIndex
== 0,</B></SPAN></FONT> <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>selIndex
== 1,</B></SPAN></FONT> <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>selIndex
== 2</B></SPAN></FONT> etc 
</P>
<P CLASS="western" ALIGN=LEFT>is executed every time <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>selIndex</B></SPAN></FONT>
changes. This would use up about 100 usec of CPU time.</P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>/********************************************************************<BR>
*      Old style select 1 of 100 output gates<BR>
*******************************************************************/</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>imm
timer tick;         /* timer to produce delay time of selected gate
*/<BR>imm bit   trig;         /* short pulse to initiate selection
*/<BR>imm int   selIndex;     /* numerical index of the selected gate
*/</B></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="font-style: normal"><FONT FACE="Courier, monospace"><B>imm
bit gate0  = ST(trig &amp; selIndex == 0,  tick, 10); // start
mono-flop<BR>imm bit gate1  = ST(trig &amp; selIndex == 1,  tick,
10);<BR>imm bit gate2  = ST(trig &amp; selIndex == 2,  tick, 10);<BR>imm
bit gate3  = ST(trig &amp; selIndex == 3,  tick, 10);<BR>imm bit
gate4  = ST(trig &amp; selIndex == 4,  tick, 10);<BR>imm bit gate5  =
ST(trig &amp; selIndex == 5,  tick, 10);<BR>imm bit gate6  = ST(trig
&amp; selIndex == 6,  tick, 10);<BR>imm bit gate7  = ST(trig &amp;
selIndex == 7,  tick, 10);<BR>imm bit gate8  = ST(trig &amp; selIndex
== 8,  tick, 10);<BR>imm bit gate9  = ST(trig &amp; selIndex == 9, 
tick, 10);<BR>imm bit gate10 = ST(trig &amp; selIndex == 10, tick,
10);<BR>imm bit gate11 = ST(trig &amp; selIndex == 11, tick, 10);<BR>imm
bit gate12 = ST(trig &amp; selIndex == 12, tick, 10);<BR>imm bit
gate13 = ST(trig &amp; selIndex == 13, tick, 10);<BR>imm bit gate14 =
ST(trig &amp; selIndex == 14, tick, 10);<BR>imm bit gate15 = ST(trig
&amp; selIndex == 15, tick, 10);<BR>imm bit gate16 = ST(trig &amp;
selIndex == 16, tick, 10);<BR>imm bit gate17 = ST(trig &amp; selIndex
== 17, tick, 10);<BR>imm bit gate18 = ST(trig &amp; selIndex == 18,
tick, 10);<BR>imm bit gate19 = ST(trig &amp; selIndex == 19, tick,
10);<BR> …<BR>imm bit gate90 = ST(trig &amp; selIndex == 90, tick,
10);<BR>imm bit gate91 = ST(trig &amp; selIndex == 91, tick, 10);<BR>imm
bit gate92 = ST(trig &amp; selIndex == 92, tick, 10);<BR>imm bit
gate93 = ST(trig &amp; selIndex == 93, tick, 10);<BR>imm bit gate94 =
ST(trig &amp; selIndex == 94, tick, 10);<BR>imm bit gate95 = ST(trig
&amp; selIndex == 95, tick, 10);<BR>imm bit gate96 = ST(trig &amp;
selIndex == 96, tick, 10);<BR>imm bit gate97 = ST(trig &amp; selIndex
== 97, tick, 10);<BR>imm bit gate98 = ST(trig &amp; selIndex == 98,
tick, 10);<BR>imm bit gate99 = ST(trig &amp; selIndex == 99, tick,
10);</B></FONT></P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23169_1582432481"></A>
<FONT SIZE=4>4    Built-in Functions</FONT></H1>
<P CLASS="western"><I>iC</I> has a number of built in functions,
which are so central to the operation of the system, that they have
been made a part of the language. They are implemented as efficient
building blocks in the supporting run time package. Functions, which
could not be created from simpler <I>iC</I> statements are generated
by the compiler – others are defined internally as built-in
Function Blocks. All except the LATCH and the FORCE functions are
'clocked', which is analogous to similar functionality in hardware
IC's. (parameter types shown are all <I>immediate</I> – the keyword
<FONT FACE="Courier, monospace"><B>imm</B></FONT> is left out for
clarity).</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23171_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.1  Unclocked
flip-flop or LATCH</FONT></FONT></H2>
<P CLASS="western">The unclocked R-S flip-flop is the <FONT FACE="Courier, monospace"><B>LATCH</B></FONT>
function with the following calling sequence: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit</SPAN><B> LATCH</B>(bit set, bit reset);</FONT></P>
<P CLASS="western">The following truth table describes the <FONT FACE="Courier, monospace"><B>LATCH</B></FONT>
function: 
</P>
<DL>
	<DD>
	<TABLE WIDTH=242 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=39>
		<COL WIDTH=40>
		<COL WIDTH=137>
		<TR VALIGN=TOP>
			<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">set</FONT></P>
			</TD>
			<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">reset</FONT></P>
			</TD>
			<TD WIDTH=137 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">LATCH(set,reset)</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=39 HEIGHT=10 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<BR>
				</P>
			</TD>
			<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<BR>
				</P>
			</TD>
			<TD WIDTH=137 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">Q</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=137 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">Q</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=137 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=137 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=137 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
				   <FONT FACE="Courier, monospace">Q  <A CLASS="sdfootnoteanc" NAME="sdfootnote2anc" HREF="#sdfootnote2sym"><SUP>2</SUP></A></FONT></P>
			</TD>
		</TR>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>LATCH</B></FONT>
function is particularly fast and efficient, using only a single gate
node. It is of course possible to program a similar latch function
with a pair of cross coupled OR gates. In <I>iC </I>this looks as
follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> set, reset, Q, Qbar;<BR>Q
   = set &amp; ~reset | </FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">Qbar;<BR>Qbar
= reset &amp; ~set | </FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace">Q;
<A CLASS="sdfootnoteanc" NAME="sdfootnote3anc" HREF="#sdfootnote3sym"><SUP>3</SUP></A></FONT></FONT></P>
<P CLASS="western">The disadvantage of this implementation is the
fact that four gate nodes are used and that its function as a latch
memory element is hidden. <FONT FACE="Courier, monospace"><B>LATCH</B></FONT>
clearly shows its function.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23173_1582432481"></A><A NAME="4.2.  FORCE function|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.2  FORCE
function</FONT></FONT></H2>
<P CLASS="western">Closely related to the <FONT FACE="Courier, monospace"><B>LATCH</B></FONT>
function is the <FONT FACE="Courier, monospace"><B>FORCE</B></FONT>
function with the following calling sequence and truth table:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>FORCE</B>(bit arg1, bit on, bit off);</FONT></P>
<DL>
	<DD>
	<TABLE WIDTH=292 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=35>
		<COL WIDTH=36>
		<COL WIDTH=36>
		<COL WIDTH=151>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">arg1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">on</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">off</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">FORCE(arg1,on,off)</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">X</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">X</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=35 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=151 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
	</TABLE>
</DL>
<P CLASS="western"><BR>The <FONT FACE="Courier, monospace"><B>FORCE</B></FONT>
function passes the value of <FONT FACE="Courier, monospace">arg1</FONT>
to the output if both <FONT FACE="Courier, monospace">on</FONT> and
<FONT FACE="Courier, monospace">off</FONT> are <FONT FACE="Courier, monospace">0</FONT>
(or both are <FONT FACE="Courier, monospace">1</FONT>). If only <FONT FACE="Courier, monospace">on</FONT>
is <FONT FACE="Courier, monospace">1</FONT> then the output is forced
to <FONT FACE="Courier, monospace">1</FONT>, independent of the value
of <FONT FACE="Courier, monospace">arg1</FONT>. Conversely if
only<BR><FONT FACE="Courier, monospace">off</FONT> is <FONT FACE="Courier, monospace">1</FONT>
then the output is forced to <FONT FACE="Courier, monospace">0</FONT>.
This function is useful for testing.</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">Note for deep thinkers:  the following expression
generates a <FONT FACE="Courier, monospace"><B>LATCH</B></FONT>
function from a <FONT FACE="Courier, monospace"><B>FORCE</B></FONT>
function. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">(temp001
= FORCE(temp001, set, reset))</FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>This
is how a </FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>LATCH</B></FONT></FONT><FONT SIZE=2>
is generated by the </FONT><FONT SIZE=2><I>iC</I></FONT><FONT SIZE=2>
compiler from the more fundamental </FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>FORCE</B></FONT></FONT><FONT SIZE=2>
function - using feedback of its own output to hold that value at its
input, unless the ‘on‘ or ‘off‘ inputs force the output to a
different value.</FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23175_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.3  Clocked D
flip-flop</FONT></FONT></H2>
<P CLASS="western">The simplest clocked flip-flop is the D flip-flop
or delay memory element, a function having a single logic input, a
clock input and an output equal to the input in the previous clock
period. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>D</B>(bit expr, clock c);   or<BR>imm bit <B>D</B>(bit
expr)	;	/* <I>default </I><SPAN STYLE="font-style: normal">iClock</SPAN><I>
used as</I> clock */ </FONT>
</P>
<P CLASS="western">The following truth table describes the D
flip-flop: 
</P>
<DL>
	<DD>
	<TABLE WIDTH=193 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=87>
		<COL WIDTH=88>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=87 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">expr</FONT></P>
				</TD>
				<TD WIDTH=88 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">D(expr,c)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=87 HEIGHT=10 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">D<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=88 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=87 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=88 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=87 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=88 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop has become the most commonly used clocked flip-flop in
hardware design. Its application is called for, when several bit
expressions must produce synchronized outputs, so that any further
logic done with these outputs does not suffer from timing races. A
typical example is the implementation of a state machine. The <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop is also a 1 bit memory element, which can store information
from one clock period to the next. The <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop is called for in any design where feedback is involved. The
use of the clocked <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop in <I>iC</I> will probably fall into a similar pattern. 
</P>
<P CLASS="western">Examples of statements using <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flops is the generation of a pulse on the rising edge of an
input and of a pulse on a change of input. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace">    input;<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit </B></FONT><FONT FACE="Courier, monospace">   rise   = input &amp;
</FONT><FONT FACE="Courier, monospace"><B>~</B></FONT><FONT FACE="Courier, monospace"><B>D</B></FONT><FONT FACE="Courier, monospace">(input);<BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace">    change = input ^ 
</FONT><FONT FACE="Courier, monospace"><B>D</B></FONT><FONT FACE="Courier, monospace">(input);
</FONT></FONT>
</P>
<P CLASS="western">The output <FONT FACE="Courier, monospace">rise</FONT>
goes hi when <FONT FACE="Courier, monospace">input</FONT> goes hi and
goes lo again when the output of the inverted <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop goes lo after the next (implicit) clock pulse. The second
example uses the exclusive-or operator <FONT FACE="Courier, monospace"><B>^</B></FONT>
to generate a pulse on both the rising and falling edge of the input.
</P>
<P CLASS="western">For all clocked built in functions, each parameter
may have its own clock parameter. If a clock parameter is supplied it
applies to all parameters on its left, which do not have their own
clock. If no clock parameter is specified, the built in <FONT FACE="courier, monospace"><B>iClock</B></FONT>
is used.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23177_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.4  Clocked SR
flip-flop</FONT></FONT></H2>
<P CLASS="western">The memory element that is represented in most PLC
instruction sets is the R-S flip-flop. This flip-flop has two logic
inputs. The rising edge of the set input puts the flip-flop in the
&quot;one&quot; state and the rising edge of the reset input puts the
flip-flop in the &quot;zero&quot; state. Many books on switching
theory describe a simple unclocked latch memory element by the name
R-S flip-flop. Following the usage in IEC-1131, and because the set
parameter precedes the reset parameter in the calling sequence, the
clocked Set-Reset flip-flop was named <FONT FACE="Courier, monospace"><B>SR</B></FONT>
flip-flop in <I>iC</I>: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>SR</B>(bit set, clock sc, bit reset, clock rc);</FONT></P>
<DL>
	<DD>
	<TABLE WIDTH=284 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=39>
		<COL WIDTH=40>
		<COL WIDTH=179>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=179 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">SR(set,sc,reset,rc)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=39 HEIGHT=10 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">S<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">R<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=179 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=179 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">X</FONT></P>
				</TD>
				<TD WIDTH=179 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">X</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=179 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=179 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif">A version
with </FONT><FONT FACE="Liberation Sans, sans-serif">one set input
and</FONT><FONT FACE="Liberation Sans, sans-serif"> two reset </FONT><FONT FACE="Liberation Sans, sans-serif">input</FONT><FONT FACE="Liberation Sans, sans-serif">s
is provided (mainly to implement the full </FONT><FONT FACE="Courier, monospace"><B>SRT</B></FONT><FONT FACE="Liberation Sans, sans-serif">
mono-flop as a function block).</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>SRR</B>(bit set, clock sc, bit reset1, clock rc1, <BR>			
 bit reset2, clock rc2);</FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>SR</B></FONT>
flip-flop implemented in <I>iC</I> differs marginally from the
classical R-S flip-flop described in the literature, which has the
disadvantage that Qn+1 is undefined for R and S both &quot;one&quot;.
The design rules for the R-S flip flop state that R and S must never
be &quot;one&quot; together. Since this would cause unwarranted
confusion the implementation with the above truth table was chosen,
which gives identical results with designs following the rules of the
classical R-S flip-flop. If the rule of both inputs &quot;one&quot;
is ignored, the results are still easy to interpret. For the above
reasons clocked R-S flip-flops are rare as integrated circuits.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23179_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.5  Clocked JK
flip-flop</FONT></FONT></H2>
<P CLASS="western"><SPAN STYLE="font-style: normal">Instead </SPAN><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>JK</B></SPAN></FONT><SPAN STYLE="font-style: normal">
flip-flops were made in hardware. They toggle their output on every
clock pulse, when J and K are both &quot;one&quot;. In recent years
even these have not been listed in the IC data books. A </SPAN><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>JK</B></SPAN></FONT><SPAN STYLE="font-style: normal">
flip-flop has been implemented in</SPAN><I> iC</I>: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.21cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><FONT SIZE=2><SPAN STYLE="font-weight: normal">imm
bit </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>JK</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>(bit
set, bit reset, clock c);</FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><BR>equivalent
to    </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>SR</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>(set
&amp; ~Q, reset &amp; Q, c);</FONT></FONT></FONT></P>
<DL>
	<DD>
	<TABLE WIDTH=294 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=39>
		<COL WIDTH=40>
		<COL WIDTH=189>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">JK(set,sc,reset,rc)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=39 HEIGHT=10 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">J<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">K<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">~Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__7397_1090881298"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.6  Clocked
SRX flip-flop</FONT></FONT></H2>
<P CLASS="western" STYLE="font-style: normal">In practice the simple
clocked <FONT FACE="Courier, monospace"><B>SR</B></FONT> flip-flop
can be difficult to control under the following conditions:</P>
<P CLASS="western">A <FONT FACE="Courier, monospace">0/1</FONT> set
transition has occurred which sets the flip-flop and some time later
a <FONT FACE="Courier, monospace">0/1</FONT> reset transition occurs
which resets it, while set is still a <FONT FACE="Courier, monospace">1</FONT>.
Even if reset goes back to <FONT FACE="Courier, monospace">0</FONT>,
the set input is not active again until it goes back to <FONT FACE="Courier, monospace">0</FONT>
and then to <FONT FACE="Courier, monospace">1</FONT> again. This
works well in many situations, but can be counter intuitive. For this
reason the <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>SRX</B></SPAN></FONT>
flip-flop or the <FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal"><B>JK
</B></SPAN></FONT>flip-flop can be used more effectively.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN></FONT><FONT FACE="Courier, monospace"><B>SRX</B></FONT><FONT FACE="Courier, monospace">(bit
set, clock sc, bit reset, clock rc);</FONT><FONT FACE="Liberation Sans, sans-serif"><BR>
</FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal">equivalent
to    </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>SR</B></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>(set
&amp; ~reset,sc, reset &amp; ~set,rc);</FONT></FONT></FONT></P>
<DL>
	<DD>
	<TABLE WIDTH=294 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=39>
		<COL WIDTH=40>
		<COL WIDTH=189>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">set</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">reset</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: none; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0.1cm; padding-bottom: 0cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">SRX(set,sc,reset,rc)</FONT></P>
				</TD>
			</TR>
			<TR VALIGN=TOP>
				<TD WIDTH=39 HEIGHT=10 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">S<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">R<SUP>n</SUP></FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n+1</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0/1</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">Q<SUP>n</SUP></FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1\0</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">0</FONT></P>
				</TD>
			</TR>
		</TBODY>
		<TBODY>
			<TR VALIGN=TOP>
				<TD WIDTH=39 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
				<TD WIDTH=40 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1\0</FONT></P>
				</TD>
				<TD WIDTH=189 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
					<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.1cm; margin-right: 0.04cm">
					<FONT FACE="Courier, monospace">1</FONT></P>
				</TD>
			</TR>
		</TBODY>
	</TABLE>
</DL>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">When both set and reset are <FONT FACE="Courier, monospace">1</FONT>,
then both internal S and R inputs are <FONT FACE="Courier, monospace">0.</FONT>
If there is a <FONT FACE="Courier, monospace">1\0</FONT> transition
on either <FONT FACE="Courier, monospace">set</FONT> or <FONT FACE="Courier, monospace">reset</FONT>,
then the alternate input has a <FONT FACE="Courier, monospace">0/1</FONT>
transition, which sets or resets Q. 
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23183_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.7  D
flip-flop with Set and Reset</FONT></FONT></H2>
<P CLASS="western"><FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flops may have an optional reset input. Another option is to
have both a set and reset input as well as the D input. The names of
these variants indicate which parameters are required (clocks are
optional):</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>D</B>(  bit expr, clock c);	/* <I>simple D flip-flop</I>
*/<BR><SPAN STYLE="font-weight: normal">imm bit </SPAN><B>DR</B>( bit
expr, clock c, bit res, clock rc);<BR><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>DSR</B>(bit expr, clock c, bit set, clock sc,<BR>			bit
res, clock rc);</FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23185_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.8  Mono-Flop
ST(set, timer, delay) or SRT(set, reset, timer, delay)</FONT></FONT></H2>
<P CLASS="western">The Mono-Flop, or <FONT FACE="Courier, monospace"><B>ST</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">()</SPAN></FONT>
function is a modified <FONT FACE="Courier, monospace"><B>SR</B></FONT>
flip-flop, in which the output is internally connected back to a
timed reset input. This internal reset is usually clocked by a <FONT FACE="Courier, monospace"><B>TIMER,</B></FONT>
which is controlled by a delay parameter. The delay parameter may
have a fixed or variable numeric value. The <FONT FACE="Courier, monospace"><B>ST</B></FONT>
mono-flop output is reset, when the number of <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
ticks corresponding to the value of &quot;delay&quot;, from the
moment when the <FONT FACE="Courier, monospace"><B>ST</B></FONT> was
set, has occurred.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>ST</B>(bit set, clock sc, timer tim, int delay); or<BR><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>ST</B>(bit set, clock sc, clock tc);</FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>SRT</B></FONT>
mono-flop has an additional reset parameter, which can reset the
mono-flop prematurely. The <FONT FACE="Courier, monospace"><B>SRT</B></FONT>
mono-flop is based on the <FONT FACE="Courier, monospace"><B>SRR</B></FONT>
flip flop, which has two reset inputs.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
bit </SPAN><B>SRT</B>(bit set, clock sc, bit res, clock rc, clock
tc);</FONT></P>
<P CLASS="western">Instead of clocking with a delay <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>,
any clock may be used as the last parameter of the <FONT FACE="Courier, monospace"><B>ST</B></FONT>
mono-flop, which is then reset on the next clock pulse after it has
been set. The last timer, delay or clock must be specified – it may
be <FONT FACE="courier, monospace"><B>iClock</B></FONT> in which case
a thin pulse is produced - one fundamental clock period wide. Both
set (and reset in the case of <FONT FACE="Courier, monospace"><B>SRT)</B></FONT>
can have clock parameters – default is <FONT FACE="courier, monospace"><B>iClock</B></FONT>
if none are provided.</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23187_1582432481"></A><A NAME="3.9.  Sample and Hold|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.9  Sample and
Hold</FONT></FONT></H2>
<P CLASS="western">This function is a direct analogy of the clocked <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop for numeric values. The numeric output equals the numeric
input in the previous clock period. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
int </SPAN><B>SH</B>(int arithmeticValue, clock c);</FONT></P>
<P CLASS="western">The sample and hold function can be used to sample
fast changing numeric outputs at a constant clock rate. Other uses
are the implementation of many useful constructs such as state
machines, counters and shift registers, to name a few.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> count = </FONT><FONT FACE="Courier, monospace"><B>SH</B></FONT><FONT FACE="Courier, monospace">(count
+ 1, c);	// </FONT><FONT FACE="Courier, monospace"><I>count clock </I></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">c</SPAN></FONT><FONT FACE="Courier, monospace"><I>
pulses</I></FONT><FONT FACE="Courier, monospace"><BR>// </FONT><FONT FACE="Courier, monospace"><I>shift
register with </I></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-style: normal">b</SPAN></FONT><FONT FACE="Courier, monospace"><I>
as input in the least significant bit.</I></FONT><FONT FACE="Courier, monospace"><BR></FONT><FONT FACE="Courier, monospace"><B>imm
bit</B></FONT><FONT FACE="Courier, monospace"> b;			// b </FONT><FONT FACE="Courier, monospace"><I>assigned
somewhere else</I></FONT><FONT FACE="Courier, monospace"><BR></FONT><FONT FACE="Courier, monospace"><B>imm
int</B></FONT><FONT FACE="Courier, monospace"> shift = </FONT><FONT FACE="Courier, monospace"><B>SH</B></FONT><FONT FACE="Courier, monospace">((shift
&lt;&lt; 1) + b, c);</FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23189_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.10  Sample
and Hold with Set and Reset</FONT></FONT></H2>
<P CLASS="western">The Sample and Hold function also comes with
either reset or set and reset inputs. When the reset input is
clocked, the output is set to all 0's. By analogy when the set input
is clocked the output is set to all 1's. The inputs <FONT FACE="Courier, monospace">set</FONT>
and <FONT FACE="Courier, monospace">reset</FONT> are <FONT FACE="Courier, monospace"><B>imm
bit</B></FONT> expressions; whereas the first input <FONT FACE="Courier, monospace">arithmeticValue
</FONT>and the output are <FONT FACE="Courier, monospace"><B>imm int</B></FONT>.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
int </SPAN><B>SHR</B>( int arithmeticValue, clock c, bit res, clock
rc);<BR><SPAN STYLE="font-weight: normal">imm int </SPAN><B>SHSR</B>(int
arithmeticValue, clock c, bit set, clock sc,<BR>				bit res, clock
rc);</FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23191_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>4.11  Edge
detectors</FONT></FONT></H2>
<P CLASS="western">It is often useful to generate a pulse on the
rising and/or falling edge of a logical signal or on a change of
numeric value. These pulses should turn off at the next clock. In
connection with the <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop, expressions were shown which generate such pulses. Since
these operations are quite important, the following more efficient
functions are implemented in <I>iC</I>.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; font-weight: normal; page-break-inside: avoid">
<FONT FACE="Courier, monospace">imm bit <B>RISE</B>(bit expr, clock
c);	// <I>pulse on rising edge</I><BR>imm bit <B>FALL</B>(bit expr,
clock c);	// <I>pulse on falling edge</I> <BR>imm bit <B>CHANGE</B>(bit
expr, clock c);	// <I>pulse on both edges</I></FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>CHANGE</B></FONT>
function is also implemented for arithmetic expressions. The output
is nevertheless of type <FONT FACE="Courier, monospace"><B>imm bit</B></FONT>.
</P>
<P CLASS="western" STYLE="margin-left: 2.5cm; text-indent: -0.42cm; font-weight: normal">
<FONT FACE="Courier, monospace">imm bit <B>CHANGE</B>(int arithExpr,
clock c);	// <I>pulse on every change</I></FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>bit</B></FONT>
output pulses every time <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">arithExpr</SPAN></FONT>
changes, qualified by the clock <FONT FACE="Courier, monospace">c</FONT>.
The clock limits the rate at which changes are recognized. This is
often useful with numeric values, which may change at a high rate,
and a slower sampling rate is called for. 
</P>
<P CLASS="western">The pulse outputs of all edge detectors are just
long enough, so that they catch the next clock pulse after the edge,
but only that one clock pulse – not more. When the output of an
edge detector is used directly or indirectly as input of another
clocked function with the same clock, correct synchronization is
achieved.</P>
<P CLASS="western">Note: there is a significant difference between
the output of the <FONT FACE="Courier, monospace"><B>RISE</B></FONT>
function and the output of the <FONT FACE="Courier, monospace"><B>ST</B></FONT>
mono-flop. The output of the <FONT FACE="Courier, monospace"><B>RISE</B></FONT>
function turns on with the rising input signal and turns off again on
the next clock. The output of the mono-flop turns on with the next
clock after the set signal and turns off with the next clock after
that, which is one clock pulse later, assuming the same clock is used
for set and internal reset. When the two clocks are different, which
is usual for <FONT FACE="Courier, monospace"><B>ST</B></FONT>
mono-flops, the case is different again.</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<H1 CLASS="western"><A NAME="__RefHeading__23193_1582432481"></A><A NAME="5.    Clock Signals|outline"></A>
5    Clock Signals</H1>
<P CLASS="western">There are two types of clock signal, '<FONT FACE="Courier, monospace"><B>imm
clock</B></FONT>' and '<FONT FACE="Courier, monospace"><B>imm timer</B></FONT>'.
It is important to realize that clock signals are not of the same
type as logic or numeric signals of type '<FONT FACE="Courier, monospace"><B>imm
bit</B></FONT>' or '<FONT FACE="Courier, monospace"><B>imm int</B></FONT>'.
Clock signals are declared as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
clock</B> myClock;<BR><B>imm timer</B> myTimer;</FONT></P>
<P CLASS="western">Under no circumstances may clocks be
interconnected with logic or numeric signals. Any attempt to do so
generates an error message. Clock signals in <I>iC</I> are best
thought of as timeless pulses, whose occurrence marks the separation
of one clock period from the next along the time axis. All clocked
functions in <I>iC</I> follow the <I>Master-Slave</I> principle. The
<I>Master</I> element in a D flip-flop follows the input. The output
of this <I>Master</I> gate is transferred to the <I>Slave</I> element
during the active phase of the next clock pulse. The output of the
<I>Slave</I> element is the output of the D flip-flop. All
<I>Master-Slave</I> transfers during one particular clock pulse are
completed before more combinatorial bit or arithmetic expressions are
executed. This insures that the outputs of all functions, which are
synchronized by the same clock, change simultaneously as far as the
input logic is concerned.</P>
<P CLASS="western">Clock signals can come from four different
sources:</P>
<OL>
	<LI><P CLASS="western">The built-in <FONT FACE="Courier, monospace"><B>iClock</B></FONT>,
	which is signal type	<FONT FACE="Courier, monospace"><B>imm clock</B></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
	<FONT FACE="Courier, monospace"><B>CLOCK</B></FONT> function, which
	generates type	<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
	clock </B></FONT></FONT>
	</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
	<FONT FACE="Courier, monospace"><B>TIMER</B></FONT> function, which
	generates type	<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
	timer </B></FONT></FONT>
	</P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">The
	<FONT FACE="Courier, monospace"><B>TIMER1</B></FONT> function, which
	also generates type	<FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
	timer </B></FONT></FONT>
	</P>
</OL>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23195_1582432481"></A><A NAME="5.1.  Built-in immediate clock|outline"></A><A NAME="5.1.  Built-in immediate clock|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>5.1  Built-in
<I>immediate</I> clock</FONT></FONT></H2>
<P CLASS="western">There is a built-in <I>immediate</I> clock with
the name <FONT FACE="Courier, monospace"><B>iClock</B></FONT>. This
clock runs at the highest system rate. <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
is used as the default clock, when no other clock is specified. It
may also be specified by the name <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
when no default clock is allowed by the syntax of a function call.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">x
= <B>SR</B>(set, reset);	// <I>set and reset clocked by built-in</I>
<B>iClock</B></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; margin-bottom: 0.21cm; page-break-inside: avoid; widows: 2; orphans: 2">
<FONT FACE="Courier 10cpi"><FONT FACE="Courier, monospace">y =
</FONT><FONT FACE="Courier, monospace"><B>SR</B></FONT><FONT FACE="Courier, monospace">(set,
</FONT><FONT FACE="Courier, monospace"><B>iClock</B></FONT><FONT FACE="Courier, monospace">,
reset, rc);	// </FONT><FONT FACE="Courier, monospace"><I>clock for
the set argument</I></FONT><FONT FACE="Courier, monospace"><BR>				//
</FONT><FONT FACE="Courier, monospace"><I>must be named if
different</I></FONT><FONT FACE="Courier, monospace"><BR>				</FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>//
</FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><I>from
the reset clock rc</I></FONT></FONT></FONT></P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23197_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>5.2  CLOCK
function</FONT></FONT></H2>
<P CLASS="western">The second source of clock signals is the <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
function, which has one or two logic inputs – each with an optional
clock input. The <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
function produces an output <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
pulse during the active phase of the input clock, which follows a 0
to 1 transition of one of the logic inputs. If no <FONT FACE="Courier, monospace"><B>clock</B></FONT>
input is specified, <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
is used. All <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
outputs are synchronous with their input clock. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
clock </SPAN><B>CLOCK</B><SPAN STYLE="font-weight: normal">(bit in, 
clock c);	</SPAN>or<BR><SPAN STYLE="font-weight: normal">imm clock
</SPAN><B>CLOCK</B><SPAN STYLE="font-weight: normal">(bit in1, clock
c1, bit in2, clock c2);</SPAN></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
clock</B> clk = <B>CLOCK</B>(b);	// ‘clk‘ <I>on the rising edge
of</I> b<BR>			// <I>clocked by next</I> ‘iClock’<I>(default)</I><BR><B>imm
bit</B>   y   = <B>D</B>(a, clk);	// D <I>flip-flop clocked by</I>
‘clk’ <BR><B>imm clock</B> cl2 = <B>CLOCK</B>(b,<B>~</B>b);	//
<I>clock on rising and falling edge</I> 			// <I>of</I> b, <I>both
</I><I>clocked by</I> ‘iClock’</FONT></P>
<P CLASS="western"><IMG SRC="iC_html_b951a043.gif" ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 0cm; text-indent: 0cm; widows: 2; orphans: 2">
</H2>
<H2 CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="__RefHeading__23199_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>5.3  TIMER
function</FONT></FONT></H2>
<P CLASS="western">The third source of clock signals is the <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
function, which also has one or two logic inputs – each with an
optional <FONT FACE="Courier, monospace"><B>clock</B></FONT> input.
The output generated by the <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
function are of signal type <FONT FACE="Courier, monospace"><B>imm
timer</B></FONT> and are generated in precisely the same way and at
the same time as <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
pulses from a <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
function with the same inputs. <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulses differ from <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
pulses in the way they are used. Input parameters of type <FONT FACE="Courier, monospace"><B>timer</B></FONT>
are followed by an optional delay parameter, which may be a constant
value or an arithmetic expression (if missing a value of 1 is used).
The current value of the delay expression is read on the rising edge
or change of the associated input, and the result <FONT FACE="Courier, monospace"><FONT SIZE=2><B>n</B></FONT></FONT>
is used to count <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulses. The output is changed by the <FONT FACE="Courier, monospace"><FONT SIZE=2><B>n</B></FONT></FONT>'th
<FONT FACE="Courier, monospace"><B>timer</B></FONT> pulse after the
changing input. Use of a <FONT FACE="Courier, monospace"><B>clock</B></FONT>
rather than a <FONT FACE="Courier, monospace"><B>timer</B></FONT>
changes the output of a function on the next <FONT FACE="Courier, monospace"><B>clock</B></FONT>
after a change in input. If the delay value <FONT FACE="Courier, monospace"><FONT SIZE=2><B>n</B></FONT></FONT>
of a <FONT FACE="Courier, monospace"><B>timer</B></FONT> call is 0 -
or on the falling edge of a logic input for a function other than the
<FONT FACE="Courier, monospace"><B>SH</B></FONT>, <FONT FACE="Courier, monospace"><B>CHANGE</B></FONT>
or <FONT FACE="Courier, monospace"><B>switch</B></FONT> function -
the output is changed immediately by the next <FONT FACE="Courier, monospace"><B>iClock</B></FONT>.
For a <FONT FACE="Courier, monospace"><B>SH</B></FONT>, <FONT FACE="Courier, monospace"><B>CHANGE</B></FONT>
or <FONT FACE="Courier, monospace"><B>switch</B></FONT> function the
input is usually arithmetic and those functions are timed on all
changes of input, even if they are a logic input, which is possible
for the <FONT FACE="Courier, monospace"><B>CHANGE</B></FONT>
function.  
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
timer </SPAN><B>TIMER</B><SPAN STYLE="font-weight: normal">(bit in, 
clock c);	</SPAN>or<BR><SPAN STYLE="font-weight: normal">imm timer
</SPAN><B>TIMER</B><SPAN STYLE="font-weight: normal">(bit in1, clock
c1, bit in2, clock c2);</SPAN></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
timer</B> tim = <B>TIMER</B>(b);	// ‘tim‘ <I>on the rising edge
of</I> b<BR>			// <I>clocked by next</I> ‘iClock’<I>(default)</I><BR><B>imm
bit</B>   z   = <B>D</B><SPAN STYLE="font-weight: normal">(</SPAN>a,
tim, 3<SPAN STYLE="font-weight: normal">)</SPAN>;// D <I>flip-flop
clocked by</I> ‘tim‘,<BR>		// <I>turn on delayed by 3</I> ‘tim‘
<I>pulses</I>,<BR>		// <I>immediate turn off clocked by</I> ‘iClock‘
</FONT>
</P>
<P CLASS="western">The following diagram shows the behaviour of a
<FONT FACE="Courier, monospace"><B>TIMER</B></FONT> generated <FONT FACE="Courier, monospace"><B>timer</B></FONT>
for different length's of input <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>a</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT>
relative to the <FONT FACE="Courier, monospace"><B>timer</B></FONT>
<FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT><FONT FACE="Courier, monospace"><B>tim</B></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">'</SPAN></FONT>
pulses:</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid; page-break-before: always">
<BR><BR>
</P>
<P CLASS="western"><IMG SRC="iC_html_dedbccb6.gif" ALIGN=LEFT><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">A <FONT FACE="Courier, monospace"><B>D</B></FONT>
flip-flop clocked with a <FONT FACE="Courier, monospace"><B>timer
</B></FONT>produces a function with turn on delay. If the logic input
to such a delay element turns off before the delay time is up, the
output never turns on. This is a very useful function to implement
time-outs, which are notoriously difficult to implement by
conventional means.</P>
<H2 CLASS="western"><A NAME="__RefHeading__8480_2073158470"></A><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>5.4
 TIMER1 function</FONT></FONT></H2>
<P CLASS="western">The fourth source of clock signals is the <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT>
function, which is very similar to the normal <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
function. The signal type generated is <FONT FACE="Courier, monospace"><B>imm
timer</B></FONT> – the same as the type generated by a normal
<FONT FACE="Courier, monospace"><B>TIMER</B></FONT>. The only
difference is the way in which a 0 delay and the falling logic input
is handled, when a <FONT FACE="Courier, monospace"><B>timer</B></FONT>,
generated by the <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT>
function controls a clocked function. A 0 delay is handled like a
delay of 1 – turn on is at the next <FONT FACE="Courier, monospace"><B>timer</B></FONT>
pulse. On the falling edge of the input the output is clocked on the
next <FONT FACE="Courier, monospace"><B>timer</B></FONT> pulse,
rather than by the next <FONT FACE="Courier, monospace"><B>iClock</B></FONT>,
which is the case for <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
generated <FONT FACE="Courier, monospace"><B>timer</B></FONT> signals
unless the input is to an <FONT FACE="Courier, monospace"><B>SH</B></FONT>,
<FONT FACE="Courier, monospace"><B>CHANGE</B></FONT> or <FONT FACE="Courier, monospace"><B>switch</B></FONT>
function, in which case the falling edge is also timed – just like
for the <FONT FACE="Courier, monospace"><B>TIMER</B></FONT> function.
A <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT> generated
<FONT FACE="Courier, monospace"><B>timer</B></FONT>, used with a
delay of 1 (or 0), functions identically to a <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
generated <FONT FACE="Courier, monospace"><B>clock</B></FONT> signal,
except there is a small, but significant amount of overhead in
handling <FONT FACE="Courier, monospace"><B>timer</B></FONT> signals.
For this reason <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
functions are to be preferred – their use is very fast. 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">imm
timer </SPAN><B>TIMER1</B><SPAN STYLE="font-weight: normal">(bit in, 
clock c);	</SPAN>or<BR><SPAN STYLE="font-weight: normal">imm timer
</SPAN><B>TIMER1</B><SPAN STYLE="font-weight: normal">(bit in1, clock
c1, bit in2, clock c2);</SPAN></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
timer</B> ti1 = <B>TIMER1</B>(b);	// ‘ti1‘ <I>on the rising edge
of</I> b<BR>			// <I>clocked by next</I> ‘iClock’<I>(default)</I><BR><B>imm
bit</B>   z1  = <B>D</B>(a, ti1, 3);// D <I>flip-flop clocked by</I>
‘ti1‘,<BR>		// <I>turn on delayed by 3</I> ‘ti1‘ <I>pulses</I>,<BR>		//
<I>turn off clocked by next</I> ‘ti1‘ </FONT>
</P>
<P CLASS="western">The following diagram shows the different turn-off
handling for a <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT>
generated <FONT FACE="Courier, monospace"><B>timer</B></FONT> (in the
shaded area):</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><IMG SRC="iC_html_e25581be.gif" ALIGN=LEFT><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P ALIGN=LEFT STYLE="page-break-inside: avoid"><BR><BR>
</P>
<P CLASS="western"><FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>,
<FONT FACE="Courier, monospace"><B>TIMER</B></FONT> and <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT>
functions have optional clock inputs, which may come from other <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
or <FONT FACE="Courier, monospace"><B>TIMER</B></FONT> functions. All
<FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>, <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
or <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT> outputs are
synchronous with their input clock(s). This absolute synchronisation
is an important aspect of the robust performance of clocked <I>immediate
C</I> applications. The cascading of clocked functions allows the
realization of many useful applications. 
</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23203_1582432481"></A>
6    Inputs and Outputs</H1>
<H2 CLASS="western"><A NAME="__RefHeading__23205_1582432481"></A>6.1 
Built-in Inputs</H2>
<P CLASS="western">There are a number of inputs, which have such
universal significance, that they are implemented in the run time
system.</P>
<H3 CLASS="western"><A NAME="__RefHeading__23207_1582432481"></A>6.1.1
 iClock</H3>
<P CLASS="western"><SPAN LANG="en-GB">There is a built-in </SPAN><SPAN LANG="en-GB"><I>immediate</I></SPAN><SPAN LANG="en-GB">
clock with the name </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>iClock</B></SPAN></FONT><SPAN LANG="en-GB">.
This clock runs at the highest system rate. The name </SPAN><FONT FACE="Courier, monospace"><SPAN LANG="en-GB"><B>iClock</B></SPAN></FONT><SPAN LANG="en-GB">
is built-in and may be used as defined above in </SPAN><A HREF="#5.1.  Built-in immediate clock|outline"><SPAN LANG="en-GB">Section</SPAN></A><SPAN LANG="en-GB"><A HREF="#5.1.  Built-in immediate clock|outline">5.1</A>.</SPAN></P>
<P CLASS="western">Because secondary clocks either use <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
by default, or another clock that is eventually clocked by <FONT FACE="Courier, monospace"><B>iClock</B></FONT>,
all clocks (and timers) are synchronous with <FONT FACE="Courier, monospace"><B>iClock</B></FONT>.
The execution of <I>immediate</I> logic is triggered by some input,
which causes evaluation of follow up statements, until no more
changes occur. <FONT FACE="Courier, monospace"><B>iClock</B></FONT>
generates a clock pulse after every such burst of activity in the
logic. <FONT FACE="Courier, monospace"><B>iClock</B></FONT> has the
same significance for <I>immediate</I> logic as the end of the
program cycle in a conventional PLC. The main difference is, that for
a conventional PLC all statements are executed for each program
cycle. For <I>immediate</I> logic only the changes triggered by one
or at most a few simultaneous inputs are executed for each program
cycle. This typically takes a few microseconds at most for a modern
processor. There are support tools which can measure and display this
time in microseconds.</P>
<H3 CLASS="western"><A NAME="__RefHeading__10198_1097717954"></A>6.1.2
 End of Initialization</H3>
<P CLASS="western">The rising edge of <FONT FACE="Courier, monospace">TX0.0</FONT>
is guaranteed to be the first input to the system and can be used for
initializing user constructs. It is high for the remainder of the
program (forever as far as applications are concerned)</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">TX0.0	<FONT SIZE=2>EOI</FONT>,
off during initialization, then always on</FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__10200_1097717954"></A>6.1.3
 Notification of a received line of standard input</H3>
<P CLASS="western">Keyboard or other input received from standard
input (<FONT FACE="Courier, monospace"><FONT SIZE=2>stdin</FONT></FONT>)
causes an interrupt every time a line terminated by a carriage return
has been received. This interrupt causes <I>iC</I> input <FONT FACE="Courier, monospace"><FONT SIZE=2>TX0.1</FONT></FONT>
to pulse hi for one <FONT FACE="Courier, monospace"><FONT SIZE=2><B>iClock</B></FONT></FONT>
period. The data in the line is available in the global <I>C</I>
array <FONT FACE="Courier, monospace"><FONT SIZE=2>char
i</FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>C_stdinBuf[]</FONT></FONT>.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><FONT FACE="Courier, monospace"><SPAN LANG="en-GB">TX0.</SPAN></FONT>1<FONT FACE="Courier, monospace"><SPAN LANG="en-GB">	</SPAN></FONT>Notification
of a received line of standard input</FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__23211_1582432481"></A><A NAME="6.1.3.  Timing inputs|outline"></A>
6.1.4  Timing inputs</H3>
<P CLASS="western">To allow programs to work with real time, the
following timing inputs have been provided: 
</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">TX0.2	1
millisecond	// requires a 1 kHz Kernel<BR>TX0.3	10 milliseconds	//
standard 100 Hz Linux Kernel<BR>TX0.4	100 milliseconds	// for the
remaining timers<BR>TX0.5	1 second<BR>TX0.6	10 seconds<BR>TX0.7	60
seconds or 1 minute</FONT></P>
<P CLASS="western">These inputs can be used to generate clocks, which
are synchronous with real time. For example:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace"><B>imm
clock</B> clk100ms = <B>CLOCK</B>(TX0.4);	// every 100 milliseconds</FONT></P>
<H2 CLASS="western"><A NAME="__RefHeading__23213_1582432481"></A>6.2 
External Inputs and Outputs</H2>
<P CLASS="western">Input and Output names in <I>iC</I> follow the
IEC-1131 standard. Inputs start with the letter <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><B>I</B></FONT></FONT>,
outputs with the letter <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><B>Q</B></FONT></FONT>.
These are followed by a second letter which defines the type of the
input or output. <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><B>X</B></FONT></FONT>
defines a byte of 8 bit I/O variables. <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><B>B</B></FONT></FONT>
defines a numerical byte I/O variable, <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><B>W</B></FONT></FONT>
a 16 bit word I/O and <FONT FACE="Courier New, monospace"><FONT SIZE=2 STYLE="font-size: 11pt"><B>L</B></FONT></FONT>
a 32 bit long word I/O variable. The 2 capital letters are followed
by a number, which defines the address index of the variable in the
I/O field. <FONT COLOR="#000000"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>For
bit I/O variables the address is followed by a full stop and a number
in the range 0 to 7, marking the bit address of the actual bit
variable in the addressed I/O byte. </FONT></FONT></FONT>The maximum
address index that can be used depends on the implementation of the
driver and the underlying hardware. Addresses in the I/O field may be
used for bit, byte, word or long word I/O. If all of these are in the
same physical address space, care must be taken not to overlap
different types of I/O. In the case 16 and 32 bit word I/O variables
the byte addresses used must be on a 16 bit word or a 32 bit long
word boundary respectively. The <I>iC</I> compiler can generate
warnings if I/O fields overlap. In the default case, each size
variable is assumed to be in its own address space and the address of
each variable is simply in index into each of these address spaces.</P>
<H3 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23215_1582432481"></A>
6.2.1  Digital inputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IX0.0	bit
0 of input byte 0 - pre-declared as imm bit<BR>IX0.1	bit 1 of input
byte 0<BR>IX0.2	bit 2 of input byte 0<BR>IX0.3	bit 3 of input byte
0<BR>IX0.4	bit 4 of input byte 0<BR>IX0.5	bit 5 of input byte
0<BR>IX0.6	bit 6 of input byte 0<BR>IX0.7	bit 7 of input byte 0</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IX1.0	bit
0 of input byte 1<BR>IX1.1	bit 1 of input byte 1<BR>IX1.2	bit 2 of
input byte 1<BR>IX1.3	bit 3 of input byte 1<BR>IX1.4	bit 4 of input
byte 1<BR>IX1.5	bit 5 of input byte 1<BR>IX1.6	bit 6 of input byte
1<BR>IX1.7	bit 7 of input byte 1</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IX2.0	bit
0 of input byte 2<BR>IX2.1	bit 1 of input byte 2<BR>...</FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__23217_1582432481"></A>6.2.2
 Digital outputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX0.0	bit
0 of output byte 0 - pre-declared as imm bit<BR>QX0.1	bit 1 of output
byte 0<BR>QX0.2	bit 2 of output byte 0<BR>QX0.3	bit 3 of output byte
0<BR>QX0.4	bit 4 of output byte 0<BR>QX0.5	bit 5 of output byte
0<BR>QX0.6	bit 6 of output byte 0<BR>QX0.7	bit 7 of output byte 0</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX1.0	bit
0 of output byte 1<BR>QX1.1	bit 1 of output byte 1<BR>QX1.2	bit 2 of
output byte 1<BR>QX1.3	bit 3 of output byte 1<BR>QX1.4	bit 4 of
output byte 1<BR>QX1.5	bit 5 of output byte 1<BR>QX1.6	bit 6 of
output byte 1<BR>QX1.7	bit 7 of output byte 1</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX2.0	bit
0 of output byte 2<BR>QX2.1	bit 1 of output byte 2<BR>...</FONT></P>
<H3 CLASS="western"><A NAME="__RefHeading__23219_1582432481"></A>6.2.3
 Analog inputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IB3	input
byte 3 - pre-declared as imm int (8 bit input)<BR>IB4	input byte
4<BR>IB5	input byte 5<BR>IB6	input word 6<BR>IB7	input byte 7</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IW8	input
word 8			(16 bit input)<BR>IW10	input word 10<BR>IW12	input word
12<BR>IW14	input word 14</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">IL16	input
long 16			(32 bit input)<BR>IL20	input long 20<BR>IL24	input long
24<BR>IL28	input long 28<BR>...</FONT></P>
<H3 CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 100%; widows: 2; orphans: 2">
<BR><BR>
</H3>
<H3 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23221_1582432481"></A>
6.2.4  Analog outputs</H3>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QB3	output
byte 3 - pre-declared as imm int (8 bit output)<BR>QB4	output byte
4<BR>QB5	output byte 5<BR>QB6	output byte 6<BR>QB7	output byte 7</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QW8	output
word 8			(16 bit output)<BR>QW10	output word 10<BR>QW12	output word
12<BR>QW14	output word 14</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QL16	output
long 16			(32 bit output)<BR>QL20	output long 20<BR>QL24	output long
24<BR>QL28	output long 28<BR>...</FONT></P>
<P CLASS="western"><SPAN ID="Frame1" DIR="LTR" STYLE="float: left; width: 6.07cm; height: 5.12cm; border: 1px solid #000000; padding: 0.15cm; background: #ffffff">
	<P CLASS="frame-contents-western" ALIGN=CENTER STYLE="margin-bottom: 0cm; line-height: 100%">
	<IMG SRC="iC_html_4324c569.jpg" NAME="graphics7" ALIGN=LEFT WIDTH=219 HEIGHT=176 BORDER=0><BR CLEAR=LEFT><FONT SIZE=1 STYLE="font-size: 8pt"><I>iCbox</I></FONT></P>
</SPAN>The IEC-1131 names above define the physical addresses of
inputs and outputs in the I/O field. Standard practice for PLC I/O
electronics is to package I/O units in narrow plug in units, which
are labeled as shown on the right. The <I><B>iCbox</B></I> simulated
I/O widget emulates this scheme, showing the relationship of physical
addresses to their  IEC-1131 names.
</P>
<P CLASS="western">For more readable applications it is  highly
recommended, that alternate descriptive names are defined for
IEC-1131 input and output names. This would normally be done in a
table of alias assignments at the start of an <I>iC</I> program. One
advantage of this scheme is, that if an input or output is physically
moved to another I/O pin, only 1 statement in the source needs to be
changed. 
</P>
<P CLASS="western">It was common practice at one factory automation
company that I worked for in Australia to run large bunches of
unlabelled wires from plant switches and actuators to the PLC
connection field. The only identification was grey for inputs and
brown for outputs as well as some other colours for analog inputs and
outputs. All these wires were randomly terminated at the PLC. The
first action when commissioning was to activate each switch in the
plant and note which input came up at the programming unit. Similarly
for the outputs. Then an alias table was written into the program and
from then on everything worked according to the PLC program, which
was written in terms of descriptive I/O names. This procedure saved a
large amount of time of tedious labelling, which also tends to be
error prone.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit	waterLo, motorOn, heaterOn;<BR>imm int	waterTemp, motorSpeed;</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">waterLo	=
IX1.3;		// these statements define aliases<BR>waterTemp	= IB2;		//
which produce no run-time overhead</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">QX10.2	=
motorOn;	// here the IEC-1131 names are the<BR>QX10.3	= heaterOn;	//
aliases, which is appropriate<BR>QW8	= motorSpeed;	// for outputs</FONT></P>
<P CLASS="western">IEC-1131 I/O variable names are pre-declared as
immediate variables in <I>iC</I> program code, but they are not
defined in embedded <I>C</I> code. Only variables declared with an
<FONT FACE="Courier, monospace"><B>imm bit,</B></FONT> <FONT FACE="Courier, monospace"><B>imm
int,</B></FONT> <FONT FACE="Courier, monospace"><B>immC bit</B></FONT>
or <FONT FACE="Courier, monospace"><B>immC int</B></FONT> statement
are defined in <I>C</I> code as immediate variables. If I/O variables
must be accessed in <I>C</I> code the declared alternative alias
names must be used. This is another reason for defining descriptive
aliases for I/O variables early in the program design phase.</P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__23223_1582432481"></A><A NAME="7.    User defined immediate Function Blocks|outline"></A>
<FONT SIZE=4>7    User defined <I>immediate</I> Function Blocks</FONT></H1>
<P CLASS="western"><A NAME="function Blocks"></A>User defined
<I>immediate</I> functions are commonly called function blocks in the
PLC world, because they act more like functional blocks or templates
rather than functions in the instruction flow sense, where a function
evaluates a sequence of instructions whenever it is called. An
<I>immediate</I> Function Block is a separate <I>immediate</I>
subsystem with <I>immediate</I> parameters which are its inputs and
outputs from other section of the <I>immediate</I> system, optional
internal <I>immediate</I> variables, which must be declared inside
the Function Block and an optional <I>immediate </I>return value,
which may be used like any other immediate value – in an expression
– assigned to an immediate variable or used as an input parameter
in a built in function or function block call. Only standard IEC-1131
I/O variables may be used in a Function Block without being declared,
although they may only be used as inputs, since any assignment to an
I/O variable such as QX0.0 inside a Function Block would lead to a
multiple assignment, once the Function Block is used more than once.
Another way to look at an <I>immediate</I> Function Block is like a
higher level or LSI integrated circuit, which has connections into
the system and provides a certain complex functionality with many
internal components and connections.</P>
<H2 CLASS="western"><A NAME="__RefHeading__23225_1582432481"></A><A NAME="7.1.  immediate Function Block Definition|outline"></A>
7.1  immediate Function Block Definition</H2>
<P CLASS="western">An <I>immediate</I> Function Block must be defined
before it is used. Since the definition of a Function Block does not
itself generate any <I>C </I>Code on compilation it can be and
usually is defined with its code body in a header file, if multiple
source files are used for a project. For small projects with a single
source file Function Blocks can be defined at the start of the source
file.</P>
<P CLASS="western"><I>immediate</I> Function Block definitions are
very similar to <I>C </I>functions, although there are significant
differences in detail. The definition of an <I>immediate</I> Function
Block consists of a return value type, a Function Block name, a comma
separated parameter list in parentheses and a function body in curly
braces, e.g.</P>
<P CLASS="western" STYLE="margin-left: 1.98cm"><FONT FACE="Courier, monospace">imm
bit fall(bit f, clock c) { this = RISE(~f, c); }</FONT></P>
<P CLASS="western">The return value may be one of 5 types:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit<BR>imm int<BR>imm clock<BR>imm timer<BR>imm void	// <I>which
means no value is returned</I></FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>imm</B></FONT>
modifier is mandatory for the return type – it identifies an
immediate Function Block Definition syntactically. The Function Block
name can be any valid name starting with a letter followed by any
number of alphanumeric characters or underscores. A leading
underscore is possible, but should be avoided. The name must be
distinct from all other immediate variable names in a project. The
individual formal parameters in the parameter list must be of the
following 4 types:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit	// <I>or simply</I>	bit	// imm <I>is </I><I>implied</I><BR>imm
int	// <I>or</I>	int<BR>imm clock	// <I>or</I>	clock<BR>imm timer	//
<I>or</I>	timer</FONT></P>
<P CLASS="western">It is also possible to specify <FONT FACE="Courier, monospace"><B>immC
bit </B></FONT>and <FONT FACE="Courier, monospace"><B>immC int</B></FONT>
Arrays in the formal parameter list as follows:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">immC
bit bb[10]	// <I>or</I>	bit bb[10]	// immC <I>is </I><I>implied</I><BR>immC
int aa[]	// <I>or</I>	int aa[]	// <I>size </I><I>is </I><I>optional</I></FONT></P>
<P CLASS="western">The <FONT FACE="Courier, monospace"><B>imm</B></FONT>
modifier (or <FONT FACE="Courier, monospace"><B>immC</B></FONT> for
arrays) is optional for parameters in a parameter list. The variable
declared is nevertheless immediate. Parameters may be either input
value parameters, in which case only their type is written in the
list or the parameter may be an immediate output to which a value
from the Function Block is to be assigned. In this case the type of
the parameter must be preceded by the keyword <FONT FACE="Courier, monospace"><B>assign</B></FONT>.
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 2.05cm; line-height: 0.4cm; widows: 2; orphans: 2; page-break-before: auto">
<FONT FACE="Courier, monospace">assign imm bit	// <I>or</I>	assign
bit</FONT></P>
<P CLASS="western">Array parameters cannot be assigned. If the size
in square brackets is left out for an array parameter, that position
can be filled by an array of any size – there is one drawback –
no indexed array references to that array can be made in the <I>iC</I>
code of the Function Block.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The body of a Function Block is one or more immediate statements
defining the functionality of the block encoded in curly braces.
Immediate variables internal to the function must be declared before
use in the Function Block. Parameter names and internal variable
names are in a separate name space for each function block, which is
also separate form the global name space. If a Function Block is not
<FONT FACE="Courier, monospace"><B>imm void</B></FONT> the body must
contain a <FONT FACE="Sanserif PS"><FONT SIZE=2><I>return</I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>
</FONT></FONT>statement. The semantics of the  <FONT FACE="Sanserif PS"><FONT SIZE=2><I>return</I></FONT></FONT>
statement is the assignment to the variable to which the Function
Block is assigned, when it is called. This variable, which is
identified by the keyword <FONT FACE="Courier, monospace"><B>this</B></FONT>,
may be used in other expressions inside the Function Block. The
preferred way to write the <I>return</I> statements is:</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>this = <I>some + immediate +
expression</I>;	// preferred return syntax</B></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The <FONT FACE="Sanserif PS"><FONT SIZE=2>usual </FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2><I>C
</I></FONT></FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>syntax may
also be used, but does not make the action as clear:</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-left: 1.25cm; margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><B>return <I>some + immediate +
expression</I>;	// deprecated earlier syntax</B></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
The <I>return</I> statement need not be the last statement in the
Function Block definition – its position does not influence when it
is executed – that is controlled purely by changes in the values of
the variables making up the <I>return</I> statement – something
which holds for all <I>immediate</I> statements. This situation is
more clearly expressed by the assignment to <FONT FACE="Courier, monospace"><B>this</B></FONT>.
An <FONT FACE="Courier, monospace"><B>imm void</B></FONT><B> </B>Function
Block has no <FONT FACE="Courier, monospace"><B>this</B></FONT>
variable, may not contain a <FONT FACE="Sanserif PS"><FONT SIZE=2><I>return</I></FONT></FONT>
statement and may not be assigned when called. 
</P>
<P CLASS="western">Each <FONT FACE="Courier, monospace"><B>assign</B></FONT><B>
</B>parameter must be on the left side of an assignment statement in
the Function Block. The values of <FONT FACE="Courier, monospace"><B>assign</B></FONT>
parameters may be used inside the Function Block. Each variable
declared inside the Function Block must also be assigned in the
Function Block. Variables declared <FONT FACE="Courier, monospace"><B>extern</B></FONT>
outside or inside the Function Block may not be assigned to inside
the Function Block. As is the case with I/O variables (which are
implicitly extern). <FONT FACE="Courier, monospace"><B>extern</B></FONT>
variables may only be used as values inside the Function Block. They
may not be declared again as local inside the Function Block.
Variables declared <FONT FACE="Courier, monospace"><B>extern</B></FONT>
in a function may be declared after the definition of the Function
Block in the <I>iC</I> code following the definition. This declares
that the variable will be assigned in this module. A variable with
the same name as an <FONT FACE="Courier, monospace"><FONT SIZE=2><B>extern</B></FONT></FONT>
variable may be declared locally in another Function Block, but it is
a different formal variable local to that Function Block. 
</P>
<P CLASS="western">All <I>immediate</I> statement types –
assignments, <I><SPAN STYLE="font-weight: normal">if else</SPAN></I>,
<I><SPAN STYLE="font-weight: normal">switch</SPAN></I><SPAN STYLE="font-weight: normal">,</SPAN>
Built in Functions and other user defined Function Block calls may be
used in Function Block definitions. Function Blocks may be nested to
any depth as long as Function Blocks are used, which have been
previously defined. This implies that Function Blocks cannot be
called recursively, either directly or indirectly. Function Blocks
may be very simple one line definitions or complex systems with
hundreds of parameters. Several examples follow:</P>
<P CLASS="western">The SRX flip-flop is built into the compiler, but
defined in just this way during initialisation of the compiler. In
the latest version of the compiler, all but the most primitive built
ins, are defined as Function Blocks.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
SRX flip-flop defined as a function block */</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit srx(imm bit set, imm clock scl,<BR>	imm bit res, imm clock
rcl)<BR>{<BR>	this = SR(set &amp; ~res, scl, res &amp; ~set, rcl);<BR>}</FONT></P>
<P CLASS="western">The CountClk function adds '<FONT FACE="Courier, monospace">increment</FONT>'
to '<FONT FACE="Courier, monospace">this</FONT>' for every occurrence
of '<FONT FACE="Courier, monospace">clk</FONT>':</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
int CountClk(imm clock clk, imm int increment)<BR>{<BR>	this =
SH(this + increment, clk);<BR>}</FONT></P>
<P CLASS="western">The CountBit function adds '<FONT FACE="Courier, monospace">increment</FONT>'
to '<FONT FACE="Courier, monospace">this</FONT>' for every rising
edge of '<FONT FACE="Courier, monospace">step</FONT>':</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
int CountBit(imm bit step, imm int increment)<BR>{<BR>	this =
CountClk(CLOCK(step), increment); // nested call<BR>}</FONT></P>
<P CLASS="western">The SelectClk function selects either a 100 ms or
a 1 second clock with variable '<FONT FACE="Courier, monospace">second</FONT>':</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
clock SelectClk(imm bit second)<BR>{<BR>	this = CLOCK(TX0.4 &amp;
~second |	// 100 ms<BR>		TX0.5 &amp;  second );	// 1 second<BR>}</FONT></P>
<P CLASS="western">The following function block ADConvert assigns the
conversion of <FONT FACE="Courier, monospace">int val</FONT> to 8
<FONT FACE="Courier, monospace">assign bit</FONT> variables <FONT FACE="Courier, monospace">b0</FONT>
to <FONT FACE="Courier, monospace">b7</FONT> passed as parameters
(<FONT FACE="Courier, monospace">imm</FONT> is implied for value and
assign parameters).</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
Analog to digital conversion of a byte value */<BR>imm void
ADConvert(int val,		// input parameter<BR>		assign bit b0,	// output
parameters<BR>		assign bit b1,<BR>		assign bit b2,<BR>		assign bit
b3,<BR>		assign bit b4,<BR>		assign bit b5,<BR>		assign bit
b6,<BR>		assign bit b7,<BR>	)<BR>{<BR>	b0 = val &amp; (1 &lt;&lt;
0);	// assignments to outputs<BR>	b1 = val &amp; (1 &lt;&lt; 1);<BR>	b2
= val &amp; (1 &lt;&lt; 2);<BR>	b3 = val &amp; (1 &lt;&lt; 3);<BR>	b4
= val &amp; (1 &lt;&lt; 4);<BR>	b5 = val &amp; (1 &lt;&lt; 5);<BR>	b6
= val &amp; (1 &lt;&lt; 6);<BR>	b7 = val &amp; (1 &lt;&lt; 7);<BR>}</FONT></P>
<P CLASS="western">Note: the parameter list may have a trailing comma
before the closing parentheses. This is generally the case for comma
separated lists in <I>iC</I> and makes it easier to edit the lists
and copy parameters when written vertically, which is useful for
large parameter lists.</P>
<P CLASS="western">The <I>iC</I> compiler builds a template of the
Function Block, replacing each parameter and internally declared
variable by the name of the Function Block followed by a '@' and the
formal parameter or declared variable name. This strategy ensures a
private name space for each Function Block. When called, the template
is copied, with each formal parameter replaced by its real parameter
and internally declared variables replaced by the formal name with
the '@' replaced by an underscore '_' followed by an instance number
and another underscore. The instance number scheme ensures that there
is no clash of compiler generated variable names (even for separately
compiled modules).</P>
<H2 CLASS="western"><A NAME="__RefHeading__23227_1582432481"></A>7.2 
immediate Function Block Call</H2>
<P CLASS="western">An <I>immediate</I> Function Block is called in a
similar fashion to a <I>C </I>function, again with some significant
differences. In practice <I>immediate</I> Function Blocks are not
called. When the compiler encounters a Function Block call, the
pre-compiled Function Block, which is like a template, is copied,
with all calling parameters replacing the formal parameters in the
template. The resulting network of nodes will then be used at
run-time like the network of nodes produced from all other immediate
statements.</P>
<P CLASS="western">If an <FONT FACE="Courier, monospace"><B>imm void
</B></FONT>function is encountered it looks like a subroutine call:</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">ADConvert(IB1,<BR>	
    QX0.0, QX0.1, QX0.2, QX0.3,<BR>	     QX0.4, QX0.5, QX0.6,
QX0.7,<BR>	);</FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
This statement will assign bits 0 to 7 of <FONT FACE="Courier, monospace">IB1</FONT>
to <FONT FACE="Courier, monospace">QX0.0</FONT> to <FONT FACE="Courier, monospace">QX0.7
</FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>whenever </FONT></FONT><FONT FACE="Courier, monospace">IB1
</FONT><FONT FACE="Sanserif PS"><FONT SIZE=2>changes</FONT></FONT>.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
A Function Block with a return value <SPAN STYLE="font-weight: normal">must</SPAN>
either be assigned to a suitable variable or else it must be used as
a value of a suitable type in an expression or in a parameter list.
An <FONT FACE="Courier, monospace"><B>imm bit</B></FONT> Function
Block may be used as an <FONT FACE="Courier, monospace"><B>imm int</B></FONT>
value and vice versa – appropriate conversion takes place. <FONT FACE="Courier, monospace"><B>imm
clock</B></FONT> and <FONT FACE="Courier, monospace"><B>imm timer</B></FONT>
Function Blocks can either be assigned to correctly declared <FONT FACE="Courier, monospace"><B>clock</B></FONT>
or <FONT FACE="Courier, monospace"><B>timer</B></FONT> variables or
else used as a <FONT FACE="Courier, monospace"><FONT SIZE=2><B>clock</B></FONT></FONT>
or <FONT FACE="Courier, monospace"><FONT SIZE=2><B>timer</B></FONT></FONT>
value in a parameter list.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
<I>count every rise of</I> IX1.0 */<BR>imm int count =
CountBit(IX1.0, 1);</FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">/*
<I>selects 1 sec when</I> IX1.7 <I>is on else 100 ms</I> */<BR>imm
clock clk = SelectClk(IX1.7);</FONT></P>
<P CLASS="western">Real parameters of type <FONT FACE="Courier, monospace"><B>imm
int</B></FONT> and <FONT FACE="Courier, monospace"><B>imm bit</B></FONT>
may be mismatched with their formal parameter types – value and
assign parameters in the call will be forced to their formal type.
<FONT FACE="Courier, monospace"><B>assign</B></FONT> parameters of
type <FONT FACE="Courier, monospace"><B>imm clock</B></FONT> and <FONT FACE="Courier, monospace"><B>imm
timer</B></FONT> must match – so must a value parameter of type <FONT FACE="Courier, monospace"><B>imm
timer</B></FONT>. Real <FONT FACE="Courier, monospace"><FONT SIZE=2><B>immC</B></FONT></FONT>
Array parameters are only the name of a previously declared <FONT FACE="Courier, monospace"><FONT SIZE=2><B>immC</B></FONT></FONT>
Array of the same type as the formal parameter. The size must also
match unless the formal parameter did not specify a size.</P>
<P CLASS="western">The handling of formal  <FONT FACE="Courier, monospace"><B>imm
clock</B></FONT> parameters is more complex, allowing the use of
default clocks. Positions for formal <FONT FACE="Courier, monospace"><B>imm
clock</B></FONT> parameters which do not immediately follow another
formal clock parameter are handled as follows:</P>
<OL>
	<LI><P CLASS="western">The position may be filled by a real <FONT FACE="Courier, monospace"><B>imm
	clock</B></FONT> parameter.</P>
	<LI><P CLASS="western">The position may be filled by a real <FONT FACE="Courier, monospace"><B>imm
	timer</B></FONT> parameter followed by an optional <FONT FACE="Courier, monospace"><B>imm
	int</B></FONT> delay (if delay is left out it will be set to 1).</P>
	<LI><P CLASS="western">The position may be left out altogether, in
	which case the next clock or timer parameter on the right separated
	by at least one non clock parameter will be replicated for the
	position. If there is no real clock parameter following on the
	right, <FONT FACE="Courier, monospace"><B>iClock</B></FONT> will be
	used.</P>
</OL>
<P CLASS="western">On the other hand the second of two consecutive
formal clock parameters must be matched by a real clock or by a real
timer parameter optionally followed by an <FONT FACE="Courier, monospace"><B>imm
int</B></FONT> delay parameter. If the first of the formal clock pair
is not matched by a real clock or timer parameter, it and all
unmatched formal clock parameters to the left will be set to <FONT FACE="Courier, monospace"><B>iClock</B></FONT>.
</P>
<P CLASS="western">Real <FONT FACE="Courier, monospace"><B>timer</B></FONT>
parameters for formal <FONT FACE="Courier, monospace"><B>timer</B></FONT>
parameters cannot be extended by a delay – the delay used is
determined in the Function Block with delay(s) associated with the
use of the formal <FONT FACE="Courier, monospace"><B>timer</B></FONT>
parameter in the code of the Function Block. 
</P>
<P CLASS="western">These rules for optional clock parameters are the
same as for the clocked built-in functions <FONT FACE="Courier, monospace"><B>D</B></FONT>,
<FONT FACE="Courier, monospace"><B>SR</B></FONT>, <FONT FACE="Courier, monospace"><B>SRR</B></FONT>,
<FONT FACE="Courier, monospace"><B>SH</B></FONT>, <FONT FACE="Courier, monospace"><B>SH</B></FONT><FONT FACE="Courier, monospace"><B>R</B></FONT>,
<FONT FACE="Courier, monospace"><B>SH</B></FONT><FONT FACE="Courier, monospace"><B>SR</B></FONT>,
<FONT FACE="Courier, monospace"><B>RISE</B></FONT>, <FONT FACE="Courier, monospace"><B>CHANGE</B></FONT>,
<FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>, <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
and <FONT FACE="Courier, monospace"><B>TIMER1</B></FONT> as well as
for the <FONT FACE="Courier, monospace"><B>if</B></FONT> and <FONT FACE="Courier, monospace"><B>switch</B></FONT>
functions.</P>
<P CLASS="western">The following are calls of the <FONT FACE="Courier, monospace"><B>SRX()</B></FONT>
Function Block with two formal clock parameters – one each for set
and reset and the <FONT FACE="Courier, monospace"><B>ST()</B></FONT>
function block with two consecutive formal clock parameters – one
optional for set and the second a non optional delayed self reset
timer or clock.</P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
clock c = <B>CLOCK</B>(IX1.1), clk = <B>CLOCK</B>(IX1.2);<BR>imm
timer t = <B>TIMER</B>(IX1.3);<BR>imm bit s, r;<BR>imm bit m1 =
<B>SRX</B>(s, c, r, clk);	// <I>uses individual clocks</I><BR>imm bit
m2 = <B>SRX</B>(s, t, 3, r, t, 5);	// <I>individual timer delays</I><BR>imm
bit m3 = <B>SRX</B>(s, r, clk);		// <I>one clock for s and r</I><BR>imm
bit m4 = <B>SRX</B>(s, r, t, 5);	// <I>one timer for s and r</I><BR>imm
bit m5 = <B>SRX</B>(s, c, r);		// <I>default iClock for r</I><BR>imm
bit m6 = <B>SRX</B>(s, iClock, r, clk);	// <I>must specify iClock
here</I><BR>imm bit m7 = <B>SRX</B>(s, r);		// <I>default iClock for
both</I></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">imm
bit m8 = <B>ST</B>(s, c, t, 5);	// <I>clock c for s - t is not
optional</I><BR>			// <I>because it fills 2nd formal clock</I><BR>imm
bit m9 = <B>ST</B>(s, t, 5);	// <I>iClock for s - t is not optional</I></FONT></P>
<H2 CLASS="western"><A NAME="__RefHeading__7570_200243800"></A><A NAME="7.3.  Parcel Sorter|outline"></A>
7.3  Parcel Sorter</H2>
<P CLASS="western">The following example <FONT FACE="Courier, monospace"><B>sortm28.ica</B></FONT>
is a controller for a full scale application which required all the
space and speed resources of a PLC in the mid 80's. This project for
a parcel sorting system for the Australian Railways prompted the
author to look at alternate event driven systems for machine control.</P>
<P CLASS="western">The program is meant to control 4 high speed belts
moving at 5 metres/second generating independent strobe pulses for
every 15 mm movement of the belt. That means a strobe pulse every 3
ms. Each belt is normally equipped with 32 destination gates spaced
12 strobe pulse apart and open for 10 strobe pulses (in practice this
must be 72 strobe pulses or more).</P>
<P CLASS="western">This implementation was written as an <I>iCa</I>
language file, which can be scaled to any number of gates per belt.
As mentioned before, that code is fairly obscure and in coding this,
the <I>iC</I> code in the expanded version  <FONT FACE="Courier, monospace"><B>sortm28.ic</B></FONT>
was written first (for only 3 gates). The <I>iCa</I> version shows
the full use of <FONT FACE="Courier, monospace"><B>FOR</B></FONT>
loops, <FONT FACE="Courier, monospace"><B>IF ELSE</B></FONT> code
selection and Macros.</P>
<P CLASS="western">The compiled <I>iC</I> program <FONT FACE="Courier, monospace"><B>sortm28.ic</B></FONT>
shows a version with only 8 destination gates. It consists of 164
Gate nodes, 631 links and 5 <I>C</I> functions consisting mostly of 1
line of <I>C</I> code each. It makes use of the <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
clock function, which is meant to step the timer <FONT FACE="Courier, monospace"><B>tick</B></FONT>
for every increment of the belt (in the original parcel sorter this
was obtained from a toothed wheel on the drive shaft). <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>s
are very efficient, because parallel delays are handled
simultaneously by the one <FONT FACE="Courier, monospace"><B>TIMER</B></FONT>
by storing deltas in a list of timed events and counting down only
the delta at the head of the list. This can be seen in action in the
traces produced by GTKWave shown at the end of this example.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm; page-break-before: always">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Parcel
sorter control - using analog memory for destinations</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">use
strict;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%define
GATES		8		// number of gate destinations per belt</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%define
GATES_2		((GATES-1)/2)</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%define
GATE_OFFSET	12</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%define
GATE_FACTOR	&quot;34 / 3&quot;	// 11.333 no parentheses</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%define
GATE_OPEN	10</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Step
timer</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
timer tick = TIMER(TX0.4, ~TX0.4);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Destination
selection inputs</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(J = 0; (1&lt;&lt;J) &lt; GATES; J++) {{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit inp[J] =	IX[(1&lt;&lt;J)/8].[(1&lt;&lt;J)%8]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = (1&lt;&lt;J)+1; I &lt; GATES; I++) {{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	IF
(I &amp; (1&lt;&lt;J)) {{		// uses every 2nd input</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">[I%8
== ((1&lt;&lt;J)&amp;7) ? &quot; |\n\t\t&quot; : &quot; |
&quot;]IX[I/8].[I%8]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	}}\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}};</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit trans =	RISE(</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">		IX0.0\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = 1; I &lt; GATES; I++) {{[I%8==0?&quot; |\n\t\t&quot;:&quot; |
&quot;]IX[I/8].[I%8]}});</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Generate
analog value of destination</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int dest = [GATES &gt; 1 ? &quot;inp0&quot; : &quot;0&quot;]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(J = 1; 1&lt;&lt;J &lt; GATES; J++) {{ + inp[J]*[1&lt;&lt;J]}};	//
dest =</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Generate
delay along sorting belt.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	This
delay value changes every time one of the destination</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	selection
inputs 'IX0.0 - IX[(GATES-1)/8].[(GATES-1)%8]' is activated.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	This
delay is used to set a delay timer immediately.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	NOTE:
GATE_FACTOR_ can be a fractional factor by putting it in</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	double
quotes</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int del = GATE_OFFSET + dest * [GATE_FACTOR];	// del =</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	As
parcels travel along the sorting belt there have to be a</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	number
of simultaneous delay timers 'pt' - one for each group.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Worst
case is a delay timer per gate if parcels are all for</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	the
final destination and placed on the belt as fast as possible.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	A
timer should only be used, if the timers in the previous</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	groups
are already running. That makes simultaneous parallel</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	timers
for each parcel input possible. The same applies to the</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	logic
opening the gates, which may also happen simultaneously</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	if
several timers happen to finish simultaneously.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = 0; I &lt; GATES; I++) {{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt[I];</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr[I]  =	SR(trans &amp; ~tr[I]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(J = I-1; J &gt;= 0; J--) {{[J%8==7?&quot; &amp;\n\t\t&quot;:&quot; &amp;
&quot;]tr[J]}}, xt[I]);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt[I]  =	RISE(tr[I]);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt[I]  =	D(tr[I], tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt[I]
 =	tr[I] &amp; pt[I]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(J = I-1; J &gt;= 0; J--) {{[J%8==7?&quot; &amp;\n\t\t&quot;:&quot; &amp;
&quot;]~pt[J]}};</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma[I]  =	SH(dt[I] ? dest : ma[I]);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm; page-break-before: always">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Output
gates - selected via imm int busa and immC bit array openGate[]</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int busa =	xt[0] ? ma[0]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = 1; I &lt; GATES; I++) {{[I%4==0?&quot; :\n\t\t&quot;:&quot; :
&quot;]xt[I] ? ma[I]}} : 0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit trig =	xt[0]\</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = 1; I &lt; GATES; I++) {{[I%8==0?&quot; |\n\t\t&quot;:&quot; |
&quot;]xt[I]}};</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">immC
bit	openGate[[GATES]];</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">static
int	temp;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">if
(trig) {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">openGate[temp
= busa] = 1;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}
else {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">openGate[temp]
= 0;	/* temp is changed on the next rising trig */</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = 0; I &lt; GATES; I++) {{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate[I] = ST(openGate[[I]], tick, GATE_OPEN);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">FOR
(I = 0; I &lt; GATES; I++) {{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX[I/8].[I%8]
= gate[I];</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY>The compiled <I>iC</I> program
<FONT FACE="Courier, monospace"><B>sortm28.ic</B></FONT> shows a
version with only 8 destination gates. This code uses an <FONT FACE="Courier, monospace"><B>immC
bit</B></FONT> array <FONT FACE="Courier, monospace"><B>openGate[]</B></FONT>
to select the final gate opening mono-flops, which is very efficient.
The generated <I>C</I> code consists of 164 Gate nodes, 631 links and
5 <I>C</I> functions consisting mostly of 1 line of <I>C</I> code
each.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Parcel
sorter control - using analog memory for destinations</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">use
strict;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Step
timer</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
timer tick = TIMER(TX0.4, ~TX0.4);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Destination
selection inputs</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit inp0 =	IX0.1 | IX0.3 | IX0.5 | IX0.7;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit inp1 =	IX0.2 | IX0.3 | IX0.6 | IX0.7;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit inp2 =	IX0.4 | IX0.5 | IX0.6 | IX0.7;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit trans =	RISE(</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">		IX0.0
| IX0.1 | IX0.2 | IX0.3 | IX0.4 | IX0.5 | IX0.6 | IX0.7);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Generate
analog value of destination</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int dest = inp0 + inp1*2 + inp2*4;	// dest =</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Generate
delay along sorting belt.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	This
delay value changes every time one of the</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	destination
selection inputs 'IX0.0 - IX0.7' is activated.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	This
delay is used to set a delay timer immediately.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	NOTE:
GATE_FACTOR_ can be a fractional factor by putting it in</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	double
quotes</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int del = 12 + dest * 34 / 3;	// del =</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	As
parcels travel along the sorting belt there have to be a</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	number
of simultaneous delay timers 'pt' - one for each group.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Worst
case is a delay timer per gate if parcels are all for</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	the
final destination and placed on the belt as fast as possible.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	A
timer should only be used, if the timers in the previous</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	groups
are already running. That makes simultaneous parallel</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	timers
for each parcel input possible. The same applies to the</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	logic
opening the gates, which may also happen simultaneously</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	if
several timers happen to finish simultaneously.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr0  =	SR(trans &amp; ~tr0, xt0);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt0  =	RISE(tr0);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt0  =	D(tr0, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt0
 =	tr0 &amp; pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma0  =	SH(dt0 ? dest : ma0);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt1;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr1  =	SR(trans &amp; ~tr1 &amp; tr0, xt1);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt1  =	RISE(tr1);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt1  =	D(tr1, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt1
 =	tr1 &amp; pt1 &amp; ~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma1  =	SH(dt1 ? dest : ma1);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt2;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr2  =	SR(trans &amp; ~tr2 &amp; tr1 &amp; tr0, xt2);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt2  =	RISE(tr2);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt2  =	D(tr2, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt2
 =	tr2 &amp; pt2 &amp; ~pt1 &amp; ~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma2  =	SH(dt2 ? dest : ma2);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt3;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr3  =	SR(trans &amp; ~tr3 &amp; tr2 &amp; tr1 &amp; tr0, xt3);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt3  =	RISE(tr3);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt3  =	D(tr3, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt3
 =	tr3 &amp; pt3 &amp; ~pt2 &amp; ~pt1 &amp; ~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma3  =	SH(dt3 ? dest : ma3);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt4;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr4  =	SR(trans &amp; ~tr4 &amp; tr3 &amp; tr2 &amp; tr1 &amp;
tr0, xt4);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt4  =	RISE(tr4);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt4  =	D(tr4, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt4
 =	tr4 &amp; pt4 &amp; ~pt3 &amp; ~pt2 &amp; ~pt1 &amp; ~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma4  =	SH(dt4 ? dest : ma4);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt5;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr5  =	SR(trans &amp; ~tr5 &amp; tr4 &amp; tr3 &amp; tr2 &amp;
tr1 &amp; tr0, xt5);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt5  =	RISE(tr5);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt5  =	D(tr5, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt5
 =	tr5 &amp; pt5 &amp; ~pt4 &amp; ~pt3 &amp; ~pt2 &amp; ~pt1 &amp;
~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma5  =	SH(dt5 ? dest : ma5);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt6;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr6  =	SR(trans &amp; ~tr6 &amp; tr5 &amp; tr4 &amp; tr3 &amp;
tr2 &amp; tr1 &amp; tr0, xt6);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt6  =	RISE(tr6);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt6  =	D(tr6, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt6
 =	tr6 &amp; pt6 &amp; ~pt5 &amp; ~pt4 &amp; ~pt3 &amp; ~pt2 &amp;
~pt1 &amp; ~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma6  =	SH(dt6 ? dest : ma6);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit xt7;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit tr7  =	SR(trans &amp; ~tr7 &amp; tr6 &amp; tr5 &amp; tr4 &amp;
tr3 &amp; tr2 &amp; tr1 &amp; tr0, xt7);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit dt7  =	RISE(tr7);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit pt7  =	D(tr7, tick, del);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
        <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">xt7
 =	tr7 &amp; pt7 &amp; ~pt6 &amp; ~pt5 &amp; ~pt4 &amp; ~pt3 &amp;
~pt2 &amp; ~pt1 &amp; ~pt0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int ma7  =	SH(dt7 ? dest : ma7);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">/********************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*	Output
gates - selected via imm int busa and immC bit array openGate[]</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
 <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
int busa =	xt0 ? ma0 : xt1 ? ma1 : xt2 ? ma2 : xt3 ? ma3 :</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">		xt4
? ma4 : xt5 ? ma5 : xt6 ? ma6 : xt7 ? ma7 : 0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit trig =	xt0 | xt1 | xt2 | xt3 | xt4 | xt5 | xt6 | xt7;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">immC
bit	openGate[8];</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">static
int	temp;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">%}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">if
(trig) {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">openGate[temp
= busa] = 1;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}
else {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
    <FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">openGate[temp]
= 0;	/* temp is changed on the next rising trig */</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">}</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate0 = ST(openGate[0], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate1 = ST(openGate[1], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate2 = ST(openGate[2], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate3 = ST(openGate[3], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate4 = ST(openGate[4], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate5 = ST(openGate[5], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate6 = ST(openGate[6], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">imm
bit gate7 = ST(openGate[7], tick, 10);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.0
= gate0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.1
= gate1;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.2
= gate2;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.3
= gate3;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.4
= gate4;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.5
= gate5;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.6
= gate6;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">QX0.7
= gate7;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">The
following are the 5 generated <I>C</I> code fragments. The macro
<FONT FACE="Courier, monospace">iC_MV(1) </FONT>accesses  a logical
value on the generated link array. Fragment (5) are the two <I>C</I>
code snippets for the <FONT FACE="Courier, monospace"><B>if</B></FONT>
part and the <FONT FACE="Courier, monospace"><B>else</B></FONT> part.
<FONT FACE="Courier, monospace">iC_LAI(</FONT><FONT FACE="Courier, monospace"><FONT SIZE=2>2,
temp = iC_AV(3) , 0,  1</FONT></FONT><FONT FACE="Courier, monospace">)
</FONT>performs an indexed assignment to a logical <FONT FACE="Courier, monospace"><B>immC</B></FONT>
variable (2), which is <FONT FACE="Courier, monospace"><B>openGate[]</B></FONT>,
which is indexed by <FONT FACE="Courier, monospace">iC_AV(3)</FONT>,
which gets an analog value from (3), which is <FONT FACE="Courier, monospace"><B>busa</B></FONT>
(and which is also assigned to <FONT FACE="Courier, monospace"><B>temp</B></FONT>).
The last number <FONT FACE="Courier, monospace"><B>1</B></FONT> is
the logical value assigned – thereby setting the <FONT FACE="Courier, monospace"><B>ST()</B></FONT>
mono-flop for the selected gate. It is <FONT FACE="Courier, monospace"><B>0</B></FONT>
in the <FONT FACE="Courier, monospace"><B>else</B></FONT> part.</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="line-height: 0.4cm">One can
see from this that even for <FONT FACE="Courier, monospace"><B>int</B></FONT>
nodes the execution time for one event is going to be no more than a
few microseconds.</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">*******
C CODE          ************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">124</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">125	
   static int	temp;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">126</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	#line
202 &quot;init.c&quot;	/* in pre-compiled function block SHR */</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">202	(1)
	return iC_MV(1)?iC_MV(2):iC_MV(3);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">	#line
32 &quot;sortm28.ic&quot;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">032	(2)
	return iC_MV(1)+iC_MV(2)*2+iC_MV(3)*4;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">042	(3)
	return 12+iC_MV(1)*34/3;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">118	(4)
	return iC_MV(1)?iC_MV(2):iC_MV(3)?iC_MV(4):iC_MV(5)?iC_MV(6):</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">118	
       iC_MV(7)?iC_MV(8):iC_MV(9)?iC_MV(10):iC_MV(11)?iC_MV(12):</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">118	
       iC_MV(13)?iC_MV(14):iC_MV(15)?iC_MV(16):0;</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">128	(5)
{</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">129	
   iC_LAI(2, temp = iC_AV(3) , 0,  1);</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">130	
   }</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">130	
   {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">131	
   iC_LAI(2, temp , 0,  0);	/* temp is changed on the next rising
trig */</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">132	
   }</FONT></FONT></P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western">To start <FONT FACE="Courier, monospace"><B>sortm28</B></FONT>
to produce VCD files execute the following on the command line: 
ctrl-C when done</P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; margin-bottom: 0cm; line-height: 0.32cm">
<FONT FACE="Courier, monospace"><B>iCserver</B> -kr '<B>sortm28</B>
-v sortm28.vcd' '<B>iCbox</B> <B>IX0</B>,,250 <B>QX0</B>'</FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; line-height: 0.32cm">
<BR>
</P>
<P CLASS="western"><IMG SRC="iC_html_a692a283.jpg" NAME="graphics9" ALIGN=LEFT WIDTH=611 HEIGHT=479 BORDER=0><BR CLEAR=LEFT><FONT FACE="Liberation Sans, sans-serif">This
also starts an iCb</FONT><FONT FACE="Courier, monospace"><B>ox wi</B></FONT><FONT FACE="Liberation Sans, sans-serif">th
8</FONT><FONT FACE="Courier, monospace"><B> digi</B></FONT><FONT FACE="Liberation Sans, sans-serif">tal
inputs IX0.0 - IX0.7, which in this case are push-buttons with a 250
ms turn-off delay. They only need to be clicked to send a 250 ms
o</FONT><FONT FACE="Courier, monospace"><B>n/off</B></FONT><FONT FACE="Liberation Sans, sans-serif">
</FONT><FONT FACE="Courier, monospace"><B>pulse</B></FONT><FONT FACE="Liberation Sans, sans-serif">
to t</FONT><FONT FACE="Courier, monospace"><B>he ap</B></FONT><FONT FACE="Liberation Sans, sans-serif">plication.
 It also impleme</FONT><FONT FACE="Courier, monospace"><B>nts </B></FONT><FONT FACE="Liberation Sans, sans-serif">8
dig</FONT><FONT FACE="Courier, monospace"><B>ita</B></FONT><FONT FACE="Liberation Sans, sans-serif">l
ou</FONT><FONT FACE="Courier, monospace"><B>tpu</B></FONT><FONT FACE="Liberation Sans, sans-serif">ts
QX0.0 – QX0.7. The iCbox man-page prov</FONT><FONT FACE="Courier, monospace"><B>ide</B></FONT><FONT FACE="Liberation Sans, sans-serif">s
more details for confi</FONT><FONT FACE="Courier, monospace"><B>gur</B></FONT><FONT FACE="Liberation Sans, sans-serif">ing
</FONT><FONT FACE="Courier, monospace"><B>pus</B></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">h-buttons,
which were only introduced with version 1.</SPAN></FONT><FONT FACE="Courier, monospace"><B>31.	<BR><BR></B></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">Each
input starts a timer varying from 12 ticks for IX0.0 to 91 ticks for
IX0.7. At the end of their respective timer delays the outputs QX0.0
to QX0.7 will turn on for 10 ticks.</SPAN></FONT></FONT></P>
<P CLASS="western"><IMG SRC="iC_html_f3c5a020.jpg" NAME="graphics8" ALIGN=LEFT WIDTH=611 HEIGHT=479 BORDER=0><BR CLEAR=LEFT><FONT FACE="Liberation Sans, sans-serif"><I><SPAN STYLE="font-weight: normal">Fig.
1	</SPAN></I></FONT><FONT FACE="Liberation Sans, sans-serif"><I><B>GTKWave</B></I></FONT><FONT FACE="Liberation Sans, sans-serif"><I><SPAN STYLE="font-weight: normal">
traces of all nodes of</SPAN></I></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT FACE="Courier, monospace"><B>sortm28.ic</B></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">
with </SPAN></FONT><FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">gtkwave
sortm25.vcd sortm25.sav</SPAN></FONT></P>
<P CLASS="western">For this set of traces IX0.7 to IX0.0 were clicked
one after the other so that the respective delays caused the outputs
to turn on nearly simultaneously. At the top we can see IX0.2 IX0.1
and IX0.0 transferring 2 1 and 0 to dest and ma5 to ma7 and the
computed delays 34 28 and 12 to del. This starts delays in tr5 to
tr7. When the delays terminate they are transferred via
openGate[busa] to start the output delays gate0 to gate7, which are
aliased by QX0.0 to QX0.7.</P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="__RefHeading__23229_1582432481"></A><A NAME="DDE_LINK2211"></A><A NAME="8.    The iC run-time model|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><B>8    The <I>iC</I>
run-time model</B></FONT></FONT></H1>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>The
<I>iC</I> compiler <I><B>immcc</B></I> parses the statements of an <I>iC</I>
source, e.g. <B>example.ic</B> and produces a <I>C</I> file <B>example.c</B>
and optionally a listing file <B>example.lst</B>. The <I>C</I> file
is compiled by a <I>C</I> compiler to produce <B>example.o</B>
(<B>example.obj</B> under Windows), which is linked with the <I>iC</I>
runtime library <I><B>libict.so</B></I> (or <I><B>libict.a</B></I>)
to produce an executable <B>example</B> (<B>example.exe</B> under
Windows). </FONT></FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>*********************</FONT>
SOURCE example.ic <FONT SIZE=2>*********************</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><B>imm
bit</B> a = IX0.0 &amp; ~IX0.1 | ~IX0.0 &amp; IX0.1;</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace">QX0.0
= a;</FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
bit</B> b = IX0.2 ^ IX0.3;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
bit</B> d = ~IX0.2 &amp; ~IX0.3;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2><B>imm
bit</B> mem = <B>LATCH</B>(b, d);</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>QX0.1
= mem;</FONT> </FONT>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>*********************
LISTING example.lst *******************</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>001	<B>imm
bit a =  IX0.0 &amp; ~IX0.1 | ~IX0.0 &amp;  IX0.1;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	a_1
      ---|  a</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	a_2
      ---|</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.0
    ---&amp;  a_1</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.1
  ~ ---&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.0
  ~ ---&amp;  a_2</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.1
    ---&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>002	<B>QX0.0
= a;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	a
        ---|  QX0.0 X</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>003	<B>imm
bit b =  IX0.2 ^  IX0.3;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.2
    ---^  b</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.3
    ---^</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>004	<B>imm
bit d = ~IX0.2 &amp; ~IX0.3;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.2
  ~ ---&amp;  d</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	IX0.3
  ~ ---&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>005	<B>imm
bit mem = LATCH(b, d);</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	mem
      ---%  mem</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	b
        ---%</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	d
      ~ ---%         *</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>006	<B>QX0.1
= mem;</B></FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>	mem
      ---|  QX0.1 X</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>*******
NET TOPOLOGY ****************************************</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.0
  &lt;    ~a_2&amp;    a_1&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.1
  &lt;     a_2&amp;   ~a_1&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.2
  &lt;     b^     ~d&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>IX0.3
  &lt;     b^     ~d&amp;</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>QX0.0
  |  X</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>QX0.1
  |  X</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>a
      |     QX0.0|</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>a_1
    &amp;     a|</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>a_2
    &amp;     a|</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>b
      ^     mem%</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>d
      &amp;    ~mem%  *</FONT></FONT></P>
<P CLASS="western" STYLE="margin-bottom: 0cm; font-weight: normal"><FONT FACE="Courier, monospace"><FONT SIZE=2>mem
    %     mem%    QX0.1|</FONT></FONT></P>
<P CLASS="western"><IMG SRC="iC_html_16e7567.gif" ALIGN=LEFT><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><I>Fig. 2	Graph representation of the iC program
<B>example.ic</B></I></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>********************* C
OUTPUT CODE example.c **********************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>static Gate *	l_[];</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/*******************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*	Gate list</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_0    = { 1, 
INPX,  GATE, 0, &quot;IX0.0&quot;, 0, 0,       0      };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_1    = { 1, 
INPX,  GATE, 0, &quot;IX0.1&quot;, 0, 0,       &amp;IX0_0 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_2    = { 1, 
INPX,  GATE, 0, &quot;IX0.2&quot;, 0, 0,       &amp;IX0_1 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate IX0_3    = { 1, 
INPX,  GATE, 0, &quot;IX0.3&quot;, 0, 0,       &amp;IX0_2 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate QX0_0    = { 1, 
OR,    OUTX, 0, &quot;QX0.0&quot;, 0, &amp;l_[0],  &amp;IX0_3 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate QX0_1    = { 1, 
OR,    OUTX, 0, &quot;QX0.1&quot;, 0, &amp;l_[3],  &amp;QX0_0 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate a        = { 1, 
OR,    GATE, 0, &quot;a&quot;,     0, &amp;l_[6],  &amp;QX0_1 };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate a_1      = { 1, 
AND,   GATE, 0, &quot;a_1&quot;,   0, &amp;l_[10], &amp;a     };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate a_2      = { 1, 
AND,   GATE, 0, &quot;a_2&quot;,   0, &amp;l_[14], &amp;a_1   };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate b        = { 1, 
XOR,   GATE, 0, &quot;b&quot;,     0, &amp;l_[18], &amp;a_2   };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate d        = { 1, 
AND,   GATE, 0, &quot;d&quot;,     0, &amp;l_[22], &amp;b     };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>Gate mem      = { 1, 
LATCH, GATE, 0, &quot;mem&quot;,   0, &amp;l_[26], &amp;d     };</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/*******************************************************************</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*	Connection lists</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
 <FONT FACE="Courier, monospace"><FONT SIZE=2>*******************************************************************/</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>static Gate *	l_[] = {</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* QX0.0 */	&amp;a,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* QX0.1 */	&amp;mem,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* a
*/	&amp;a_2,	&amp;a_1,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* a_1
*/	&amp;IX0_0,	0,	&amp;IX0_1,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* a_2
*/	&amp;IX0_1,	0,	&amp;IX0_0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* b
*/	&amp;IX0_3,	&amp;IX0_2,	0,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* d
*/	0,	&amp;IX0_3,	&amp;IX0_2,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>/* mem
*/	&amp;mem,	&amp;b,	0,	&amp;d,	0,</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0cm; font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>};</FONT></FONT></P>
<P CLASS="western">The <I>C</I> output of the <I><B>immcc</B></I>
compiler consists mainly of initialised data definitions, which
describe a directed graph of vertices or nodes and edges joining the
nodes. Each node of this graph corresponds to an expression in the <I>iC</I>
program - they are called Expression nodes. The graph produced by the
compiler is directed towards the inputs, which are called sources in
graph theory (see Fig 2 above). This means that a list of the inputs
to each Expression is associated with a particular Expression node.
These are the edges of the graph. This direction represents the way
in which expressions are usually evaluated in a procedural strategy
following the flow of instructions – consecutive instructions read
the values of all input variables of an expression and arithmetic or
bit operators, acting on adjacent operands, determine the result.
Programmers are used to think about expressions this way.</P>
<P CLASS="western"><B>The run-time model for </B><I><B>iC</B></I><B>
is best visualized by thinking of expressions as  </B><B>digital</B><B>
or analog IC components, interconnected as in the above graph</B>.
The listing file represents all Expression nodes generated by the
compiler in this way (see LISTING above). Each time the output of one
of these components changes, that change will act on any inputs to
which that output is connected.</P>
<P CLASS="western">For <I>immediate C</I>, the compiled graph, whose
edges point towards the inputs of each node, is loaded into memory
and as a first step, all edges are reversed. This means, that each
Expression node is associated with a list of follow on Expression
nodes, for which the current Expression result is an input. What this
means is, that when a particular Expression node changes its value,
then all the expressions for the Expression nodes on its target list
should be re-evaluated (see NET TOPOLOGY above)</P>
<H2 CLASS="western"><A NAME="__RefHeading__23231_1582432481"></A>8.1 
Combinatorial immediate actions</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Combinatorial
<I>immediate</I> actions are the evaluation of arithmetic or bit
expressions, which excludes the full evaluation of any embedded
clocked functions. Expressions contain <I>immediate</I> variables
combined with operators, which describe a (possibly) changed result
when an input variable to the expression changes. Although the
evaluation of an expression takes a certain (small) amount of time –
both for hardware IC's and for <I>iC</I> expressions, conceptually we
are dealing with a mathematical statement, whose evaluation describes
a change of state – an operation, which does not necessarily take
any time. One completed scan of the combinatorial action list is such
a conceptually timeless combinatorial set of state-changing actions.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>To
implement this scheme, the <I>iC</I> run-time uses Expression nodes,
which can be linked into action lists and which store the old value
of the node – that is the value before the expression is
re-evaluated - as well as the new value after re-evaluation. If these
values are equal after a change of input and re-evaluation, no
further action is taken – follow on nodes will not change either,
because of this particular change of input. If the new value is
different from the old value, the Expression node is said to “fire”
(a term borrowed from Petri Nets). When this happens, the Expression
node is linked to the end of an action list. While on an action list,
the old and new values are kept in the node. Arithmetic nodes are
implemented like this – each node is associated with an arithmetic
expression, which is evaluated as a snippet of <I>C</I> code, each
time one of it's inputs changes.</FONT></FONT></P>
<P CLASS="western" STYLE="font-weight: normal"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Bit
expression nodes are implemented differently. Each logical GATE node
implements just one bit expression of type AND, OR, XOR or LATCH.
(GATEs of type LATCH implement the single gate FORCE function). The
algorithm used for AND, OR and LATCH GATEs is majority logic. In
majority logic, the number of '1' inputs on a gate are counted. If
this number exceeds a certain threshold, the output is '1' –
otherwise it is '0'. The only difference between the AND, OR and
LATCH function is the threshold. This means, that for all three types
of GATEs, only the initialisation of the threshold is different –
the same counting operation at run-time holds for all three. <B>This
algorithm is very similar to biological neurons</B>, which prompted
the idea.</FONT></FONT></P>
<DL>
	<DD>
	<TABLE WIDTH=507 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=15>
		<COL WIDTH=16>
		<COL WIDTH=16>
		<COL WIDTH=41>
		<COL WIDTH=110>
		<COL WIDTH=119>
		<COL WIDTH=131>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">a</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">b</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">c</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">'1' count</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">OR</FONT></P>
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				 <FONT FACE="Courier, monospace">threshold 1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">AND</FONT></P>
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				 <FONT FACE="Courier, monospace">threshold 3</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">LATCH</FONT></P>
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				 <FONT FACE="Courier, monospace">threshold 2</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="2" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">2</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="2" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">2</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="2" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">2</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=15 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=16 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=41 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="3" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">3</FONT></P>
			</TD>
			<TD WIDTH=110 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=119 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=131 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
	</TABLE>
</DL>
<P CLASS="western" STYLE="font-weight: normal"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>For
the OR function, the threshold is always 1, no matter how many inputs
the GATE has. Only when no inputs (&lt;1) are '1' is the output '0' –
otherwise it is always '1'.</FONT></FONT></P>
<P CLASS="western" STYLE="font-weight: normal"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>For
the AND function, the threshold is set to the number of inputs the
GATE has. When all inputs are '1' the output is '1' – otherwise it
is '0' (at least one input is '0').</FONT></FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-weight: normal">The
three input FORCE function described in <A HREF="#4.2.  FORCE function|outline">section
4.2</A> is shown here in more detail and with the 'off' input
inverted.</SPAN></SPAN></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 2.03cm; page-break-inside: avoid"><FONT FACE="Courier, monospace">FORCE(arg1,
on, ~off) </FONT>
</P>
<DL>
	<DD>
	<TABLE WIDTH=293 CELLPADDING=4 CELLSPACING=0>
		<COL WIDTH=36>
		<COL WIDTH=28>
		<COL WIDTH=36>
		<COL WIDTH=158>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">arg1</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">on</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">~off</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: 0.80pt solid #000000; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">FORCE(arg1,on,~off)</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0.1cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: 1px solid #000000; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="0" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">0</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 1px solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm" SDVAL="1" SDNUM="2057;">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
		<TR VALIGN=TOP>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 0.80pt solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=28 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=36 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: none; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
			<TD WIDTH=158 BGCOLOR="#ffff99" STYLE="border-top: none; border-bottom: 0.80pt solid #000000; border-left: 1px solid #000000; border-right: 0.80pt solid #000000; padding-top: 0cm; padding-bottom: 0.1cm; padding-left: 0.1cm; padding-right: 0.1cm">
				<P CLASS="western" ALIGN=CENTER STYLE="margin-left: -0.08cm; margin-right: 0.03cm">
				<FONT FACE="Courier, monospace">1</FONT></P>
			</TD>
		</TR>
	</TABLE>
</DL>
<P CLASS="western" STYLE="font-weight: normal"><BR><BR>
</P>
<P CLASS="western" STYLE="font-weight: normal"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>This
is the same truth-table as the 3 input majority LATCH GATE with a
threshold of 2. Only the 'off' input needs to be inverted.</FONT></FONT></P>
<P CLASS="western" STYLE="font-weight: normal"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Each
GATE node has a signed byte member gt_val, which counts input changes
and provides the logic output. The sign bit of gt_val is the bit
value of the output. Thus -1, -2, -3 … -127 are all a '1'
output.<BR>+1, +2, +3 … +127 are all a '0' output. These values are
normalised to -1 for '1' and +1 for '0' when doing majority logic.
Because of this counting algorithm with a signed byte, the number of
inputs to simple AND and OR GATEs are limited to 127. (Should more
inputs be required a final post-processor of the compiler splits
those large GATEs into several smaller ones). GATEs are initialised,
so that all inputs are logically '0' and gt_val is initialised to +1
for OR gates, +n for AND gates (where n is the number of inputs) and
+2 for LATCH gates (where the number of inputs is always 3). Since
all inputs and outputs are thus initially '0' they can only change to
'1'. A change to '1' causes the numerical value of '1' – namely -1
to be added to gt_val of the target. If this change causes gt_val to
be 0, the gate is said to fire. This results in the numeric value
being added again resulting in gt_val now being -1 and the master
GATE action being executed. For GATE nodes the master action is
simply linking the node, which holds the updated logical value in
gt_val to the output list. This propagates the change in bit value.
The following very compact piece of code implements this algorithm:</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm; widows: 2; orphans: 2">
<FONT FACE="Courier, monospace"><FONT SIZE=2>if ((gp-&gt;gt_val +=
val) == 0) {              /* gate function */<BR>    gp-&gt;gt_val =
val;                        /* step past 0 */<BR>   
(*masterAct[gp-&gt;gt_fni])(gp, iC_o_list); /* master action */<BR>}</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>To
implement logical inversion each logical GATE node has two null
terminated target lists – the first list is for actions which are
non-inverting – the second list is for actions which are inverting.
Before the second list is scanned, the source logic value is inverted
by negating val from +1 to -1 or -1 to +1 and adding this negated
value. Arithmetic nodes have only one null terminated target list.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-left: 1.25cm"><FONT FACE="Courier, monospace">val
= (op-&gt;gt_val &lt; 0) ? -1 : 1;  /* logic value from source node
<SPAN STYLE="font-weight: normal">*/</SPAN><B><BR></B><SPAN STYLE="font-weight: normal">lp
= op-&gt;gt_list                  /* lp points to 1st target list
*/<BR></SPAN>while ((gp = *lp++) != 0) {       /* scan non-inverted
targets */<BR>    if ((gp-&gt;gt_val += val) == 0) {            /*
gate function */<BR>	gp-&gt;gt_val = val;<FONT SIZE=2>               
        /* step past 0 */</FONT><BR>	(*masterAct[gp-&gt;gt_fni])(gp,
iC_o_list); /* master action */<BR>    }<BR>}<SPAN STYLE="font-weight: normal">
                                 /* lp points to 2nd target list
*/</SPAN><BR>val = -val;                        /* invert logic value
*/<BR>while ((gp = *lp++) != 0) {        /* scan inverted targets */<BR>
   if ((gp-&gt;gt_val += val) == 0) {            /* gate function
*/<BR>	gp-&gt;gt_val = val;<FONT SIZE=2>                        /*
step past 0 */</FONT><BR>	(*masterAct[gp-&gt;gt_fni])(gp, iC_o_list);
/* master action */<BR>    }<BR>}<SPAN STYLE="font-weight: normal">  
                   /* </SPAN><SPAN STYLE="font-weight: normal">normal
and inverting actions completed</SPAN><SPAN STYLE="font-weight: normal">
*/</SPAN></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>The
logical XOR function is handled differently again. Each change of
input from <FONT FACE="Courier, monospace"><SPAN STYLE="font-weight: normal">1/0</SPAN></FONT>
or <FONT FACE="Courier, monospace">0/1</FONT> causes the target to be
negated from +1 to -1 or -1 to +1 and fire immediately. XOR GATEs are
initialised to +1 (logical '0') for all inputs '0', which is the
initial condition. Logical inversion is the same as above, although
the action is the same for both non-inverting and inverting target
lists (negate the target and fire).</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>There
are four types of action list to which Expression nodes may be linked
when they “fire” during the combinatorial scan:</FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>o_list</B><SPAN STYLE="font-weight: normal">,
	to which logical GATE nodes are linked.</SPAN></FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>a_list</B>,
	to which arithmetic expression nodes are linked.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>c_list</B><SPAN STYLE="font-weight: normal">
	or another</SPAN><SPAN STYLE="font-weight: normal"> </SPAN><B>clock
	list</B>, to which clocked function Master nodes are linked.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>s_list</B>,
	to which external output expression nodes are linked.</FONT></FONT></P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>To
simplify the description, <B>o_list </B><SPAN STYLE="font-weight: normal">and
</SPAN><B>a_list </B><SPAN STYLE="font-weight: normal">are discussed
here as a single combinatorial action list. For the combinatorial
scan, t</SPAN>he Expression node at the head of the combinatorial
action list is taken and the target list(s) of that node is scanned,
using the code on the previous page. Every Expression node on that
target list is re-evaluated, using the new value of the Expression
node just taken from the combinatorial action list, with the result
that some Expression nodes on the target list may change and “fire”.
These nodes are then linked to the end of an appropriate action list.
The old value of the original Expression node is assigned the new
value at this time and it is unlinked from the head of the
<SPAN STYLE="font-weight: normal">combinatorial action list</SPAN> –
that node is now no longer active. The combinatorial scan is
continued with the new head of the  <SPAN STYLE="font-weight: normal">combinatorial
action list until the list is empty.</SPAN></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>There
is another possibility. The target Expression node is already
somewhere on some action list, which means its value has recently
changed, but the new value has not yet been transmitted to any follow
on nodes. Now another Expression node acts on this particular
Expression node and re-evaluation changes its value a second time.
There are two possibilities:</FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>The
	latest value is still different from the old value (the value it had
	when its target list was last scanned and follow on nodes were
	re-evaluated). In this case the Expression node is left on the
	action list with a (possibly) changed new value.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Re-evaluation
	changes the new value back to the old value. This situation is
	called a “<B>glitch</B>”. The Expression node is now unlinked
	from the action list and becomes inactive, before it acts on any
	follow on nodes. The reasoning behind this strategy is, that any
	temporary change, which occurs through one path of the graph, which
	is immediately undone by some expression on another path, should not
	influence the output. <B>This handling of glitches and subsequent
	clocking, which is guaranteed to ignore glitches, make hardware IC
	circuits and </B><I><B>iC</B></I><B> programs really robust</B>.</FONT></FONT></P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Initially
nodes can only get on the combinatorial action list due to changes of
external inputs (sources) of the graph. Normally such a change will
percolate through paths of the graph to one or more external output
nodes (sinks). At this stage the combinatorial action list is usually
empty. </FONT></FONT>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Cycles
are allowed in the graph – they occur when there is feedback in the
<I>iC</I> program. Such feedback is often necessary for implementing
designs, <FONT COLOR="#000000">but the designer should control it.
</FONT>Feedback may result in situations, where continuous
oscillations occur. When this happens, certain nodes will change to a
new value – act on some follow on node(s), which will then change
the original node back to the old value after it has acted on other
nodes. This means the action list will never get empty. If nothing
were done about this, the <I>iC</I> program would lock up the
processor. </FONT></FONT>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Continuous
oscillations at the Expression node level should not be part of a
design and this situation results in a warning message at run-time.
Nevertheless for testing purposes, such a program should be able to
run without locking up the processor. To achieve this, a strategy is
used, where the number of times a particular node may be re-evaluated
in one scan is limited – usually to three. This is the <I>maximum
oscillator count</I>, which may be changed with the -n&nbsp;&lt;count&gt;
command-line switch. If the <I>maximum oscillator count</I> for any
node is exceeded after re-evaluation of that node, it is not linked
to the normal combinatorial action list, but to an alternate action
list. This way the current combinatorial action list will always get
empty within a finite number of actions. At the end of the scan, when
the current combinatorial action list does become empty, the
combinatorial action list and the alternate action list are swapped.
At this point in time the <I>iC</I> run-time process goes to sleep,
waiting for new input.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>When
a new external input interrupts the system, the associated input node
is linked to the now current swapped combinatorial action list and
triggers a new scan. Together with the new input and its follow up
events, the oscillating nodes, which were linked to the (then
alternate) list during the previous scan, will be evaluated again.
This way the oscillations do get re-evaluated over and over – but
at a rate which does not block the processor. This is similar to the
way oscillations manifest themselves in a hardware IC circuit – a
large but finite number of oscillations will occur between any two
consecutive external input events. In <I>iC</I> programs, this number
has been reduced to three, which does not change the way these
oscillations affect other parts of the program. In practice it has
been found useful to make this an odd number, so that rising and
falling edges alternate for digital oscillations.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><A NAME="clocking"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>All this takes
care of what is called “combinatorial logic” for digital systems.
Sequencing requires different mechanisms and they are provided in the
<I>iC</I> language by clocking and clocked functions. </FONT></FONT>
</P>
<H2 CLASS="western"><A NAME="__RefHeading__23233_1582432481"></A><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4>8.2
 Clocked immediate actions</FONT></FONT></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>As mentioned
before, clock signals in <I>iC</I> are best thought of as timeless
pulses, whose occurrence marks the separation of one clock period
from the next along the time axis. For these purposes actions in the
<I>iC</I> run-time occur in two phases – <I>combinatorial </I><I>immediate
</I><I>actions</I>, which were described in the previous section and
<I>clocked </I><I>immediate </I><I>actions</I>, which are always
master-slave actions, which occur during the clock phase.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Clocked
functions contain one or more Master nodes and exactly one Slave
node. Master nodes are expression nodes – just like the ones
described in the previous section, except their output does not act
directly on follow on expression nodes and therefore are not linked
to the current combinatorial action list when they “fire”. There
is a Master node for every non-clock input parameter to a function.
Associated with each such non-clock parameter is a clock parameter.
If it is not mentioned explicitly in the parameter list, it has a
default value – usually <I><B>iClock</B></I>. Master nodes which
“fire”, are linked to the clock list associated with the clock
parameter for the particular Master node.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
Clock lists are similar to action lists – they may be empty or have
one or more expression nodes linked to them. Clock lists are
associated with the Slave node of a clock function or “driver”.
There is one special clock list called <FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list</B></FONT></FONT>,
which is associated with the default <FONT FACE="Liberation Sans, sans-serif"><I><B>iClock</B></I></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
and which is scanned every time a combinatorial scan completes unless
</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list
</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">is
empty. This clock scan marks the occurrence of </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><B>iClock</B></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">.
In other words combinatorial scans and clock scans alternate until
both the current combinatorial action list and </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>
</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">are
empty. For the purpose of synchronisation, it is important to
remember that during the combinatorial scan new nodes are evaluated
and linked to one of the following:</SPAN></FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>the current
	combinatorial action lists <B>o_list </B>or <B>a_list </B>–
	described in the previous section.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>c_list</B><SPAN STYLE="font-weight: normal">
	or another clock list – which receive Master nodes of clocked
	functions.</SPAN></FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><B>s_list</B><SPAN STYLE="font-weight: normal">
	– which receives those Expression nodes whose action is external
	output.</SPAN></FONT></FONT></P>
</OL>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
<FONT SIZE=2><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">During
the clock scan only </SPAN></FONT><FONT FACE="Courier, monospace"><B>c_list</B></FONT><FONT FACE="Sanserif PS"><SPAN STYLE="font-weight: normal">
</SPAN></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN STYLE="font-weight: normal">is
scanned. There are several different clock actions, but they only
involve the value of a Master node modifying the value of a Slave
node and some side effect associated with the clocked function. The
different clock actions are:</SPAN></FONT></FONT></P>
<OL>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Clocking of a
	logical or arithmetic function – the new value of the Slave node
	is determined by the slave action of the Master node on the Slave
	node, which is linked to the current combinatorial action list if
	its value changes – it becomes a new logical or numeric output,
	which will <B>not</B> have any effect on inputs until after the
	current clock scan has completed.</FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Sanserif PS"><FONT SIZE=2><FONT FACE="Liberation Sans, sans-serif">Clocking
	of a CLOCK or TIMER driver function – the clock list associated
	with the CLOCK or TIMER function Slave node, </FONT><FONT FACE="Liberation Sans, sans-serif">which
	</FONT><FONT FACE="Liberation Sans, sans-serif">contains the
	accumulated </FONT><FONT FACE="Liberation Sans, sans-serif">Master</FONT><FONT FACE="Liberation Sans, sans-serif">
	</FONT><FONT FACE="Liberation Sans, sans-serif">nodes linked to </FONT><FONT FACE="Liberation Sans, sans-serif">th</FONT><FONT FACE="Liberation Sans, sans-serif">at</FONT><FONT FACE="Liberation Sans, sans-serif">
	clock list,</FONT><FONT FACE="Liberation Sans, sans-serif"> </FONT><FONT FACE="Liberation Sans, sans-serif">is</FONT><FONT FACE="Liberation Sans, sans-serif">
	linked to </FONT><FONT FACE="Liberation Sans, sans-serif">the end of</FONT>
	<FONT FACE="Courier, monospace"><B>c_list</B></FONT><FONT FACE="Liberation Sans, sans-serif">.
	This means, that the CLOCK or TIMER function has “fired” and the
	</FONT><FONT FACE="Liberation Sans, sans-serif">slave</FONT><FONT FACE="Liberation Sans, sans-serif">
	actions </FONT><FONT FACE="Liberation Sans, sans-serif">of the
	Master nodes</FONT><FONT FACE="Liberation Sans, sans-serif">, which
	have accumulated on its clock list will also be executed during the
	current clock scan, since they are now on </FONT><FONT FACE="Courier, monospace"><B>c_list</B></FONT><FONT FACE="Liberation Sans, sans-serif">.</FONT></FONT></FONT></P>
	<LI><P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
	<FONT FACE="Sanserif PS"><FONT SIZE=2><FONT FACE="Liberation Sans, sans-serif">Clocking
	of a conditional </FONT><FONT FACE="Courier, monospace"><B>if else
	</B></FONT><FONT FACE="Liberation Sans, sans-serif">or</FONT> <FONT FACE="Courier, monospace"><B>switch
	</B></FONT><FONT FACE="Liberation Sans, sans-serif">statement
	function. </FONT><FONT FACE="Liberation Sans, sans-serif">Because</FONT><FONT FACE="Liberation Sans, sans-serif">
	these functions execute </FONT><FONT FACE="Liberation Sans, sans-serif"><I>C</I></FONT><FONT FACE="Liberation Sans, sans-serif">
	code embedded in the </FONT><FONT FACE="Liberation Sans, sans-serif"><I>iC</I></FONT><FONT FACE="Liberation Sans, sans-serif">
	program, which may involve modifying logical or arithmetic </FONT><FONT FACE="Liberation Sans, sans-serif"><I>immediate</I></FONT><FONT FACE="Liberation Sans, sans-serif">
	variables, the actual execution of the </FONT><FONT FACE="Liberation Sans, sans-serif"><I>C</I></FONT><FONT FACE="Liberation Sans, sans-serif">
	code must be deferred until after completion of the clock scan. For
	this purpose the </FONT><FONT FACE="Liberation Sans, sans-serif">Master</FONT><FONT FACE="Liberation Sans, sans-serif">
	nodes of any conditional </FONT><FONT FACE="Courier, monospace"><B>if
	else </B></FONT>or <FONT FACE="Courier, monospace"><B>switch
	</B></FONT><FONT FACE="Liberation Sans, sans-serif">statement
	function </FONT><FONT FACE="Liberation Sans, sans-serif">are
	</FONT><FONT FACE="Liberation Sans, sans-serif">unlinked from the
	clock list and</FONT><FONT FACE="Liberation Sans, sans-serif">
	linked to another action list – namely </FONT><FONT FACE="Courier, monospace"><B>f_list</B></FONT><FONT FACE="Liberation Sans, sans-serif">.</FONT></FONT></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">The
	scan of </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>c_list</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
	is always finite, since no new Master </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">nodes</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
	are added to any clock list during the </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">clock
	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">scan.
	When the clock scan terminates a single scan of </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
	follows, unless </SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
	is empty. T</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">he
	start of the</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
	</SPAN></FONT></FONT><FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list
	</B></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">scan
	marks the end of a clock phase and the beginning of a new
	combinatorial phase. </SPAN></FONT></FONT>After this another
	combinatorial scan followed by a clock scan is done, because both
	clocked slave actions and the  <FONT FACE="Courier, monospace"><FONT SIZE=2><B>f_list</B></FONT></FONT>
	scan may have generated new combinatorial actions.</P>
</OL>
<H2 CLASS="western"><A NAME="__RefHeading__23235_1582432481"></A>8.3 
Output actions</H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2">Finally,
when both the current combinatorial action list and <FONT FACE="Courier, monospace"><B>c_list</B></FONT>
are empty, a single scan of <FONT FACE="Courier, monospace"><B>s_list</B></FONT>
 follows. During that scan the actual external output is performed.
Each <FONT FACE="Courier New, monospace"><B>bit</B></FONT> output is
first distributed to an output byte and then the output bytes, words
and long words which have changed since the last cycle are either
output directly (currently only possible on a Rapberry Pi) or
transmitted via TCP/IP to <I><B>iCserver</B></I>, which distributes
them to their final output destinations, where they act physically.
At this point the process sleeps until it is interrupted by an
external or internal input.</P>
<H2 CLASS="western"><A NAME="__RefHeading__23237_1582432481"></A>8.4 
Input actions</H2>
<P CLASS="western">External inputs come from physical input device
drivers and are transmitted as bytes, words or long words again
either directly or via TCP/IP through <I><B>iCserver</B></I>, using
the same protocol as the output. 
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="font-weight: normal; widows: 2; orphans: 2">
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Most drivers
use TCP/IP as the transport protocol from and to the <I>iC</I>
run-time system and the final physical input and output device(s) in
the current implementation. This ensures, that no input or output is
lost during transmission. Nagle's algorithm is inhibited to ensure
immediate delivery. Other safe transmission systems can be used –
only the actual input and output driver software needs to be changed.</FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-weight: normal">The
run-time system also recognises internal inputs which are mainly
interrupts from the processors real-time-clock </SPAN></SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-weight: normal">used
for timing operations</SPAN></SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB"><SPAN STYLE="font-weight: normal">.
These are described in <A HREF="#6.1.3.  Timing inputs|outline">section
6.1.3.</A></SPAN></SPAN></FONT></FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>External
and internal inputs interrupt the run-time system. Initially the
source of the interrupt is analysed and Input nodes are “fired”
for every changed input (and only those that have changed) and these
are linked immediately to the current <SPAN STYLE="font-weight: normal">combinatorial
action list. Then a new cycle is initiated starting with a scan of
the current combinatorial action list.</SPAN></FONT></FONT></P>
<H2 CLASS="western"><A NAME="__RefHeading__7052_1756982362"></A><B>8.5
 Input/Output network</B></H2>
<P CLASS="western" ALIGN=JUSTIFY STYLE="widows: 2; orphans: 2"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">The
network clients around </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><B>iCserver</B></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
can comprise one or more </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">iC</SPAN></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
applications and any number of </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">real
I/O drivers as well as </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><B>iCboxes</B></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">and</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><B>iClift</B></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">,
which simulate real I/O in the current implementation. Input and
output can be transmitted not only to and from </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">iC</SPAN></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
applications and </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><B>iCboxes</B></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
but also between </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">iC</SPAN></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
applications. Since all of these elements can run on any processor in
a LAN or even in the Internet, this opens up interesting
possibilities for the </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><SPAN STYLE="font-weight: normal">iC</SPAN></I></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-weight: normal">
system.</SPAN></FONT></FONT></P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<IMG SRC="iC_html_eee3ff13.gif" ALIGN=LEFT><BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; font-weight: normal; widows: 2; orphans: 2">
<BR><BR>
</P>
<P CLASS="western"><I><BR>Fig. 3	</I><I><SPAN STYLE="font-weight: normal">Input/output
network</SPAN></I></P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="__RefHeading__23241_1582432481"></A>
<FONT FACE="Sanserif PS"><FONT SIZE=4><B>9    Compiler and Run-time
system</B></FONT></FONT></H1>
<H2 CLASS="western"><A NAME="__RefHeading__23243_1582432481"></A>9.1 
Compiler 
</H2>
<P CLASS="western">The <I>iC</I> compiler <I><B>immcc</B></I>
generates <I>C</I> code with the extension <FONT FACE="Courier, monospace"><B>.c</B></FONT>
from <I>iC</I> source files with the extension <FONT FACE="Courier, monospace"><B>.ic</B></FONT>,
which is suggested for <I>iC</I> sources. It is also suggested, that
<I>iC</I> header files have the extension <FONT FACE="Courier, monospace"><B>.ih</B></FONT>.
For larger projects, several <FONT FACE="Courier, monospace"><B>.ic</B></FONT>
files may be compiled to <FONT FACE="Courier, monospace"><B>.c</B></FONT>
files, which are then compiled by <I><B>cc</B></I> to <FONT FACE="Courier, monospace"><B>.o</B></FONT>
files and linked with the dynamic library <I><B>libict.so</B></I>,
which contains the run-time code. This produces a finished
application, which can be run in an environment compatible with the
features of the run-time library. Alternatively the static library
<I><B>libict.a</B></I> can be used. This produces much larger code,
but does provide extensive debugging output from a running system.</P>
<P CLASS="western">The <I>iCa </I>pre-compiler <I><B>immac</B></I>
generates <I>iC</I> source files with the extension <FONT FACE="Courier, monospace"><B>.ic</B></FONT>
from <I>iC</I> with arrays (<I>iCa</I>) source files with the
extension <FONT FACE="Courier, monospace"><B>.ica</B></FONT>. The
shell script <I><B>iCmake</B></I> executes all these steps
automatically – it makes a complete <I><B>iC</B></I><B> </B>application
from one or more <I>iC</I> and/or <I>iCa</I> sources.</P>
<H2 CLASS="western"><A NAME="__RefHeading__23245_1582432481"></A>9.2 
Run-time libraries 
</H2>
<P CLASS="western">There are several versions of the run time
library, depending on the hardware interfaces available for Input and
Output. The Demonstration libraries <I><B>libict.so </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">or
</SPAN></SPAN><I><B>libict.a</B></I> communicate their Input and
Output via TCP/IP, which provides a turnaround time of an input
change to the arrival of the corresponding output change in a lightly
loaded network of less than 1.7 milliseconds (measured on a Raspberry
Pi 2B). The uncertainty of load occurring in such a network forces
one to look at specialized bus systems for high speed applications.
Using direct I/O rather than TCP/IP 90 microseconds turnaround was
measured on the Raspberry Pi 2B.</P>
<P CLASS="western">Other libraries have been built for industrial
field bus systems. The library for <SPAN STYLE="font-weight: normal">InterBus-S</SPAN><B>
</B>is complete and has been extensively tested with InterBus-S I/O
modules. A library for a proprietary high speed field bus system was
used for early tests and provided turnaround times of under a 100
microseconds on a 386 8 MHz processor. A CAN-Bus library is planned
and could be implemented at short notice.</P>
<H2 CLASS="western"><A NAME="__RefHeading__23247_1582432481"></A>9.3 
Run-time environment and system</H2>
<P CLASS="western">For any applications where hard real time
constraints are not a problem, the TCP/IP run-time system provides a
very flexible and easy to configure environment where Input and
Output may be distributed over a number of computers in a local area
network. The system consists of a server called <I><B>iCserver</B></I>
and a number of clients for which <I><B>iCserver</B></I> is the hub.
An <I>iC</I> application linked with the <I><B>libict.so</B></I>
library is one type of client, providing control in the system. The
other client types are Input and Output modules (or combined I/O
modules) and debugging tools.</P>
<P CLASS="western"><I><B>iCserver</B></I> has been implemented in
Perl, which is very flexible and fast enough to keep up with TCP/IP
traffic generated in a local area network. A faster <I>C</I>
implementation of <I><B>iCserver</B></I> is possible. The program
<I><B>iCbox</B></I> simulates Input/Output modules as Perl/Tk dialog
boxes for digital and analog inputs and outputs. For real inputs and
outputs <I><B>iCbox</B></I> can serve as a program template. Only the
translation of the I/O signals to a short network message for
transmission to the <I><B>iCserver</B></I> is necessary to port an
I/O device. This has been done with <FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><I><B>iCpiFace</B></I></FONT></FONT>
for the Raspberry Pi. A simple and very compact protocol for passing
messages to and from the <I><B>iCserver</B></I> has been defined.</P>
<P CLASS="western"><I><B>iClift</B></I> is a simulation of the
physics and appearance of lifts in a building with IEC inputs sent to
an <I>iC</I> control application from simulated sensors and buttons
and using IEC outputs received from an <I>iC</I> control application
to initiate and stop simulated movement and to reset buttons. The
number of lifts and floors can be varied. <I><B>iClift</B></I> can be
used to test a variety of control strategies for lifts in a building.</P>
<P CLASS="western">The program <I><B>iClive</B></I> provides an IDE
for editing and debugging <I><B>iC</B></I> programs. It provides an
edit window, in which program text can be displayed and optionally
edited, searched, saved, made into runnable code, run and stopped.
When running and debugging an <I><B>iC</B></I> program, <I><B>iClive</B></I>
is a client of <I><B>iCserver</B></I> and indirectly of the running
<I><B>iC</B></I> program. In “Live” mode <I><B>iClive</B></I>
colours words in the program text according to the state of the node
named by a word – <SPAN STYLE="background: #23ff23">green/black</SPAN>
for bit 0, <FONT COLOR="#ff0000"><SPAN STYLE="background: #ffff00">yellow/red</SPAN></FONT>
for bit 1, <SPAN STYLE="background: #99ccff">blue</SPAN> for
arithmetic variables, <FONT COLOR="#ffffff"><SPAN STYLE="background: #ff950e">Rust
red</SPAN></FONT> for clocks and <FONT COLOR="#ffffff"><SPAN STYLE="background: #6ea19b">cadet
blue</SPAN></FONT> for timers. To be effective, the displayed text
must be either the source of the running <I><B>iC</B></I> program or
a text derived from that source, such as the compiler generated
listing, which shows all compiler generated extra nodes. Short
transients are extended to display for 50 ms – an idea taken from
the Hewlett Packard logic probe. The numerical value of a node is
also displayed when the cursor hovers over a word. With this colour
coded display of the statements of the <I><B>iC</B></I> program, it
is easy to follow the progress of execution and the related logic at
run time. &quot;Live displays&quot; are commonly used in programming
units for PLC's in industrial control environments to provide
debugging support. <I>immediate C</I> follows this example.</P>
<H3 CLASS="western"><A NAME="__RefHeading__8442_110994698"></A>9.3.1 
iCbox, iClive and iCman in action</H3>
<P CLASS="western"><IMG SRC="iC_html_88c76df0.jpg" NAME="graphics4" ALIGN=LEFT WIDTH=549 HEIGHT=400 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P CLASS="western"><I>Fig. 4	</I><I><B>iCbox</B></I><I> as IO for
“sort32i” - IX0.0, QX0.2 and QX8.1 are “on” - the rest are
“off”. </I><I>IB3 has a value 	of 3, othe analog inputs are 0.</I></P>
<P CLASS="western"><IMG SRC="iC_html_f46b922b.jpg" NAME="graphics1" ALIGN=LEFT WIDTH=611 HEIGHT=371 BORDER=0><BR CLEAR=LEFT><BR><BR>
</P>
<P CLASS="western"><I>Fig. 5	<B>iC</B><B>live</B> in EDIT mode with a
search for IX0.5 shown. The application “sort32i” is not running
– 	press “Run” and then “Live” to get to Fig. 6. - press
“Help” to get the man-page (see Fig. 7).</I></P>
<P CLASS="western"><IMG SRC="iC_html_2ff018e6.jpg" NAME="graphics5" ALIGN=LEFT WIDTH=611 HEIGHT=371 BORDER=0><BR CLEAR=LEFT><I>Fig.
6	<B>iClive</B> in LIVE mode - QX8.1, QX0.2 and IX0.0 are “1” -
the rest are “0”. IB3 is non-zero. <BR>	“sort32i” is running.
– it can be stopped by pressing the “Stop” button and/or
switched<BR>	to Edit mode by pressing the “Edit” button (see Fig.
5).</I></P>
<P CLASS="western"><IMG SRC="iC_html_39829ba7.jpg" NAME="graphics2" ALIGN=LEFT WIDTH=611 HEIGHT=376 BORDER=0><BR CLEAR=LEFT><I>Fig.
</I><I>7</I><I>	</I><I><B>iCman</B></I><I> showing the start of the
man-page for </I><I><B>iClive</B></I><I>. A search for “Text” is
shown.	<BR></I><BR><BR>
</P>
<P CLASS="western">For command line use, a shell script <I><B>iCmake</B></I>
builds one or more applications from <I><B>iC</B></I> sources using
the compilers <I><B>immac</B></I>, <I><B>immcc </B></I>and the
libraries <I><B>libict.so</B></I><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">
</SPAN></SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">or
</SPAN></SPAN></FONT></FONT><I><B>libict.a</B></I><I>.</I><SPAN STYLE="font-style: normal">
The programs </SPAN><I><B>immac</B></I>, <I><B>immcc</B></I>,
<I><B>iCserver</B></I><SPAN STYLE="font-weight: normal">,</SPAN>
<I><B>iCbox</B></I>, <I><B>iClive</B></I><B> </B>and <I><B>iCmake</B></I>
as well as each compiled and linked <I><B>iC</B></I> application
provide a generous help output with the -h switch option. Each of
these programs also has a full man page which may be viewed with
'man' in a Unix like environment or with <I><B>iCman</B></I>, a man
page viewer with interesting hyperlink, search and text magnification
features, much like a browser.</P>
<H2 CLASS="western"><A NAME="__RefHeading__8444_110994698"></A>9.4 
GTKWave Wave Analyzer</H2>
<P CLASS="western">GTKWave (an open-source program) is an analysis
tool originally intended to perform debugging on Verilog or VHDL
simulation models. Except for interactive VCD viewing, it is not
intended to run interactively with simulation, but instead relies on
a post-mortem approach through the use of dump-files. Various
dump-file formats are supported:</P>
<UL>
	<LI><P CLASS="western">VCD: Value Change Dump. This is an industry
	standard file format generated by most Verilog simulators and is
	specified in IEEE-1364. 
	</P>
</UL>
<P CLASS="western">(Extract from the GTKWave 3.3 Wave Analyzer User's
Guide) Use in the <I>iC</I> system is hereby gratefully acknowledged.</P>
<P CLASS="western">Since version 1.131 of the <I>iC</I> run-time a
VCD file and an associated SAV file can be generated by an <I>iC</I>
application by using the -v option. This allows the interactive or
post-mortem viewing of both logic and analog traces against a virtual
time scale. This time scale was chosen so that each sequential change
in any signal is 1 virtual microsecond. <I>iClock</I> cycles take up
2 virtual microseconds. Each new external input (Ixn.m, IBn, IWn ILn
or TX0.m) occurs on the next 10 virtual microsecond boundary.</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><IMG SRC="iC_html_83c69566.jpg" NAME="graphics3" ALIGN=LEFT WIDTH=611 HEIGHT=479 BORDER=0><BR CLEAR=LEFT><I>Fig.
7	</I><I><B>GTKWave</B></I><I> showing part of the running of the iC
application 'bar -v bar.vcd'.</I></P>
<P CLASS="western"><I>iClock</I> is shown as the top trace. The
auxiliary clock c0 and the timer t are in sync with <I>iClock</I> as
can be seen just before and after marker A. The rising edge of TX0.4
(the 100 ms timer) sets t_1, which in turn is the slave input to the
TIMER producing timer t (which occurs in the next <I>iClock</I>
phase). The following is an excerpt from the listing file bar.lst:</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">019	imm
timer t = TIMER(TX0.4);</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	t_1
    T ---!  t       !</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	iClock
 : ---|  t_1     T</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	TX0.4
    ---|</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">025	imm
bit b0 = D(~b0 &amp; f0, t, d0) | CHANGE(IX0.0 &amp; ~f0);</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	b0_1
     ---|  b0</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	b0_2
     ---|</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	b0_4
   D ---#  b0_1</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	b0_3
   V ---&gt;  b0_2</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	iClock
 : ---&amp;  b0_3    V</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	IX0.0
    ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	f0
     ~ ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	t
      ! ---&amp;  b0_4    D</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	IB1
    A&lt;---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	b0
     ~ ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	f0
       ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">026	imm
clock c0 = CLOCK(b0);</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	c0_1
   C ---:  c0      :</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	iClock
 : ---|  c0_1    C</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	b0
       ---|</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">035	imm
bit m7 = SR(~m8 &amp; m6, m8      , c0);</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m7_1
   S ---#  m7</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m7_2
   R ---#</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	c0
     : ---&amp;  m7_1    S</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m8
     ~ ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m6
       ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	c0
     : ---|  m7_2    R</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m8
       ---|</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">036	imm
bit m8 = SR(~m8 &amp; m7, m8 &amp; ~m0, c0);</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m8_1
   S ---#  m8</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m8_2
   R ---#</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	c0
     : ---&amp;  m8_1    S</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m8
     ~ ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m7
       ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	c0
     : ---&amp;  m8_2    R</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m8
       ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><FONT FACE="Courier, monospace">	m0
     ~ ---&amp;</FONT></P>
<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0cm"><BR>
</P>
<P CLASS="western">(At marker A) D flip-flop b0_1 sets with the next
timer t tick, because d0 (alias IB1) is currently 1 (as seen in the
trace). This raises b0, which sets CLOCK slave c0_1 and lowers gate
b0_4 in that order.</P>
<P CLASS="western">Next (at marker B) <I>iClock</I> resets flip-flop
b0_1 because input b0_4 is now '0'. This is followed by clock c0
setting SR flip-flop m8 (slave m8_1 was set by ~m8 &amp; m7 at the
previous clock c0). The setting of m8 sets slave gate m7_2 and resets
slave gates m0_1 to m8_1 (at marker C). This is followed by the
resetting of b0 (input b0_1 was reset earlier in this combinatorial
cycle). b0 in turn resets c0_1 and sets b0_4 (at marker D). This
finishes the combinatorial cycle and starts another <I>iClock</I>
which does nothing. The next action is the external TX0.4 resetting,
which resets slave gate t_1, which has no follow-up.</P>
<P CLASS="western">GTKWave is not part of the OpenSUSE Linux
distribution, but it can be easily installed with an RPM package from
the internet. Caveat: conversion of VCD files to LXT files with
'vcd2lxt' does not work satisfactorily. <FONT FACE="Courier, monospace"><B>CLOCK</B></FONT>
and <FONT FACE="Courier, monospace"><B>TIMER</B></FONT> events are
not converted. Therefore use VCD files only for <I>iC</I>.</P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="__RefHeading__23249_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><B>10   
Bibliography</B></FONT></FONT></H1>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Aho86]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Alfred
V. Aho, Ravi Sethi, Jeffrey D. Ullman	<BR>	Compilers Principles,
Techniques, and Tools	<BR>	Addison-Wesley Publishing Company 1986</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Davis01]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	John
Davis II, et al	<BR>	Overview of the Ptolemy Project	<BR>	University
of California, Berkeley 2001</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Johnson75]<FONT FACE="Liberation Sans, sans-serif"><SPAN LANG="en-GB">	</SPAN></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN LANG="en-GB">Stephen
C. Johnson</SPAN></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">	<BR>	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">Yacc
– yet another compiler compiler</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">	<BR>	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">Computer
Science Technical Report 32,	<BR>	Bell Telephone Laboratories, Murray
Hill, NJ, July 1975</SPAN></FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Johnston04]<FONT FACE="Liberation Sans, sans-serif">	<FONT SIZE=2>Wesley
M. Johnston, J. R. Paul Hanna, and Richard J. Millar	<BR>	</FONT><FONT SIZE=2>Advances
in Dataflow Programming Languages	<BR>	ACM Computing Surveys, Vol.
36, No. 1, March 2004, pp. 1–34.</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Kernighan84]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Brian
W. Kernighan, Rob Pike	<BR>	The UNIX Programming
Environment	<BR>	Prentice Hall, Inc. 1984</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Kernighan88]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Brian
W. Kernighan, Dennis M. Ritchie	<BR>	The C Programming
Language	<BR>	Prentice Hall, Inc. 1988</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Kluge92]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Werner
Kluge	<BR>	The Organization of Reduction, Data Flow, and Control Flow
Systems	<BR>	The MIT Press 1992</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Lent89]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Bogdan
Lent	<BR>	Dataflow Architecture for Machine Control	<BR>	John Wiley &amp;
Sons Inc. 1989</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Lidie02]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">Stephen
Lidie &amp; </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">Nancy
Walsh	<BR>	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">Mastering</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">
Perl/Tk	<BR>	O'Reilly </SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">2002</SPAN></FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[McKeeman70]<FONT FACE="Liberation Sans, sans-serif"><SPAN LANG="en-GB">	</SPAN></FONT><FONT FACE="Liberation Sans, sans-serif"><SPAN LANG="en-GB">William
Marshall McKeenan et al</SPAN></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">	<BR>	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">A
Compiler Genrator</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">	<BR>	</SPAN></FONT></FONT><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2><SPAN LANG="en-GB">Prentice
Hall, Englewood Cliffs, NJ, 1970</SPAN></FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Phister63]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Montgomery
Phister, Jr.<BR>	Logical design of digital computers	<BR>	John Wiley
&amp; Sons, Inc. 1963</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Sharp85]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	John
A. Sharp	<BR>	Data flow computing	<BR>	Ellis Horwood Limited 1985</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT>[Sparkes72]<FONT FACE="Liberation Sans, sans-serif">	John
Sparkes, Ed.	<BR>	The Heart of Computers	<BR>	The Open University
Press 1972</FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Srinivasan97]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Sriram
Srinivasan	<BR>	Advanced Perl Programming	<BR>	O'Reilly 1997</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Wall00]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Larry
Wall, Tom Christiansen &amp; Jon Orwant	<BR>	Programming
Perl	<BR>	O'Reilly 2000</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Walsh99]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	Nancy
Walsh	<BR>	Learning Perl/Tk	<BR>	O'Reilly 1999</FONT></FONT></P>
<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
[Wulff72]<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>	John
E. Wulff	<BR>	A Monitor for Real-Time-Control Systems	<BR>	University
of New South Wales 1972</FONT></FONT></P>
<H1 CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.42cm; border-top: 1.00pt solid #000000; border-bottom: none; border-left: none; border-right: none; padding-top: 0.12cm; padding-bottom: 0cm; padding-left: 0cm; padding-right: 0cm; widows: 2; orphans: 2; page-break-before: always; page-break-after: avoid"><A NAME="__RefHeading__23251_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><B>11    The
Author</B></FONT></FONT></H1>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>John
E. Wulff studied Electrical Engineering at the University of New
South Wales in Sydney, Australia graduating in 1960. His first
professional experience was in the Telephone industry, developing
switching circuits with electro-mechanical relays but also with
vacuum tubes, cold cathode tubes and very soon with the emerging
transistors. In 1964 he spent 6 months in England, getting know-how
on a new family of switching circuits using germanium diodes and
transistors, but which already supported clocked flip-flops. These
had been developed at the BICC research laboratory near Hampton
Court, where John Sparkes had invented the principle of clocking a
few years earlier. With this experience, John Wulff was chief
designer for a special purpose computer with 100 kilobytes of
magnetic drum memory, 1 million transistors, 2.5 million diodes for
logic and 100,000 silicon controlled rectifiers for power output
drivers, switching 24 Volt rotary solenoids drawing up to 5 Amps.
This computer controlled a letter sorting system with 150 input
consoles and a throughput of 5 million letters a day. The system
worked reliably for 25 years at the Redfern Mail Exchange in Sydney.</FONT></FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>Experience
with logic design based on integrated circuits followed. The
availability of mini computers led to an interest in programming. A
Master of Engineering Science Degree in Information Science at the
University of New South Wales provided a solid foundation for future
work as a Software Engineer. The design and implementation of a Real
Time Operating System (or Monitor, as it was then called), which
provided a task context switch in 15 machine instructions was the
content of his Masters Thesis [Wulff72], and later provided the basis
for some very fast industrial machine control systems with Data
General Nova mini-computers, whose instruction execution time was 6
microseconds.</FONT></FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>In
the mid 80's John Wulff came in contact with PLC's. He was asked to
help during the commissioning of a PLC-system, controlling a parcel
sorting complex consisting of 100 standard conveyor systems and 4
high speed conveyors (2 metres/second) which had mechanical gates
along its length, to divert parcels. These high speed belts needed a
control resolution of 15 milliseconds, in which time a parcel had
moved 30 mm. Unfortunately the function blocks for the standard
conveyors, whose outputs hardly ever change once they are started,
executed 100 times, once for each of the conveyors, brought the total
cycle time of the PLC to over 1 second!! What to do? Fortunately the
PLC had just enough (8) interrupt inputs, to allow the implementation
of an event driven sub-system based on the assembler instruction set
of the PLC. This saved the company a lot of liquidated damages. </FONT></FONT>
</P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>This
experience spawned the idea for an event driven PLC, which resulted
in the current <I>iC</I> system. Although this system is demonstrably
faster than a PLC with the same memory speed for any reasonable
application one can think of, it is difficult to compute a guaranteed
maximum response time. Since this is a requirement for hard real time
applications, <I>iC</I> was never accepted for industrial use. For a
PLC the maximum response time is simply the time to execute all
instructions making up the program, which is the cycle time of the
program. For an <I>iC</I> program this time can also be computed. For
a 10 MHz PC the execution time is about 2 microseconds per gate node
processed. The total number of gate nodes is provided in the listing
produced by the compiler. An <I>iC</I> program with 10,000 gate
nodes, which corresponds to a PLC program of approx. 32 kilobytes
would thus have a maximum response time of 20 milliseconds, if all
nodes were somehow fired simultaneously. This would be a good
response time for a PLC. In practice this can never happen and a
maximum response times of &lt; 200 microseconds was measured on such
a 10 MHz machine. This corresponds to events which cause 100 follow
up nodes to fire. The typical number of follow up events is 7.
Assuming this figure is Poisson distributed the above assumption is
not unreasonable.</FONT></FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>In
2013 the <I>iC</I> system was ported to the Raspberry Pi running
under Raspbian Linux. This computer is slow by current standards (700
MHz), but its size and I/O capabilities make it an ideal platform for
<I>immediate C</I>. A number of drivers have already been written for
real I/O devices connected to the Raspberry Pi (PiFace, PiFaceCAD
with others to follow).</FONT></FONT></P>
<P CLASS="western"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=2>The
complete system has been published under the Open Source GPL License.
With the current emphasis on Linux in embedded Systems, I see great
scope here for control systems based on the GPIO I/Os and other
peripherals of the Raspberry PI and other similar powerful
micro-processors using the language <I>immediate C</I>. </FONT></FONT>
</P>
<P CLASS="western"><BR><BR>
</P>
<P CLASS="western"><FONT FACE="Comic Sans MS, cursive"><FONT SIZE=2 STYLE="font-size: 9pt"><I>John
E. Wulff, BE, M EngSc – Bowen Mountain, Australia.</I></FONT></FONT></P>
<H1 CLASS="western" STYLE="page-break-before: always"><A NAME="__RefHeading__13609_582495375"></A><A NAME="10.Appendix A    README|outline"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><B>Appendix A  
 README</B></FONT></FONT></H1>
<DIV ID="Section2" DIR="LTR" GUTTER=23 STYLE="column-count: 2">
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">immediate C, iC rev 1.140</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Copyright (C) 1985-2016, John E.
	Wulff</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">All rights reserved.</FONT></P>
	<P CLASS="western" ALIGN=LEFT STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">This program is free software;
	you can redistribute it and/or modify it under the terms of either:</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"> 
	  <FONT SIZE=1 STYLE="font-size: 8pt">a) the GNU General Public
	License as published by the Free Software Foundation; either version
	2, or (at your option) any later version,</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"> 
	   <FONT SIZE=1 STYLE="font-size: 8pt">OR</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"> 
	  <FONT SIZE=1 STYLE="font-size: 8pt">b) the &quot;Artistic License&quot;
	which comes with this Kit.</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">This
	program is distributed in the hope that it will be useful, but
	WITHOUT ANY WARRANTY; without even the implied warranty of
	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See either the
	GNU General Public License or the Artistic License for more details.</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">You
	should have received a copy of the Artistic License with this Kit,
	in the file named &quot;Artistic&quot;. If not, I will be glad to
	provide one.</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">You
	should also have received a copy of the GNU General Public License
	along with this program; if not, write to the Free Software
	Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307,
	USA.</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">For
	those of you that choose to use the GNU General Public License, my
	interpretation of the GNU General Public License is that no iC
	application falls under the terms of the GPL unless you explicitly
	put said application source under the terms of the GPL yourself. 
	Furthermore, any object code linked with iC does not automatically
	fall under the terms of the GPL, provided such object code only adds
	definitions of subroutines and variables, and does not otherwise
	impair the resulting interpreter from executing any standard iC
	source.  I consider linking in C subroutines in this manner to be
	the moral equivalent of defining subroutines in the iC language
	itself.  You may sell such an object file as proprietary provided
	that you provide or offer to provide the immediate C source, as
	specified by the GNU General Public License.  (This is merely an
	alternate way of specifying input to the program.) You may also sell
	a binary produced by compiling an iC source that belongs to you with
	the iC compiler and linking it with the iC runtime library, provided
	that you provide or offer to provide the immediate C source as
	specified by the GPL. (The fact that the iC runtime library and your
	code are in the same binary file is, in this case, a form of mere
	aggregation.) This is my interpretation of the GPL.</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">If
	you still have concerns or difficulties understanding my intent,
	feel free to contact me (see my email at the end of this README)</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">Of
	course, the Artistic License spells all this out for your
	protection, so you may prefer to use that.</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt"><I>Acknowledgements
	to Larry Wall, whose README I used as a template. and for Perl -
	which is just GREAT.</I></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt"><I>Acknowledgements
	to Nick Ing-Simmons for Perl/Tk - which is SMOOTH.</I></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt"><I>Acknowledgements
	to Sriram Srinivasan for Msg.pm - which is COOL.</I></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt"><I>Acknowledgements
	to the developers of GTKWave - which is POWERFUL.</I></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt"><I>Acknowledgements
	to Linus Torvalds and the Open-Software community for Linux(R) -
	which is SOMETHING ELSE.</I></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">----------------------------------------------------------------------------------</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>Notes for the installation of
	iC rev 1.140</B></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT SIZE=1 STYLE="font-size: 8pt">1)	Pre-requisites.
	You need the following on your system:</FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	C
	compiler	# tested with gcc, MSC	<BR>	Perl, Perl/Tk and Time::HiRes	#
	to build <I>iC</I> applications</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	Unpack
	the <I>iC</I>-archive in a suitable working directory 		with:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		tar
	-xvzf icc_1.140.tgz	<BR>		cd icc_1.140/src</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">2)	Excute
	the following:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		configure
	 OR  ./configure	# if super user</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	To
	make a Debug version do</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		makeAll
	-gclS	# OR	<BR>		makeAll -qgclS	# to suppress intermediate output</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	OR
	to make a Release version do</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		make	#
	OR	<BR>		make quiet	# to suppress intermediate output</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	this
	should build the following files without any errors</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		immcc	#
	the <I>iC</I> to <I>C</I> compiler	<BR>		libict.a	# the static
	run-time library			libict.so	# the dynamic run-time library</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">3)	To
	compile and compare the test <I>iC</I> files in Test0 execute:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		make
	test	# should output 'test OK'</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">4)	To
	install the <I>iC</I>-compiler, libraries and scripts execute the
	following as super user:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		sudo
	make install	### Password ###</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">this
	copies the executables to /usr/local/bin, the include file icg.h to
	/usr/local/include, libict.a, libict.so to /usr/local/lib or
	usr/local/lib64 and Msg.pm to /usr/lib/perl5/site...</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		sudo
	make uninstall # remove all these files</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">5)	To
	use the Perl support programs, it is mandatory that you install the
	Perl packages Tk804.029 or later and Time::HiRes unless they are
	already installed on your system.  Both can be found on the
	internet. For Cygwin under Windows a special binary distribution of
	Tk800.023 is included.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">6)	To
	build and run the <I>iC</I> application &quot;hello.ic&quot; do</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		iClive
	hello.ic	# starts the IDE with hello.ic	<BR>		press Build	# displays
	'hello' successfully built		press Run	# opens an iCbox with 1
	button			press button IX0.0 in iCbox</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">'Hello!
	world' is output in the window iClive was started from</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		press
	Live</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">The
	word IX0.0 is coloured yellow/red, because IX0.0 is HI.  When IX0.0
	is pressed again to LO, the colour in the live  display changes to
	green/black, indicating LO.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		press
	File / Quit	# 'hello' and iCbox are terminated</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">7)
	A slightly bigger application is &quot;simple.ic&quot;. Build and
	run it with iClive.  An iCbox with 16 inputs and 8 outputs is
	started automatically.  Explore the logic of the statements by
	changing inputs and following the outputs in iCbox and the live
	display in iClive.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">8)
	The application &quot;bar.ic&quot; uses flip flops to produce a bar
	of running lights.  The application also explores the use of
	programmable time delays, giving some idea of the scope of the <I>iC</I>
	language.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Running
	'iClive bar.ic' as a separate process, while 'bar' is running, will
	display the source listing (in the edit window), connects to
	iCserver as an auxiliary client to receive updates of all variables
	from the running <I>iC</I> program (bar). These updates will change
	the colours of all words, which are immediate variables. 
	(green/black = 0, yellow/red = 1) This &quot;live display&quot;
	shows the current state of logical relationships in visible
	statements of the <I>iC</I> program. Arithmetic variables are
	displayed in a balloon, when the cursor rests on a variable. 
	(Arithmetic variables have a blue background).</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">In
	'Live' mode, when a &quot;live display&quot; is shown, the text is
	read only.  When the 'Edit' button is pressed 'iClive' is a full
	featured editor.  The edit facilities of this program are described
	in the iClive man page under the Heading 'KEYBOARD BINDINGS' (press
	Help button in 'iClive').</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">'iClive'
	can use the Tk::TextUndo package, an extension of Tk::Text. This
	allows undoing changes with the Ctrl-u key. (Control-u is &lt;&lt;Undo&gt;&gt;)
	This is achieved by starting iClive with the -u option. Use this
	option only for editing. In 'Live' mode the display is very jerky
	with -u active.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">9)
	iCserver distributes TCP/IP messages between <I>iC</I> apps and iC
	real and virtual I/O drivers.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">10)
	iCserver is usually started with the -a (auto-vivify) option, which
	will start a simulated I/O iCbox for every input and output, every
	time an <I>iC</I> application is started. Otherwise these must be
	started manually, which can be tedious for large applications.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		iCserver
	-a &amp;	# auto-vivify iCbox for application 			simple	# starts
	iCbox with 3 sets of I/O</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">If
	iClive is started first, it does all this automatically. It then
	stops iCserver automatically when it quits. When iCserver stops it
	stops all registered applications and I/O's.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">11)
	<I>iC</I> applications can of course be run without iClive. They do
	need iCserver though, which every app starts automatically in
	auto-vivify mode unless it is already running.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		hello	#
	start hello + iCserver -ak + iCbox	<BR>	OR	hello -l	# additionally
	start iClive	<BR>		type q	# to stop hello, iCserver and iCbox</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">12)
	Bernstein chaining. If several different <I>iC</I> applications, or
	different instances of the same application are to be started
	together, they must all run in parallel as separate processes (and
	in parallel with iCserver, iCbox and iClive). This is difficult to
	achieve with shell commands.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		bar;
	bar -i1	# does <B>not</B> start bar -i1 until bar stops<BR>		bar &amp;;
	bar -i1	# is a shell syntax error</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">neither
	of which is what we want. Several apps started in a pipeline do
	start in parallel, but we do not want the pipes between <I>iC</I>
	apps. To achieve the desired result, Bernstein chaining has been
	implemented with the -R option for every <I>iC</I> app and for all
	<I>iC</I> drivers.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		bar
	-R bar -i1	# starts bar and bar -i1 in parallel</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		bar
	-l -R bar -i1 -R bar -i2 -R bar -i3	# starts:	<BR>			iCserver -z
	-ak	<BR>			iClive	# from -l	<BR>			bar -z -i1 -R bar -i2 -R bar
	-i3	<BR>			bar -z -i2 -R bar -i3	<BR>			bar -z -i3	<BR>	iCserver
	starts:	iCbox X0 B1 X2	# for bar	<BR>	by auto-vivification	iCbox
	X0-1 B1-1 X2-1	# for bar -i1	<BR>			iCbox X0-2 B1-2 X2-2	# for bar
	-i2	<BR>			iCbox X0-3 B1-3 X2-3	# for bar -i3</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Only
	the first app in the chain has keyboard input and can be stopped by
	typing 'q'. This in turn stops iCserver, which stops all other apps
	in the chain. (-z blocks keyboard input).</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Chaining
	is important for driver calls with real I/O arguments.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">13)
	Another powerful debugging tool is the GTKWave Wave Analyzer.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-left: 1.25cm; margin-bottom: 0.1cm; line-height: 100%">
	<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><I>GTKWave
	(an open-source program) is an analysis tool originally intended to
	perform debugging on Verilog or VHDL simulation models. With the
	exception of interactive VCD viewing, it is not intended to run
	interactively with simulation, but instead relies on a post-mortem
	approach through the use of dumpfiles. Various dumpfile formats are
	supported: VCD: Value Change Dump. This is an industry standard file
	format generated by most Verilog simulators and is specified in
	IEEE-1364.  (Extract from the GTKWave 3.3 Wave Analyzer User's
	Guide) Use in the iC system is hereby gratefully acknowledged.</I></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">gtkwave-3.1.10-4.33.i586.rpm
	was downloaded from the internet.  To install gtkwave on OpenSUSE
	Linux do:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	sudo
	rpm -i gtkwave-3.1.10-4.33.i586.rpm</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">For
	other Linux distributions download and follow the instructions in
	the internet to install GTKWave for those systems.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Since
	version 1.131 of the <I>iC</I> run-time a VCD file and an associated
	SAV file is generated by an <I>iC</I> application when run with the
	-v option. This allows the interactive or post-mortem viewing of
	both logic and analog traces against a virtual time scale. This time
	scale was chosen so that each sequential change in any signal is 1
	virtual microsecond. iClock cycles take up 2 virtual microseconds.
	Each new external input (Ixn.m, IBn, IWn ILn or TX0.m) occurs on the
	next 10 virtual microsecond boundary. To test this do:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		simple
	-v simple.vcd	<BR>		# press IX0.0 to IX0.7 in iCbox one after the
	other<BR>		# press IX0.0 to IX0.7 again one after the other	<BR>		type
	q		# stop iCserver, simple, iCbox</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">This
	writes simple.vcd and simple.sav</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		gtkwave
	simple.vcd simple.sav # displays timing 					# for all non-extended
	variables</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">A
	more detailed example uses the running of 'bar -v bar.vcd' shown in
	the <I>iC</I> manual iC.pdf and barx.sav, which is in the
	distribution and which shows extra extended gates and markers used
	in the description in the manual.  barx.sav was generated by first
	running gtkwave bar.vcd bar.sav - inserting extended variables from
	modules, setting markers and then saving as barx.sav.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		gtkwave
	bar.vcd barx.sav</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">display
	some extended variables</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">14)
	A fairly varied example is sortm28.ica, which is described fully
	under 7.3 'Parcel Sorter' in the iC.odt handbook. It produces good
	GTKwave traces.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">15)
	I have included a script called 'iCstop' from my private toolkit. 
	It can be used effectively to kill iCserver when it is executing in
	the background, which is appropriate for a server.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		iCserver
	&amp;	<BR>		iCstop iCserver		# local copy of 'iCstop'</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">16)
	To make executable applications from <I>iC</I> sources, use  iCmake,
	which is a shell script to compile <I>iC</I> sources into <I>C</I>
	sources using the 'immcc' compiler.  These in turn are compiled and
	linked into an executable <I>iC</I> application (currently using gcc
	- this can be changed).  Various options allow partial compilation
	and generation of listings.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">	iCmake
	-h  OR  iCman iCmake	# gives a lot of help</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">17)
	The LibreOffice 3.3.1 document doc/iC.odt (or doc/iC.pdf,
	doc/iC.html) is the handbook for the <I>iC</I> Programming Language.
	It opens the way to use &quot;<I>immediate C</I>&quot; fully.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">18)
	There is a generous help output for every tool in the '<I>iC</I>
	Project' initiated with the -h option. Each generated <I>iC</I>
	application also has a help output:</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">		hello
	-h	# list available options</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">The
	extra options shown in the help output explain how to  connect to
	iCserver on another computer in a LAN with the -s option - or with a
	different port number with -p. Very detailed debugging output,
	showing the change of state of every event in the system is
	available for the Debug version of the <I>iC</I> system with -t.
	(Suppressed for Release version)</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">19)
	There are 'man' pages for all the tools used in the '<I>iC</I>
	Project'.  These can be viewed with the normal 'man' command under
	Linux or with 'iCman'.	The man page viewer 'iCman' has some nifty
	web-browser features to view and search man pages - try it with
	'iCman iCman'.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><BR><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Lots
	of success</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">John
	E. Wulff   2016.01.23	&lt;immediateC@gmail.com&gt;</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><BR><BR>
	</P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Main
	development is on openSUSE (currently 13.1) and perlTk Tk804.031,
	which provides fast live updates in iClive. They seem to be as fast
	as with Tk800.24. A Test with Knoppix and Tk804.25, which is still
	available for Debian also provided good performance with fast live
	updates in iClive.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">In
	Sept 2013 I ported immediate C to the Raspberry Pi running Raspbian.
	There were no problems, except the gcc ARM compiler defaults to
	'unsigned char'.  Since the core of the <I>iC</I> system is based on
	signed arithmetic with char's, I had to change the declaration of
	those to 'signed char'. The following package had to be installed
	with sudo apt-get install: perl-tk. The following packages are
	optional but useful: bison, flex, gtkwave, rcs and vim. (2 weeks
	with an old vi was punishment enough). After that all tests passed.</FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0.1cm; line-height: 100%"><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">During
	2014 I wrote drivers for direct I/O for the PiFace and PiFaceCAD
	digital interfaces for the Raspberry Pi - see man page for iCpiFace
	and README.RPi.</FONT></FONT></P>
</DIV>
<H1 CLASS="western"><A NAME="__RefHeading__23253_1582432481"></A><FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><B>Appendix
B    README.RPi</B></FONT></FONT></H1>
<DIV ID="Section1" DIR="LTR" GUTTER=23 STYLE="column-count: 2">
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>Raspberry Pi Development and
	Run-time Environment</B></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">For building the <I>immediate C</I>
	system on a Raspberry Pi, the development environment for the
	Raspbian distribution of Linux is just as powerful as for Linux on a
	PC. It natively supports gcc 4.6.3 and perl 5.14. For the <I>iC</I>
	system Perl/Tk, bison and flex are also required. Although one can
	do without bison and flex, since the pre-compiled <I>C</I> files are
	distributed with the tar ball, it is useful to have them for a
	complete distribution build. All of these tools are available with
	apt-get. I also rely on vim for writing and maintaining code, ddd
	for debugging, GTKWave for visualizing and RCS for source code
	control.  These are also available for the Raspberry Pi.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The <I>iC</I> system consists of
	the <I>immediate C</I> compiler 'immcc', the static library
	'libict.a', which has debugging support and the shared library
	'libict.so', which does not. On top of this are the Raspberry Pi
	specific I/O drivers <I><B>iCpiFace</B></I><I><SPAN STYLE="font-weight: normal">,
	</SPAN></I><I><B>iCpiPWM </B></I><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">and
	</SPAN></SPAN><I><B>iCtherm</B></I>. The 'immcc' compiler has no
	Raspberry Pi specific code. The libraries have driver extensions
	which are optionally compiled if an <B>armv</B> CPU is used. To
	build the various components 'make' must be called with different
	options. The auxiliary script 'makeAll' looks after this (see the
	'makeAll' man page).  'makeAll' tests which processor it is running
	on and defines RASPBERRYPI if it runs on an <B>armv</B> CPU. This
	means the calls to make are identical on all processors (currently
	x86_64, armv6l and armv7l) The Makefile also looks after storing the
	libraries in the correct directory - /usr/local/lib or
	/usr/local/lib64 for 64 bit processors.  To make things even easier
	the script 'm' builds various versions very simply. (I used to have
	a colleague who found 'make' too long to type).</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">	m	# build immcc and libict.a
	with debugging support	m -cl	# same as m	<BR>	m -clS	# also build
	the shared library without debugging	<BR>	m -P	# build the I/O
	program iCpiFace and iCgpioPUD 	m -i	# build immcc and libict.a and
	install everything	<BR>	m -clSi	# build and install everything</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">On top of this all <I>iC</I>
	programs have to be re-compiled if 'immcc' has been modified or
	simply re-linked if only the libraries have changed. The script
	'iCmake' looks after this. It's arguments are one or more <I>iC</I>
	files ending in .ic (or .ica, in which case more arguments are
	usually needed).</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">	iCmake -sA *.ic	<BR>		# re-link
	all <I>iC</I> files in the current directory with the	<BR>		# static
	library libict.a for debugging	<BR>		# the -A switch shows ALIASES
	as live data in <SPAN STYLE="font-style: normal">iCliv</SPAN><SPAN STYLE="font-style: normal">e</SPAN><BR>	iCmake
	-f *.ic	<BR>		# force re-linking with the shared library libict.so</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">It may be worthwhile mentioning
	at this point, that the <I>iC</I> apps behaved very strangely when I
	did a complete 'apt-get dist-upgrade' recently. Everything worked
	again when I re-linked everything to the upgraded system libraries.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Build times of the complete <I>iC</I>
	compiler as well as static and shared libraries on the RPi B and B+
	versions, which have an ARM6 processor running at 700 MHz and 500
	Mbytes of memory, are 3 min 50 sec (230 seconds).</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Build time for the RPi 2B
	version, which has a four core ARM7 processor running at 800 MHz and
	1 Gbyte of memory, is 1 min 14 sec (74 seconds).</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">My development machine is a
	Compaq Presario CQ57 with a two core Intel Pentium CPU 8940 (x86_64)
	running at 2.0 GHz with 4 Gbytes of memory running openSUSE 13.1
	Linux. It runs gcc 4.8.1 and perl 5.18.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Build time for the Compaq PC is
	10.8 seconds, which makes a ratio of 21-7-1 for the 3 machines.
	Execution times for 'make test' times for the 3 machines are 330
	seconds, 117 seconds and 17.9 seconds respectively, which is a ratio
	of 18.5-6.5-1, which is similar.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The build times mentioned above
	are for a complete distribution clean followed by compiling the <I>iC</I>
	and <I>C</I> yacc files and a lex file followed by 31 <I>C</I>
	compiles and 3 link compiles. Also 14 man page files are re-compiled
	from POD-text attached directly to the relevant sources. All
	relevant files are also installed. During normal development only
	one or a few files are recompiled, which only takes seconds, even on
	the slow RPi B.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">I have written, compiled and
	debugged all the RPi specific drivers on a RPi B connected via ssh
	-X to a number of console windows on the Compaq PC. That way I get
	the fastest turnaround time. The only program which does not run
	well in a SSH window is ddd. It works perfectly in a native window
	on the RPi X system.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">I also mount the central Compaq
	PC via nfs on each RPi. This allows archiving of modified sources on
	the Compaq PC and distributing modified files to other RPi's on the
	network.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The immediate C IDE program
	<I><B>iClive</B></I> is both a text editor for writing new <I>iC</I>
	programs or for updating them as well as a debugger for displaying
	the state of immediate bit, int, clock and timer variables in real
	time by colour changes of the variables in the program text or in
	balloon windows for analog values.  <I><B>iClive</B></I> also has a
	button for executing the usual File operations, a button to build an
	<I>iC</I> executable, a button to switch between different instances
	of the current program, a button to switch between Edit and Live
	mode and a button for a powerful search facility. The Edit window
	provides a modest amount of syntax highlighting. Nevertheless I
	mostly use vim for editing <I>iC</I> programs and <I><B>iClive</B></I>
	only for debugging. I provide 3 files: ic.vim, filetype.vim and
	wulff.vim to provide syntax highlighting for <I>iC</I> files in vim.
	 The command line tool 'iCmake' generates executables from <I>iC</I>
	source file ending in .ic or .ica (see man pages for more details).</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The graphical program <I><B>iClive</B></I>
	and a number of other support widgets (most importantly <I>iCbox</I>)
	run perfectly on the Linux PC when started remotely on a RPi in a
	ssh -X window.  This makes testing networked <I>iC</I> programs on
	several RPi's very easy.</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>Raspberry Pi Direct I/O with
	GPIO's</B></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The ARM processors have GPIO
	signals, some of which are brought out on the P1 connector of the
	Raspberry Pi boards.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The Raspberry Pi A or B brings
	out 17 GPIO signals on a 26 pin connector, 5 of which double up to
	do the SPI interface, 2 for a UART, leaving 10 for general purpose
	input/output (there are 4 more on a 2nd connector, which is not
	normally fitted). The Raspberry Pi B+ and 2B bring out 9 more GPIO
	signals on their 40 pin connectors making a total of 19 free GPIO
	pins.  The Linux &quot;sysfs&quot; can access the value of these
	GPIO pins from user space and more importantly can generate
	interrupts from them.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Because GPIO pins are not
	buffered, great care must be taken using them.  Output voltages are
	0 volts (lo) and 3.3 volts (hi) and load current is limited.  A
	useful indicator circuit is a low power LED connected to 3.3 volts
	via a 270 ohm resistor. This can be used as an output indicator and
	provides input bias and an indicator for input switches connecting
	to 0 volts. For both inputs and outputs 0 volts (lo) is the active
	signal when the light is on and the switch is closed. The software
	drivers provided allow for this by arranging that both outputs and
	inputs can be independently active hi or active lo.  (For GPIO's
	each bit can be independently active hi or lo).</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">In <I>iC,</I> direct digital I/O
	on GPIO pins is handled by the Linux &quot;sysfs&quot; and its
	interrupts.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">For details see:
	<U>http://elinux.org/RPi_Low-level_peripherals</U></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	   
	<FONT SIZE=1 STYLE="font-size: 8pt"><U>http://www.auctoris.co.uk/2012/07/19/gpio-with-sysfs-on-a-raspberry-pi/</U></FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>Other Raspberry Pi I/O
	drivers with GPIO's</B></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%; text-decoration: none">
	<FONT SIZE=1 STYLE="font-size: 8pt"><I><B>iCpiPWM</B></I> provides
	pulse width modulated outputs on GPIO pins to provide pseudo analog
	output from 0 to 3.3 volts or to drive Servos with 500 to 2500 us
	pulses at 20 ms intervals. It also measures analog inputs using the
	<B>MCP3008</B> 8 channel 10 bit A/D converter.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%; text-decoration: none">
	<FONT SIZE=1 STYLE="font-size: 8pt"><I><B>iCtherm</B></I> measures
	temperature using one or more <B>DS18B20</B> 1-Wire digital
	thermometers connected to GPIO4.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%; text-decoration: none">
	<FONT SIZE=1 STYLE="font-size: 8pt">More details for both drivers
	can be found in the respective man pages.</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%; page-break-before: always">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>PiFace I/O extension boards</B></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">One PiFace 1 board can be
	plugged directly into the 26 pin P1 connector of a RPi B board. Up
	to 8 Piface boards can be connected using up to 3 PiRacks.  I have
	tested 4 PiFace 1's on one PiRack as well as a 40 pin PiFace 2 and 2
	x PiFace Relay+ with Relay Extra extensions together on a RPi2.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Each PiFace provides 8 bits of
	buffered digital output, each of which is connected to a LED
	indicator and 2 of which also drive relays with 1 changeover switch
	each.  Each PiFace also has 8 bits of digital input, which can be
	configured as extra outputs. 4 pushbutton switches pull inputs 0 to
	3 to 0 volts. All 8 outputs, the 6 wires from the contacts of the
	relays and the 8 inputs are brought out to terminal blocks.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The output LED's and the relays
	are switched on when the output is 0 volts, which is active lo.  The
	way the switches are arranged the input is also active lo for the 4
	switches.  Like for GPIO's the drivers can select either active hi
	or active lo (for PiFaces all 8 outputs and independently all 8
	inputs may be configured to be active hi or lo).</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>PiFaceCAD I/O extension board</B></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">One PiFaceCAD board can be
	plugged directly into the 26 pin P1 connector of a RPi B board or
	into the top connector of a PiRack together with PiFaces.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The PiFaceCAD uses output to
	control a 16 x 2 LCD character display.  It also has 6 pushbutton
	switches and 1 changeover switch, which connect to 0 volts when
	activated. The inputs are not brought out to a terminal block.</FONT></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><B>RPi Drivers for GPIO's,
	PiFaces and a PiFaceCAD</B></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Because the <I>iC</I> system is
	geared to using interrupts to get immediate response from inputs, a
	common driver is preferable to handle interrupts via a single
	select() call.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">Two versions of the driver have
	been implemented. The simplest is a program called <I><B>iCpiFace</B></I>,
	which takes input and sends output to GPIO's, PiFaces and a
	PiFaceCAD from data transmitted to the app by TCP/IP messages
	transmitted to and from an <I>iC</I> app via <I>iCserver</I>. This
	program can also be called by the alternative name <I><B>iCpiGPIO</B></I>,
	in which case only GPIO's are handled.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<IMG SRC="iC_html_7b8cca7d.jpg" NAME="graphics10" ALIGN=BOTTOM WIDTH=294 HEIGHT=141 BORDER=0></P>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt"><I>(The numbers at the
	boundaries of the three boxes <BR>are iCserver channel numbers)</I></FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The advantage of <I><B>iCpiFace</B></I>
	is, that <I>iC</I> apps are compiled and linked without regard to
	where the data originates.  The disadvantage is, that I/O speeds are
	limited by the speed of transmission of the TCP/IP messages and the
	time taken by <I>iCserver</I>. On an RPi 2B a turnaround time of 1.7
	ms was measured if an input is switched on a GPIO or PiFace input
	and the <I>iC</I> app immediately outputs it to a GPIO or PiFace
	output. On an RPi B or B+ this was 5.5 ms.  As can be seen in Fig.
	1, four separate TCP/IP messages and 2 delays in <I>iCserver</I> are
	involved - <I>iCpiFace</I> input to <I>iCserver</I> - <I>iCserver</I>
	in to out - <I>iCserver</I> to the <I>iC</I> app input - <I>iC</I>
	app output to <I>iCserver</I> - <I>iCserver</I> in to out and
	<I>iCserver</I> to the <I>iCpiFace</I> output. This speed is similar
	to the speed of a fast mechanical relay and is quite useful for many
	control applications. It is still faster than most PLC's.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">A second version of the driver
	is built directly into the run-time library linked to <I>iC</I> apps
	and is therefore much faster.  External inputs interrupt the system
	directly and act directly in the <I>iC</I> execution network
	generating values, which are transmitted directly to external
	outputs. Turnaround times of 90 us were measured for GPIO's on an
	RPi 2B (170 us on an RPi B or B+) and 450 us for PiFaces on an RPi
	B. PiFaces are a bit slower, because speed is limited by the serial
	transmissions of the SPI interface.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<IMG SRC="iC_html_650dbd65.jpg" NAME="graphics11" ALIGN=BOTTOM WIDTH=294 HEIGHT=141 BORDER=0></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">A feature of the direct I/O in
	the run-time library is, that any GPIO or PiFace I/O's, which are
	not called for in the <I>iC</I> app the library is linked to, will
	be handled as TCP/IP I/O's, just like <I><B>iCpiFace</B></I>. This
	means several <I>iC</I> apps can utilize GPIO and PiFace I/O's. Of
	course only one app can use direct high-speed I/O.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<IMG SRC="iC_html_92e10d51.jpg" NAME="graphics6" ALIGN=BOTTOM WIDTH=294 HEIGHT=141 BORDER=0></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">The command line switches and
	I/O arguments are explained in detail in the <I><B>iCpiFace</B></I>
	man page and in the -h help output for <I><B>iCpiFace</B></I> and
	each app linked to the RPi library. These arguments are mostly
	identical for both versions. Here are command line calls for the
	three examples above.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">1) iCpiFace -I IX0.0,18 QX0.0,24
	X1:1	 # OR	<BR>    iCpiFace ~IX0.0,18 ~QX0.0,24 ~X1:1 # separate
	inversion<BR>		# all inputs and outputs active lo	<BR>		# IX0.0 GPIO
	18 external input	<BR>		# QX0.0 GPIO 24 external output	<BR>		#
	IX1.0-IX1.7 external on PiFace1	<BR>		# QX1.0-QX1.7 external on
	PiFace1	<BR>    app1	# uses IX0.0, QX0.0 as well as	<BR>		# IX1.0 -
	IX1.7 and QX1.0 - QX1.7</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">2) app2 -I IX0.0,18 QX0.0,24
	X1:1	<BR>		# all inputs and outputs active lo	<BR>		# app2 uses all
	inputs and outputs	<BR>		# IX0.0 GPIO 18 direct input	<BR>		# QX0.0
	GPIO 24 direct output	<BR>		# IX1.0-IX1.7 direct on PiFace1	<BR>		#
	QX1.0-QX1.7 direct on PiFace1</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">3) app3 -I IX0.0,18 QX0.0,24
	X1:1	<BR>		# all inputs and outputs active lo	<BR>		# app3 uses
	IX1.0 - IX1.7 and	<BR>		# QX1.0 - QX1.7 only	<BR>		# IX1.0-IX1.7
	direct on PiFace1	<BR>		# QX1.0-QX1.7 direct on PiFace1	<BR>		#
	IX0.0 GPIO 18 external input	<BR>		# QX0.0 GPIO 24 external output	<BR>
	   app4	# uses IX0.0, QX0.0 only</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">All calls to the I/O systems
	have been done with active lo inputs and outputs.  This means that
	if a variable is '1' in the <I>iC</I> app, it is 0 volts or lo at
	the in or output terminal, which is appropriate for input switches
	connected to 0 volts and driving LED's and relays connected to 3.3
	volts. If inverting buffers are used the calls can be adjusted
	appropriately.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">When an app is called with only
	direct inputs and outputs, it does not connect to <I>iCserver</I> at
	all, which means <I>iClive</I> cannot be used with that app. To
	enable <I>iClive</I>, the app must be called with the -L option,
	which connects it to <I>iCserver</I> anyway and thus enabling <I>iClive</I>
	debugging. Another useful option is -B, which causes <I><B>iCpiFace</B></I>
	and an app with direct I/O to generate an auxiliary <I>iCbox</I> to
	monitor the direct inputs and outputs, which otherwise are only
	electrical signals at the I/O terminals.</FONT></P>
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.1cm; font-weight: normal; line-height: 100%">
	<FONT SIZE=1 STYLE="font-size: 8pt">John E. Wulff   2015.12.28    
	&lt;immediateC@gmail.com&gt;</FONT></P>
</DIV>
<H1 CLASS="western" STYLE="margin-top: 0cm; margin-bottom: 0cm; page-break-before: always"><A NAME="__RefHeading__23255_1582432481"></A>
<FONT FACE="Liberation Sans, sans-serif"><FONT SIZE=4><B>Appendix C  
 Type Definition Table</B></FONT></FONT></H1>
<P CLASS="western" STYLE="margin-bottom: 0cm">The following table
defines function types and output types of Gate nodes used in the <I>iC</I>
run-time system. The columns 'os' and 'fos' are useful when
interpreting the compiler generated listings.</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><BR>
</P>
<P CLASS="western" STYLE="margin-bottom: 0cm"><IMG SRC="iC_html_8cb233de.gif" NAME="Object1" ALIGN=LEFT WIDTH=628 HEIGHT=902><BR CLEAR=LEFT><BR>
</P>
<DIV ID="sdfootnote1">
	<P CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.21cm; widows: 2; orphans: 2">
	<FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1><A CLASS="sdfootnotesym" NAME="sdfootnote1sym" HREF="#sdfootnote1anc">1</A>
	see Werner Kluge:  The organization of Reduction, Data Flow, and
	Control Flow Systems - pp. 317.<BR>   The MIT Press 1992. [Kluge92]</FONT></FONT></P>
</DIV>
<DIV ID="sdfootnote2">
	<P CLASS="sdfootnote-western"><FONT FACE="MS Sans Serif, sans-serif"><A CLASS="sdfootnotesym" NAME="sdfootnote2sym" HREF="#sdfootnote2anc">2</A>
	<FONT SIZE=1 STYLE="font-size: 8pt">Note the memory behaviour of a
	LATCH when both </FONT><FONT SIZE=1 STYLE="font-size: 8pt"><B>set</B></FONT><FONT SIZE=1 STYLE="font-size: 8pt">
	and </FONT><FONT SIZE=1 STYLE="font-size: 8pt"><B>reset</B></FONT><FONT SIZE=1 STYLE="font-size: 8pt">
	is  </FONT><FONT FACE="Courier, monospace"><FONT SIZE=1 STYLE="font-size: 8pt">1</FONT></FONT></FONT></P>
</DIV>
<DIV ID="sdfootnote3">
	<P CLASS="western"><A CLASS="sdfootnotesym" NAME="sdfootnote3sym" HREF="#sdfootnote3anc">3</A><FONT FACE="MS Sans Serif, sans-serif">
	</FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">Note
	for PLC programmers: the order of the </FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>set</B></FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">
	and </FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt"><B>reset</B></FONT></FONT><FONT FACE="MS Sans Serif, sans-serif"><FONT SIZE=1 STYLE="font-size: 8pt">
	statement has no influence on the output of flip-flops and latches
	as it does in sequentially executed PLC programs - even in the case
	of this latch example using four gates.</FONT></FONT></P>
</DIV>
</BODY>
</HTML>